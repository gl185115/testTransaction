Scenario: Journalize SPM data < 8kilobytes, Server Stops
Given that the spm file is not found
When I request to journalization for {20} times
Then the spm data should not be written
When I stopped the tomcat server
Then the buffered spm data should be written

Scenario: Journalize SPM data > 8kilobytes, Server Stops
Given that the spm file is not found
When I request to journalization for {120} times
Then the spm data should be written
When I stopped the tomcat server
Then the buffered spm data should be written

Scenario: Journalize SPM data Until 8KB, Server Running
Given that the spm file is not found
!-- < 8KB
When I request to journalization for {20} times
Then the spm data should not be written
!-- > 8KB
When I request to journalization for {100} times
Then the buffered spm data should be written
!-- Journalize Sale PosLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize Cancelled POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction CancelFlag="True"><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4230</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item  B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize Void PosLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:06:30</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:06:32</ReceiptDateTime><TillID>0</TillID><RetailTransaction TransactionStatus="Voided"><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Voided"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize ReturnNoReceipt POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize ReturnWithReceipt POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction ><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID>                                            <SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided"/></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize SOD POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize EOD POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize Loan POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize Pickup POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize SummaryReceipt POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} journalization
Then I should get journalization response
!-- Journalize Donation POSLog
When I request for {<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>8521</SequenceNumber><BusinessDayDate>2014-03-28</BusinessDayDate><BeginDateTime>2014-03-28T17:44:20</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-03-28T17:44:20</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><PaymentOnAccount AccountCode="Unspecified"><AccountNumber>1</AccountNumber><Amount>500</Amount></PaymentOnAccount></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash"><Amount>1000</Amount><TenderChange><Amount>500</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">500</Total><Total TotalType="TransactionGrandAmount">500</Total></RetailTransaction></Transaction></POSLog>} journalization
Then I should get journalization response

Scenario: Create SPM directory If Not Found
Given that the spm file is not found
When I request to journalization for {1} times
Then the SPM file exist
!-- > 8Kb with SPM File Created
When I request to journalization for {100} times
Then the SPM file exist
Then the buffered spm data should be written

Scenario: SPM Directory Not Existing, Journalize Successful
Given that the spm directory path is not available
When I request to journalization for {1} times
Then I should get journalization response

Scenario: SPM Entry Not Found in web.xml, Journalize Successful
Given that the spm entry does not exist in web.xml
When I request to journalization for {1} times
Then I should get journalization response

