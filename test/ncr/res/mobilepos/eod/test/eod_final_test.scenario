Scenario: Execute @EOD final screen (with weather and customer count settings, store total on)
!-- # of EOD Transaction
Given that has no EOD transaction
Then TXL_SALES_JOURNAL table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|SequenceNumber	|BusinessDayDate	|TrainingFlag	|TxType	|ServerId	|Status	|SendStatus1	|SendStatus2	|EjStatus	|Tx|
When getting transaction count of companyId=01, storeId=0247, txtype=EOD, trainingFlag=0
Then it should get TxCount:0, NCRWSSResultCode:0

!-- # of EOD Transaction by business date
Given that has no EOD transaction
Then TXL_SALES_JOURNAL table should have:
|CompanyId  |RetailStoreId  |WorkstationId  |SequenceNumber |BusinessDayDate    |TrainingFlag   |TxType |ServerId   |Status |SendStatus1    |SendStatus2    |EjStatus   |Tx|
When getting tx count by businessdate of companyId=01, storeId=0247, workStationId=0002, txtype=EOD, businessDate=20170410, trainingFlag=0
Then it should get TxCount:0, NCRWSSResultCode:0

2. https://localhost:8443/resTransaction/rest/cashaccount/getcash
!-- Total Cash of ChangeFund Transactions
Given that has no changefund data
Then TXU_TOTAL_DAILYREPORT table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|BusinessDayDate	|ItemType	|ItemLevel1	|ItemLevel2	|ItemLevel3	|ItemLevel4	|TrainingFlag	|ItemCnt	|ItemAmt	|
When getting daily sales report for companyId:01 storeId:0247 tillId:empty terminalId:0001 businessDate:2016-08-09 trainingFlag:0 dataType:3 itemLevel1:07 itemLevel2:06
Then it should get NCRWSSResultCode:1301

!-- List of Report
Given that no report items
Then MST_DEVICEINFO table should have:
|CompanyId	|StoreId	|TerminalId	|Training	|DeviceName		|AttributeId	|TillId		|LastTxId	|Status	|
|01			|0247		|0001		|0			|POS#0001テスト	|4				|02470001	|1335		|Active	|
Then MST_NAME_DAILYREPORT table should have:
|CompanyId	|StoreId|DataType	|ItemLevel1	|ItemLevel2	|ItemLevel3	|ItemLevel4	|ItemName		|DisplayOrder	|DeleteFlag	|
|01			|0		|2			|01			|01	 		|	 		|			|◆クレジット支払	|170			|0			|
|01			|0		|3			|07			|05	 		|			| 			|●現金在高		|2390			|0			|
Then TXU_TOTAL_DAILYREPORT table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|BusinessDayDate	|ItemType	|ItemLevel1	|ItemLevel2	|ItemLevel3	|ItemLevel4	|TrainingFlag	|ItemCount	|ItemAmt	|
When getting report items of companyId:01, storeId:0247, tillId:02470001, businessDate:2016-08-09, trainingFlag:0
Then it should get the following:
|CompanyId	|StoreId	|DataType	|ItemLevel1	|ItemLevel2	|ItemLevel3	|ItemLevel4	|ItemName	|TillId		|ItemCount	|ItemAmt	|NCRWSSExtendedResultCode	|NCRWSSResultCode	|	
|01			|0			|2			|01			|01	 	 	| 			| 			|◆クレジット支払|02470001 	|0       	|0     		|0							|0 					|
|01			|0    		|3  		|07       	|05    		| 			| 			|●現金在高	|02470001 	|0       	|0     		|0							|0 					|

!-- Save EOD POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
Given that no transactions
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">晴れ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>汎用販売員3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="商品券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="商品券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="商品券３"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="商品券４"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="商品券５"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="商品券６"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="商品券７"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="商品券８"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="商品券９"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="商品券１０"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="グループ券"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="その他券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="その他券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>◆クレジット支払</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>●現金在高</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|SequenceNumber	|BusinessDayDate	|TrainingFlag	|TxType	|ServerId	|Status	|SendStatus1	|SendStatus2	|EjStatus	|Tx|
|01			|0247			|0001			|1669			|2016-08-09			|0				|EOD	|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">晴れ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>汎用販売員3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="商品券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="商品券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="商品券３"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="商品券４"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="商品券５"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="商品券６"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="商品券７"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="商品券８"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="商品券９"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="商品券１０"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="グループ券"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="その他券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="その他券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>◆クレジット支払</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>●現金在高</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|
Then MST_TILLIDINFO table should have:
|CompanyId	|StoreId	|TillId		|TerminalId	|BusinessDayDate	|SodFlag	|EodFlag	|
|01			|0247		|02470001	|0001		|2016-08-09			|0			|1			|
Then MST_DEVICEINFO table should have:
|CompanyId	|StoreId	|TerminalId	|Training	|DeviceName		|AttributeId	|TillId		|LastTxId	|Status	|
|01			|0247		|0001		|0			|POS#0001テスト	|4				|02470001	|1669		|Active	|

!-- PresetCMInfo
Given that presetcminfo data
When getting presetcminfo of companyid:01, storeid:0247, terminalid:0001, businessdaydate:2016-08-09
Then it should get NCRWSSResultCode:0
Then it should get the following:
|CompanyId	|CMName	|CMType	|BizCatId	|StoreId	|TerminalId	|Top1Message	|Top2Message	|Top3Message		|Top4Message	|Top5Message		|Bottom1Message				|Bottom2Message		|Bottom3Message	|Bottom4Message	|Bottom5Message	|
|01			|CM4	|3		|01			|0247		|0			|上段１行目		|上段２行目		|インテグレーションテスト3	|残り5日間		|不具合ゼロを目指します	|MeXプロジェクト					|開始しています。		|協力者募集中		|下段４行目		|下段５行目		|

!-- Operator SignOff
Given that operator has sign-on
When signing-off with operatorid:9011011
Then it should get NCRWSSResultCode:0

!-- Save PosEOD POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|SequenceNumber	|BusinessDayDate	|TrainingFlag	|TxType	|ServerId	|Status	|SendStatus1	|SendStatus2	|EjStatus	|Tx|
|01			|0247			|0001			|1669			|2016-08-09			|0				|EOD	|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">晴れ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>汎用販売員3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="商品券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="商品券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="商品券３"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="商品券４"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="商品券５"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="商品券６"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="商品券７"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="商品券８"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="商品券９"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="商品券１０"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="グループ券"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="その他券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="その他券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>◆クレジット支払</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>●現金在高</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|01			|0247			|0001			|1670			|2016-08-09			|0				|PosEod	|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>|
Then MST_TILLIDINFO table should have:
|CompanyId	|StoreId	|TillId		|TerminalId	|BusinessDayDate	|SodFlag	|EodFlag	|
|01			|0247		|02470001	|0001		|2016-08-09			|0			|1			|
Then MST_DEVICEINFO table should have:
|CompanyId	|StoreId	|TerminalId	|Training	|DeviceName		|AttributeId	|TillId		|LastTxId	|Status	|
|01			|0247		|0001		|0			|POS#0001テスト	|4				|02470001	|1670		|Active	|
 
!-- Save SignOff POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1671</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:46</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:46</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:
|CompanyId	|RetailStoreId	|WorkstationId	|SequenceNumber	|BusinessDayDate	|TrainingFlag	|TxType	|ServerId	|Status	|SendStatus1	|SendStatus2	|EjStatus	|Tx|
|01			|0247			|0001			|1669			|2016-08-09			|0				|EOD	|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">晴れ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>汎用販売員3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="商品券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="商品券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="商品券３"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="商品券４"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="商品券５"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="商品券６"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="商品券７"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="商品券８"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="商品券９"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="商品券１０"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="グループ券"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="その他券１"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="その他券２"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>◆クレジット支払</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>●現金在高</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|01			|0247			|0001			|1670			|2016-08-09			|0				|PosEod	|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>|
|01			|0247			|0001			|1671			|2016-08-09			|0				|SignOff|A010		|0		|0				|0				|0			|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="ゼビオ株式会社" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1671</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:46</BeginDateTime><OperatorID OperatorName="汎用販売員3" OperatorNameKana="ﾊﾝﾖｳﾊﾝﾊﾞｲｲﾝ3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:46</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="茅場町店" VoucherName="茅場町店"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>東京都中央区新川 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>|
Then MST_TILLIDINFO table should have:
|CompanyId	|StoreId	|TillId		|TerminalId	|BusinessDayDate	|SodFlag	|EodFlag	|
|01			|0247		|02470001	|0001		|2016-08-09			|0			|1			|
Then MST_DEVICEINFO table should have:
|CompanyId	|StoreId	|TerminalId	|Training	|DeviceName		|AttributeId	|TillId		|LastTxId	|Status	|
|01			|0247		|0001		|0			|POS#0001テスト	|4				|02470001	|1671		|Active	|