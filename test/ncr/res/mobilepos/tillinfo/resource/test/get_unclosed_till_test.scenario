!-- Check required parameters
Scenario: Check required parameters - companyId is ""
Given a TillInfoResource Resource
When I get unclosed tills with companyId:empty storeId:9999 businessDate:2017-01-01
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - storeId is null
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:null businessDate:2017-01-01
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - businessDate is ""
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:9999 businessDate:empty
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

!-- Check businessDate format
Scenario: Check required parameters - businessDate is not yyyy-MM-dd
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2017/01/01
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

!-- Success
Scenario: Success
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|
|01         |9999		|99995002	|5002		|2014-11-14		|1		|0		|
|01         |9999		|99995003	|5003		|2014-11-14		|1		|0		|

Scenario: Different business day.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-13
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|
|01         |9999		|99995004	|5004		|2014-11-13		|1		|0		|

Scenario: Ignore deleted tills.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_DELETED dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|

Scenario: Different store.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
When I get unclosed tills with companyId:01 storeId:000031 businessDate:2014-11-14
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|
|01         |000031		|000031	|000031		|2014-11-14		|0		|0		|

Scenario: Different company.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
When I get unclosed tills with companyId:02 storeId:9999 businessDate:2014-11-14
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|

Scenario: Don't get tills which has done EOD.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_EOD dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-12-01
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:
|CompanyId  |StoreId	|TillId  	|TerminalId	|BusinessDayDate|SodFlag|EodFlag|
|01         |9999   	|99995000   |5000       |2014-12-01 	|1  	|0  |

Scenario: Get till against broken db connection, DaoException
Given a TillInfoResource Resource
When database has trouble
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14
Then the result should be ResultCode:RES_ERROR_DB and ExtendedResultCode:RES_ERROR_DB

Scenario: NullPointerException (RuntimeException)
Given a TillInfoResource Resource
When runtime exception is thrown
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14
Then the result should be ResultCode:RES_ERROR_GENERAL and ExtendedResultCode:RES_ERROR_GENERAL
