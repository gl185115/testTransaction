Scenario: Implementation of successful Forwarding of a suspended transaction to POS
Given a QueueBuster Service
Given a table entry named {FORWARD_ITEM_TABLE_COMPLETE(For DisneyStore).xml} in the database
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|0|
|000031 |0001  |0002|2012-05-30|0|0|
|000031 |0002  |0003|2012-05-31|0|2|
|000031 |0003  |0004|2012-05-31|0|3|
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0001}, BusinessDate{2012-05-30}, SequenceNumber{0002}  
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>0</status><SuspendStatus>0</SuspendStatus><POSLog><Transaction><RetailStoreID>000031</RetailStoreID><WorkstationID>0001</WorkstationID><SequenceNumber>0002</SequenceNumber><BusinessDayDate>2012-05-30</BusinessDayDate><BeginDateTime>2012-05-29T18:31:11</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2012-05-29T18:31:11</ReceiptDateTime><CustomerID></CustomerID><RetailTransaction><ItemCount>2</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="UPCD">0000000123973</ItemID><Description>product1</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000272152</ItemID><Description>BAT 2</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><Customer><CustomerDemographic>Company</CustomerDemographic></Customer></RetailTransaction></Transaction></POSLog></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|0|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|2|
|000031 |0003  |0004|2012-05-31|0|3|

!-- By the specification of "Disney store", 
!-- every "POS" in a store must be able to process a suspense transaction
Scenario: Another successful forwarding of a suspended transaction to POS
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0001}, BusinessDate{2012-05-29}, SequenceNumber{0001}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>0</status><SuspendStatus>0</SuspendStatus><POSLog><Transaction><RetailStoreID>000031</RetailStoreID><WorkstationID>0001</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2012-05-29</BusinessDayDate><BeginDateTime>2012-05-29T18:30:46</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2012-05-29T18:30:46</ReceiptDateTime><RetailTransaction><ItemCount>2</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000123973</ItemID><Description>Item1</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="UPCD">0000000272152</ItemID><Description>BAT</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><Customer><CustomerDemographic>Family</CustomerDemographic></Customer></RetailTransaction></Transaction></POSLog></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|2|
|000031 |0003  |0004|2012-05-31|0|3|

Scenario: Retrieving an already Forwarded Suspended Transaction
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0001}, BusinessDate{2012-05-29}, SequenceNumber{0001}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>0</status><SuspendStatus>1</SuspendStatus><POSLog><Transaction><RetailStoreID>000031</RetailStoreID><WorkstationID>0001</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2012-05-29</BusinessDayDate><BeginDateTime>2012-05-29T18:30:46</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2012-05-29T18:30:46</ReceiptDateTime><RetailTransaction><ItemCount>2</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000123973</ItemID><Description>Item1</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="UPCD">0000000272152</ItemID><Description>BAT</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><Customer><CustomerDemographic>Family</CustomerDemographic></Customer></RetailTransaction></Transaction></POSLog></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|2|
|000031 |0003  |0004|2012-05-31|0|3|

Scenario: Retrieving a CANCELED Suspended Transaction
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0002}, BusinessDate{2012-05-31}, SequenceNumber{0003}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>0</status><SuspendStatus>2</SuspendStatus><POSLog><Transaction><RetailStoreID>000001</RetailStoreID><WorkstationID>0001</WorkstationID><SequenceNumber>0003</SequenceNumber><BusinessDayDate>2012-05-31</BusinessDayDate><BeginDateTime>2012-05-29T18:31:44</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2012-05-29T18:31:44</ReceiptDateTime><CustomerID></CustomerID><RetailTransaction><ItemCount>2</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000123973</ItemID><Description>product3</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000272152</ItemID><Description>BAT 100</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><Customer><CustomerDemographic>Employee</CustomerDemographic></Customer></RetailTransaction></Transaction></POSLog></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|


Scenario: Retrieving a COMPLETED Suspended Transaction
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0003}, BusinessDate{2012-05-31}, SequenceNumber{0004}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>0</status><SuspendStatus>3</SuspendStatus><POSLog><Transaction><RetailStoreID>000001</RetailStoreID><WorkstationID>0001</WorkstationID><SequenceNumber>0004</SequenceNumber><BusinessDayDate>2012-05-31</BusinessDayDate><BeginDateTime>2012-05-29T18:31:44</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2012-05-29T18:31:44</ReceiptDateTime><CustomerID></CustomerID><RetailTransaction><ItemCount>2</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="UPCD">0000000123973</ItemID><Description>Item5</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="true" Department="0181" Line="0181" Class="000001"><ItemID Type="JAN13">0000000272152</ItemID><Description>BAT60</Description><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><ActualSalesUnitPrice>440.0</ActualSalesUnitPrice><ExtendedAmount>440.0</ExtendedAmount><Quantity>1</Quantity><DiscountAmount>0.0</DiscountAmount><ExtendedDiscountAmount>0.0</ExtendedDiscountAmount></Sale></LineItem><Customer><CustomerDemographic>School</CustomerDemographic></Customer></RetailTransaction></Transaction></POSLog></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|


Scenario: No Transaction Found (Retail Store ID Unknown )
When a request to select a transaction from queue given that it has RetailStoreID{999999}, WorkstationID{0003}, BusinessDate{2012-05-31}, SequenceNumber{0004}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>-1</status><errormessage>No Transaction found in the queue.</errormessage></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|

Scenario: No Transaction Found (WorkstationID Unknown )
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{9999}, BusinessDate{2012-05-31}, SequenceNumber{0004}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>-1</status><errormessage>No Transaction found in the queue.</errormessage></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|

Scenario: No Transaction Found (BusinessDate Unknown )
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0003}, BusinessDate{2012-12-12}, SequenceNumber{0004}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>-1</status><errormessage>No Transaction found in the queue.</errormessage></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|

Scenario: No Transaction Found (SequenceNumber Unknown )
When a request to select a transaction from queue given that it has RetailStoreID{000031}, WorkstationID{0003}, BusinessDate{2012-05-31}, SequenceNumber{9999}
Then Suspend Xml retrieved should be:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SuspendData><status>-1</status><errormessage>No Transaction found in the queue.</errormessage></SuspendData>
Then I should have the following transaction:
|storeid|termid|txid|txdate    |queue|status|
|000031 |0001  |0001|2012-05-29|0|1|
|000031 |0001  |0002|2012-05-30|0|1|
|000031 |0002  |0003|2012-05-31|0|1|
|000031 |0003  |0004|2012-05-31|0|3|


