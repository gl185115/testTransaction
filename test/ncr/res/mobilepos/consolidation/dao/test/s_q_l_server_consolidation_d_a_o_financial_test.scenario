Scenario: Setup Consolidation
Given an instance of SQLServerConsolidationDAO
Then its Database Manager must have been settled

Scenario: TXU_TOTAL_FINANCIAL cash tender,without discount,single line item,single item
Given a sample {TXL_POSLOG_Financial} poslog xml entry in database 
When I select a non-consolidated transaction information
!-- Consolidate
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|440		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,single line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|1760	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|1760		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|4400	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|4400		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,multiple line item,multiple item,different dpt, class, line
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,multiple line item,multiple item,different summarydateid (same poslog txid)
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,multiple line item,multiple item,different terminalid (same poslog txid)
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|

!-- TXU_TOTAL_FINANCIAL cash tender,without discount,multiple line item,multiple item,different storeid (same poslog txid)
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|440		|

!-- TXU_TOTAL_FINANCIAL cash tender with change,without discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|

!-- TXU_TOTAL_FINANCIAL cash tender with change,without discount,multiple line item,multiple item,different summarydateid (same poslog txid)
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|

!-- TXU_TOTAL_FINANCIAL cash tender with change,with transaction discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|1000	|604		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|440		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|44		|0			|

!-- TXU_TOTAL_FINANCIAL (duplicate) cash tender with change,with transaction discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|2000	|1208		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|880		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|88		|0			|

!-- TXU_TOTAL_FINANCIAL cash tender with change,with transaction discount,single line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|12000	|1308		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|11880		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|1188	|0			|

!-- TXU_TOTAL_FINANCIAL cash tender with change,with transaction discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|37000	|2548		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|38280		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|3828	|0			|

!-- TXU_TOTAL_FINANCIAL cash tender with change,with item discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|37000	|2548		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|38280		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|3828	|0			|
|000000000000	|000033		|9877		|0013			|NA				|2012-05-04		|25000	|2120		|
|000000000000	|000033		|9877		|0060			|NR				|2012-05-04		|0		|26400		|
|000000000000	|000033		|9877		|1060			|NA				|2012-05-04		|3520	|0			|

!-- TXU_TOTAL_FINANCIAL cash tender with change,with item and transaction discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|37000	|2548		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|38280		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|3828	|0			|
|000000000000	|000033		|9877		|0013			|NA				|2012-05-04		|50000	|6528		|
|000000000000	|000033		|9877		|0060			|NR				|2012-05-04		|0		|52800		|
|000000000000	|000033		|9877		|0061			|NA				|2012-05-04		|2288	|0			|
|000000000000	|000033		|9877		|1060			|NA				|2012-05-04		|7040	|0			|

!-- TXU_TOTAL_FINANCIAL (duplicate) cash tender with change,with item and transaction discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|37000	|2548		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|38280		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|3828	|0			|
|000000000000	|000033		|9877		|0013			|NA				|2012-05-04		|75000	|10936		|
|000000000000	|000033		|9877		|0060			|NR				|2012-05-04		|0		|79200		|
|000000000000	|000033		|9877		|0061			|NA				|2012-05-04		|4576	|0			|
|000000000000	|000033		|9877		|1060			|NA				|2012-05-04		|10560	|0			|


!-- TXU_TOTAL_FINANCIAL (duplicate) cash tender with change,with item and transaction discount,multiple line item,multiple item, with price override
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|57000	|5948		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|56880		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|5828	|0			|
|000000000000	|000033		|9877		|0013			|NA				|2012-05-04		|75000	|10936		|
|000000000000	|000033		|9877		|0060			|NR				|2012-05-04		|0		|79200		|
|000000000000	|000033		|9877		|0061			|NA				|2012-05-04		|4576	|0			|
|000000000000	|000033		|9877		|1060			|NA				|2012-05-04		|10560	|0			|


!-- TXU_TOTAL_FINANCIAL (duplicate) cash tender with change,with item and transaction discount,multiple line item,multiple item, with price override with item discount
When I consolidate top {1} items
!-- TXU_TOTAL_FINANCIAL Results
Then I should get the following TXU_TOTAL_FINANCIAL results: 
|corpid			|storeid	|terminalid	|accountcode	|accountsubcode	|summarydateid	|debtor	|creditor	|
|000000000000	|000031		|8888		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|8888		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-07		|7040	|0			|
|000000000000	|000031		|9999		|0013			|NA				|2012-02-08		|440	|0			|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-07		|0		|7040		|
|000000000000	|000031		|9999		|0060			|NR				|2012-02-08		|0		|440		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-08		|1440	|560		|
|000000000000	|000032		|8888		|0013			|NA				|2012-02-09		|1000	|560		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-08		|0		|880		|
|000000000000	|000032		|8888		|0060			|NR				|2012-02-09		|0		|440		|
|000000000000	|000033		|9876		|0013			|NA				|2012-05-04		|57000	|5948		|
|000000000000	|000033		|9876		|0060			|NR				|2012-05-04		|0		|56880		|
|000000000000	|000033		|9876		|0061			|NA				|2012-05-04		|5828	|0			|
|000000000000	|000033		|9877		|0013			|NA				|2012-05-04		|90000	|12076		|
|000000000000	|000033		|9877		|0060			|NR				|2012-05-04		|0		|97800		|
|000000000000	|000033		|9877		|0061			|NA				|2012-05-04		|6576	|0			|
|000000000000	|000033		|9877		|1060			|NA				|2012-05-04		|13300	|0			|