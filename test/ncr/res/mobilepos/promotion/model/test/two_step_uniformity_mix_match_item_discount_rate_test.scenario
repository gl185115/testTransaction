Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to trigger 1st Step

Given a MixMatchData of the following:
|MMCode|MMQ|MMDiscountRate|MMDescription|MMQ2|MMDiscountRate2|
|0002  |2  |10|DiscountQtyx2|5   |15    |

!-- 1ST ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemA |100   |1  |0001       |
When I compute discount of 2ndStepUniformity
Then I should get {0} discounts

!-- 2ND ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemB |100   |1  |0002       |
When I compute discount of 2ndStepUniformity
Then I should get {2} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx2  |0001       |10             |
|2       |0002          |0002         |DiscountQtyx2  |0002       |10             |

!-- ============================================
Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 1st step was triggered

Given a MixMatchData of the following:
|MMCode|MMQ|MMDiscountRate|MMDescription|MMQ2|MMDiscountRate2|
|0002  |2  |10|DiscountQtyx2|5   |15    |

!-- 1ST ENTRY [Add entry with 1 quantity]
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemA |50   |1  |0001       |
When I compute discount of 2ndStepUniformity
Then I should get {0} discounts

!-- 2ND ENTRY [Trigger 1st Step Uniformity Discount Rate]
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemB |50   |1  |0002       |
When I compute discount of 2ndStepUniformity
Then I should get {2} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx2  |0001       |5             |
|2       |0002          |0002         |DiscountQtyx2  |0002       |5             |

!--  3RD ENTRY [Add item after 1st Step Uniformity Discount Rate]
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemC |50   |1  |0003       |
When I compute discount of 2ndStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx2  |0001       |5             |
|2       |0002          |0002         |DiscountQtyx2  |0002       |5             |
|3       |0002          |0002         |DiscountQtyx2  |0003       |5             |

!--  4TH ENTRY [Add another item after 1st Step Uniformity Discount Rate]
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemD |60   |1  |0004       |
When I compute discount of 2ndStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx2  |0004       |6              |
|2       |0002          |0002         |DiscountQtyx2  |0001       |5             |
|3       |0002          |0002         |DiscountQtyx2  |0002       |5             |
|4       |0002          |0002         |DiscountQtyx2  |0003       |5             

!-- ===========================================================================================
Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to trigger 1st Step

Given a MixMatchData of the following:
|MMCode|MMQ|MMDiscountRate|MMDescription|MMQ2|MMDiscountRate2|
|0002  |3  |10|DiscountQtyx3|7   |15    |

!-- 1ST ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemA |100   |3  |0001       |
When I compute discount of 2ndStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |

!-- ===========================================================================================

!-- [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 1st Step was triggered
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemB |100   |1  |0002       |
When I compute discount of 2ndStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |
|1       |0002          |0002         |DiscountQtyx3  |0001       |10             |
|2       |0002          |0002         |DiscountQtyx3  |0002       |10             |

Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to trigger 2nd Step

Given a MixMatchData of the following:
|MMCode|MMQ|MMDiscountRate|MMDescription|MMQ2|MMDiscountRate2|
|0002  |2  |10|DiscountQtyx5|5   |15    |

!-- 1ST ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemA |100   |1  |0001       |
When I compute discount of 2ndStepUniformity
Then I should get {0} discounts

!-- 2ND ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemB |100   |1  |0002       |
When I compute discount of 2ndStepUniformity
Then I should get {2} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |10             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |10             |

!-- 3RD ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemC |100   |1  |0003       |
When I compute discount of 2ndStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |10             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |10             |
|3       |0002          |0002         |DiscountQtyx5  |0003       |10             |

!-- 4TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemD |90   |1  |0004       |
When I compute discount of 2ndStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |10             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |10             |
|3       |0002          |0002         |DiscountQtyx5  |0003       |10             |
|4       |0002          |0002         |DiscountQtyx5  |0004       |9              |

!-- 5TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemE |90   |1  |0005       |
When I compute discount of 2ndStepUniformity
Then I should get {5} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |15             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |15             |
|3       |0002          |0002         |DiscountQtyx5  |0003       |15             |
|4       |0002          |0002         |DiscountQtyx5  |0004       |14             |
|5       |0002          |0002         |DiscountQtyx5  |0005       |13             |
 
Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 2nd Step was triggered
!-- 6th ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemF |90   |1  |0006       |
When I compute discount of 2ndStepUniformity
Then I should get {6} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |15             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |15             |
|3       |0002          |0002         |DiscountQtyx5  |0003       |15             |
|4       |0002          |0002         |DiscountQtyx5  |0004       |13             |
|5       |0002          |0002         |DiscountQtyx5  |0005       |13             |
|6       |0002          |0002         |DiscountQtyx5  |0006       |14             |

!-- 7TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemG |80   |1  |0007       |
When I compute discount of 2ndStepUniformity
Then I should get {7} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |DiscountQtyx5  |0001       |15             |
|2       |0002          |0002         |DiscountQtyx5  |0002       |15             |
|3       |0002          |0002         |DiscountQtyx5  |0003       |15             |
|4       |0002          |0002         |DiscountQtyx5  |0004       |13             |
|5       |0002          |0002         |DiscountQtyx5  |0005       |13             |
|6       |0002          |0002         |DiscountQtyx5  |0006       |13             |
|7       |0002          |0002         |DiscountQtyx5  |0007       |13             |

!-- =====================================================================================
Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items to trigger 2nd Step

Given a MixMatchData of the following:
|MMCode|MMQ|MMDiscountRate|MMDescription|MMQ2|MMDiscountRate2|
|0002  |3  |10|QtyDiscountx5|5   |15    |

When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemA |50   |5  |0001       |
When I compute discount of 2ndStepUniformity
Then I should get {5} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0001       |7  
|1       |0002          |0002         |QtyDiscountx5  |0001       |7  
|1       |0002          |0002         |QtyDiscountx5  |0001       |7  
|1       |0002          |0002         |QtyDiscountx5  |0001       |7  
|1       |0002          |0002         |QtyDiscountx5  |0001       |9

Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 2nd Step was triggered

!-- 2ND ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemC |60   |1  |0002       |
When I compute discount of 2ndStepUniformity
Then I should get {6} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0002       |9              |
|2       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|2       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|2       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|2       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|2       |0002          |0002         |QtyDiscountx5  |0001       |9              |

!-- 3RD ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemD |70   |1  |0003       |
When I compute discount of 2ndStepUniformity
Then I should get {7} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0003       |11             |
|2       |0002          |0002         |QtyDiscountx5  |0002       |9              |
|3       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|3       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|3       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|3       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|3       |0002          |0002         |QtyDiscountx5  |0001       |5              |

!-- 4TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemE |95   |1  |0004       |
When I compute discount of 2ndStepUniformity
Then I should get {8} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0004       |14             |
|2       |0002          |0002         |QtyDiscountx5  |0003       |10             |
|3       |0002          |0002         |QtyDiscountx5  |0002       |9              |
|4       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|4       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|4       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|4       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|4       |0002          |0002         |QtyDiscountx5  |0001       |10             |

!-- 5TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemF |95   |2  |0005       |
When I compute discount of 2ndStepUniformity
Then I should get {10} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0004       |14             |
|2       |0002          |0002         |QtyDiscountx5  |0005       |14             |
|2       |0002          |0002         |QtyDiscountx5  |0005       |14             |
|3       |0002          |0002         |QtyDiscountx5  |0003       |10             |
|4       |0002          |0002         |QtyDiscountx5  |0002       |9              |
|5       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|5       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|5       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|5       |0002          |0002         |QtyDiscountx5  |0001       |7              |
|5       |0002          |0002         |QtyDiscountx5  |0001       |10             |

!-- 6TH ENTRY
When I add item to Sale:
|name  |price|quantity|itementryid|
|ItemG |95   |1  |0006       |
When I compute discount of 2ndStepUniformity
Then I should get {11} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |QtyDiscountx5  |0004       |14             |
|2       |0002          |0002         |QtyDiscountx5  |0005       |14             |
|2       |0002          |0002         |QtyDiscountx5  |0005       |14             |
|3       |0002          |0002         |QtyDiscountx5  |0006       |14             |
|4       |0002          |0002         |QtyDiscountx5  |0003       |11             |
|5       |0002          |0002         |QtyDiscountx5  |0002       |9              |
|6       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|6       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|6       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|6       |0002          |0002         |QtyDiscountx5  |0001       |8              |
|6       |0002          |0002         |QtyDiscountx5  |0001       |6             |