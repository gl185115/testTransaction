[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for temp:temp:war:temp
[WARNING] 'groupId' contains an expression but should be a constant. @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 8, column 14
[WARNING] 'artifactId' contains an expression but should be a constant. @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 4, column 17
[WARNING] 'version' contains an expression but should be a constant. @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 9, column 14
[WARNING] 'dependencies.dependency.systemPath' for atg.taglib.json:json-taglib:jar should not point at files within the project directory, ${basedir}/WebContent/WEB-INF/lib/json-taglib-0.4.1.jar will be unresolvable by dependent projects @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 99, column 25
[WARNING] 'dependencies.dependency.systemPath' for com.lowagie.text:com.springsource.com.lowagie.text:jar should not point at files within the project directory, ${basedir}/WebContent/WEB-INF/lib/com.springsource.com.lowagie.text-2.0.8.jar will be unresolvable by dependent projects @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 118, column 25
[WARNING] 'dependencies.dependency.systemPath' for RXTXcomm:RXTXcomm:jar should not point at files within the project directory, ${basedir}/WebContent/WEB-INF/lib/RXTXcomm.jar will be unresolvable by dependent projects @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 131, column 25
[WARNING] 'dependencies.dependency.systemPath' for ncr.res.pointserver:pointserver-interface-mobile:jar should not point at files within the project directory, ${basedir}/WebContent/WEB-INF/lib/pointserver-interface-mobile.jar will be unresolvable by dependent projects @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 194, column 25
[WARNING] 'dependencies.dependency.systemPath' for sqljdbc42:sqljdbc42:jar should not point at files within the project directory, ${basedir}/WebContent/WEB-INF/lib/sqljdbc42.jar will be unresolvable by dependent projects @ ${myGroupId}:${myArtifactId}:${myVersion}, D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\pom.xml, line 287, column 25
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building RESTransactionService temp
[INFO] ------------------------------------------------------------------------
[WARNING] The POM for ncr.res.base.javalib:toppan-giftcard-mobile:jar:1.0.6.13 is invalid, transitive dependencies (if any) will not be available, enable debug logging for more details
[WARNING] The POM for ncr.res.mobilepos:poslog-binding:jar:3.3.1.39 is invalid, transitive dependencies (if any) will not be available, enable debug logging for more details
[INFO] 
[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ temp ---
[INFO] Deleting D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target
[INFO] 
[INFO] --- cobertura-maven-plugin:2.7:clean (default) @ temp ---
[INFO] 
[INFO] --- buildnumber-maven-plugin:1.3:create (default) @ temp ---
[INFO] Change the default 'svn' provider implementation to 'javasvn'.
[INFO] Storing buildNumber: 81749 at timestamp: 30-10-2018 15:45:32
[INFO] Storing buildScmBranch: trunk
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.9:prepare-agent (default-check) @ temp ---
[INFO] argLine set to -javaagent:C:\\Users\\DaLian_RServer\\.m2\\repository\\org\\jacoco\\org.jacoco.agent\\0.7.9\\org.jacoco.agent-0.7.9-runtime.jar=destfile=D:\\Eclipse_Kinokuniya_WorkSpace_New\\RESTransactionService_trunk\\target\\jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ temp ---
[INFO] Using 'MS932' encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] Copying 6 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.6.0:compile (default-compile) @ temp ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 722 source files to D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\classes
[WARNING] /D:/Eclipse_Kinokuniya_WorkSpace_New/RESTransactionService_trunk/src/ncr/res/mobilepos/queuebuster/dao/SQLServerQueueBusterDao.java:[967,21] ncr.res.mobilepos.queuebuster.dao.IQueueBusterDAOÇÃupdatePreviousAmount(java.sql.Connection,ncr.res.mobilepos.queuebuster.model.CashDrawer)ÇÕîÒêÑèßÇ…Ç»ÇËÇ‹ÇµÇΩ
[INFO] 
[INFO] --- native2ascii-maven-plugin:1.0-beta-1:native2ascii (native2ascii-ja-resources) @ temp ---
[INFO] Includes: [receiptlabel_ja.properties, label_ja.properties]
[INFO] Excludes: []
[INFO] Processing D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\classes\label_ja.properties
[INFO] Processing D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\classes\receiptlabel_ja.properties
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.9:instrument (default-instrument) @ temp ---
[INFO] Skipping JaCoCo execution because property jacoco.skip is set.
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ temp ---
[INFO] Using 'MS932' encoding to copy filtered resources.
[INFO] Copying 86 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.6.0:testCompile (default-testCompile) @ temp ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 162 source files to D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\test-classes
[WARNING] /D:/Eclipse_Kinokuniya_WorkSpace_New/RESTransactionService_trunk/test/ncr/res/mobilepos/initialization/resource/InitializationStatusResourceSteps.java:[91,48] ñ≥åüç∏ïœä∑
  ä˙ë“íl: java.util.List<ncr.res.mobilepos.pricing.model.QrCodeInfo>
  åüèoíl:    java.util.List
[WARNING] /D:/Eclipse_Kinokuniya_WorkSpace_New/RESTransactionService_trunk/test/ncr/res/mobilepos/initialization/resource/InitializationStatusResourceSteps.java:[97,54] ñ≥åüç∏ïœä∑
  ä˙ë“íl: java.util.List<ncr.res.mobilepos.pricing.model.PricePromInfo>
  åüèoíl:    java.util.List
[WARNING] /D:/Eclipse_Kinokuniya_WorkSpace_New/RESTransactionService_trunk/test/ncr/res/mobilepos/initialization/resource/InitializationStatusResourceSteps.java:[103,50] ñ≥åüç∏ïœä∑
  ä˙ë“íl: java.util.List<ncr.res.mobilepos.pricing.model.PriceMMInfo>
  åüèoíl:    java.util.List
[WARNING] /D:/Eclipse_Kinokuniya_WorkSpace_New/RESTransactionService_trunk/test/ncr/res/mobilepos/initialization/resource/InitializationStatusResourceSteps.java:[109,50] ñ≥åüç∏ïœä∑
  ä˙ë“íl: java.util.List<ncr.res.mobilepos.pricing.model.TaxRateInfo>
  åüèoíl:    java.util.List
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ temp ---

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running ncr.res.mobilepos.additem.test.AddItemFromEnterpriseTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.815 sec - in ncr.res.mobilepos.additem.test.AddItemFromEnterpriseTest
Running ncr.res.mobilepos.additem.test.AddItemTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/additem/test/add_item_test.scenario

(ncr/res/mobilepos/additem/test/add_item_test.scenario)
Scenario: Add Item Test (AutoDiscount, NonDiscountable, NonDiscountable)
Using timeout for story add_item_test.scenario of 300 secs.
Given the Web API Starts Up with test/ncr/res/mobilepos/additem/test/prm_system_config_12taxrate_roundup.xml System Configuration
Given an items test/ncr/res/mobilepos/additem/test/items_autodiscount.xml in database
Given a companyid 01 storeid 0247 workstationid 0004 businessdate 2016-07-21 seqno 1553 PriceCheck 1

Scenario: Add Auto Discount Amount (500.0) Item
When I add an item 4957669206754
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|7398.0|4957669206754|1|0.0|500|397|ÇkÉoÉâÉEÉbÉh|0|


Scenario: Add Auto Discount Rate (30%) Item
When I add an item 4957669622196
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|ÇlÇiÇqÇnÇxÇ`Çk ÇaÇjÇSÇUÇT|120000.0|4957669622196|1|30.0|0|393|ÇlÉoÉâÉEÉEÉbÉh|0|


Scenario: Add NonDiscountable Item
When I add an item 0000906404728
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|ÉuÅ[Éc|23000.0|0000906404728|1|0.0|0|811|ÇlÉJÉWÉÖÉAÉãÉVÉÖÅ[ÉY|0|


Scenario: Add Discountable Item
When I add an item 4908094832094
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|ÇvÇèÇèÇå ÇaÇíÇèÇÅÇÑ ÇaÇèÇèÇé|4900.0|4908094832094|1|0.0|0|570|ÉgÉåÉbÉLÉìÉOè¨ï®|0|


Scenario: Add Tax Inclusive Item
!-- TaxType is 1. ActualSalesPrice has no tax computation (computation is done in UI).
Given an items test/ncr/res/mobilepos/additem/test/items_taxinclusive.xml in database
Then the data in MST_PLU should have the following:

|CompanyId|StoreId|MdInternal|Dpt|SalesPrice1|MdNameLocal|TaxType|
|01|0|0012345670022|9999|3000|LOCAL_PLU_89|1|

When I add an item 0012345670022
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|LOCAL_PLU_89|3000.0|0012345670022|1|0.0|0|9999|äYìññ≥Åiã≥â»èëÅj|1|


Scenario: Add Tax Exclusive Item
!-- TaxType is 0. ActualSalesPrice has no tax computation (computation is done in UI).
Given an items test/ncr/res/mobilepos/additem/test/items_taxexclusive.xml in database
Then the data in MST_PLU should have the following:

|CompanyId|StoreId|MdInternal|Dpt|SalesPrice1|MdNameLocal|TaxType|
|01|0|0012345670015|0198|2000|LOCAL_PLU_88|0|

When I add an item 0012345670015
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|LOCAL_PLU_88|2000.0|0012345670015|1|0.0|0|0198|ÇªÇÃëºèëê–|0|


Scenario: Add Tax Free Item
!-- TaxType is 2. ActualSalesPrice has no tax computation (computation is done in UI).
Given an items test/ncr/res/mobilepos/additem/test/items_taxfree.xml in database
Then the data in MST_PLU should have the following:

|CompanyId|StoreId|MdInternal|Dpt|SalesPrice1|MdNameLocal|TaxType|
|01|0|0012345670039|0195|3000|LOCAL_PLU_90|2|

When I add an item 0012345670039
Then I should get the following:

|Description(ja)|ActualSalesUnitPrice|ItemID|Quantity|DiacountRate|DiscountAmt|Department|DptNameLocal|TaxType|
|LOCAL_PLU_90|3000.0|0012345670039|1|0.0|0|0195|ï∂å…/ÉRÉ~ÉbÉN|2|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 2 stories (of which 0 pending) containing 8 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.433 sec - in ncr.res.mobilepos.additem.test.AddItemTest
Running ncr.res.mobilepos.appserver.resource.test.GetAppServersTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/appserver/resource/test/get_app_servers_test.scenario

(ncr/res/mobilepos/appserver/resource/test/get_app_servers_test.scenario)
Scenario: Get App Servers with data
Using timeout for story get_app_servers_test.scenario of 300 secs.
Given data in table PRM_SERVER_TABLE
When I get app servers
Then I should get NCRWSSResultCode:0
Then I should get the following:

|Name|Type|Url|IISUrl|
|AP Server (IIS)|WOApi||http://localhost:8086/WOApi/HealthCheckAPI/|
|AP Server (TOMCAT)|resTransaction|http://localhost:8080/resTransaction/rest/initialization/status||

Then the JSON should have the following format: {"Servers":[{"Name":"AP Server (IIS)","Type":"WOApi","IISUrl":"http://localhost:8086/WOApi/HealthCheckAPI/"},{"Name":"AP Server (TOMCAT)","Type":"resTransaction","Url":"http://localhost:8080/resTransaction/rest/initialization/status"}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Get App Servers with 0 data
Given an empty table in PRM_SERVER_TABLE
When I get app servers
Then I should get NCRWSSResultCode:0
Then I should get Servers=null
Then the JSON should have the following format: {"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 3 stories (of which 0 pending) containing 10 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.532 sec - in ncr.res.mobilepos.appserver.resource.test.GetAppServersTest
Running ncr.res.mobilepos.attribute.test.GetAttributeTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/attribute/test/get_attribute_test.scenario

(ncr/res/mobilepos/attribute/test/get_attribute_test.scenario)
Scenario: Get attribute info where companyId is empty
Using timeout for story get_attribute_test.scenario of 300 secs.
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId empty, storeId 0247, terminalId 0001 and training 0
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get attribute info where storeId is null
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId 01, storeId null, terminalId 0001 and training 0
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get attribute info where storeId is empty
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId 01, storeId , terminalId 0001 and training 0
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get attribute info where terminalId is null
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId 01, storeId 0247, terminalId null and training 0
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get attribute info where terminalId is empty
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId 01, storeId 0247, terminalId  and training 0
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Successfully get attribute info
Given I have a DeviceInfo resource and other resources
When I request to get attribute info of companyId 01, storeId 0247, terminalId 0001 and training 0
Then I should have the following data:

|attributeId|printer|till|creditTerminal|MSR|cashChanger|attribute1|attribute2|attribute3|attribute4|attribute5|attribute6|attribute7|attribute8|training|
|1|1|Auto|1|1|0|1|1|1|0|0|1|1|0|0|

Then the result should be RES_OK



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 4 stories (of which 0 pending) containing 16 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.003 sec - in ncr.res.mobilepos.attribute.test.GetAttributeTest
Running ncr.res.mobilepos.authentication.resource.test.AdminResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/resource/test/admin_resource_test.scenario

(ncr/res/mobilepos/authentication/resource/test/admin_resource_test.scenario)
Scenario: setAdminKey normal
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_AdminKey_123456.xml
Using timeout for story admin_resource_test.scenario of 300 secs.
Given the adminkey is set to 123456
When I set the adminKey to ADMINXYZ using ADMINABC
Then the result should be 0

Scenario: set passcode normal
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_Passcode_123.xml
Given the passcode is set to 123
When I set the passcode to PASSJKL using ADMINXYZ
Then the result should be 0

Scenario: update non-existing adminkey
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_AdminKey_123456.xml
Given the adminkey is set to 123456
When I set the adminKey to ADMINXYZ using ADMIN
Then the result should be 103

Scenario: update passcode with non-existing adminkey
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_Passcode_123.xml
Given the passcode is set to 123
When I set the passcode to PASSJKL using ADMIN
Then the result should be 103

Scenario: update passcode with non-existing expiry
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_Passcode_321.xml
Given the passcode is set to 321
When I set the passcode to PASSJKL using ADMINXYZ
Then the result should be 133

Scenario: set passcode with non-alphanumeric characters
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_Passcode_123.xml
Given the passcode is set to 123
When I set the passcode to 12345! using ADMINXYZ
Then the result should be 110

Scenario: set AdminKey with non-alphanumeric characters
DataSet:test/ncr/res/mobilepos/authentication/resource/test/forAdminResourceTest.xml
Given an Admin Resource
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/PRM_SYSTEM_CONFIG_AdminKey_123456.xml
Given the adminkey is set to 123456
When I set the adminKey to 123456( using ADMINXYZ
Then the result should be 109



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 5 stories (of which 0 pending) containing 23 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.423 sec - in ncr.res.mobilepos.authentication.resource.test.AdminResourceTest
Running ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceActivationKeyTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/resource/test/authentication_resource_activation_key_test.scenario

(ncr/res/mobilepos/authentication/resource/test/authentication_resource_activation_key_test.scenario)
Scenario: Test authentication with no pending signature server activation
!-- Call SignActivationList.getActivationKey to retrieve activation key and signTid when signStatus is 0
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Using timeout for story authentication_resource_activation_key_test.scenario of 300 secs.
Given an Authentication Resource
When I authenticate the device: corpid 000000000000, storeid 000031, terminalid 1111, uuid 69758ab0-3ae6-4397-b3c9-b3fc53d3d04e, udid cc4acfb8acfcd3cb8712d61ee2365b96ce32dabc
Then the result should be 0
Then the signStatus should be 0
Then the activationKey.signActivationKey should be empty
Then the activationKey.signTid should be empty
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><deviceStatus><message>Device authentication result</message><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><corpCompany></corpCompany><corpID></corpID><corpName></corpName><deviceName></deviceName><signStatus>0</signStatus><storeID>000031</storeID><storeName></storeName><terminalID>1111</terminalID><terminalStatus>0</terminalStatus><webAppUrl></webAppUrl></deviceStatus>

Scenario: Test authentication with pending signature server activation
!-- Call SignActivationList.getActivationKey to retrieve activation key and signTid when signStatus is 0
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Given an Authentication Resource
When I authenticate the device: corpid 9999, storeid 000001, terminalid 1234, uuid 79758ab0-3ae6-4397-b3c9-b3fc53d3d04f, udid bc4acfb8acfcd3cb8712d61ee2365b96ce32daba
Then the result should be 0
Then the signStatus should be 0
Then the activationKey.signActivationKey should be empty
Then the activationKey.signTid should be empty
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><deviceStatus><message>Device authentication result</message><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><corpCompany></corpCompany><corpID></corpID><corpName></corpName><deviceName></deviceName><signStatus>0</signStatus><storeID>000001</storeID><storeName></storeName><terminalID>1234</terminalID><terminalStatus>0</terminalStatus><webAppUrl></webAppUrl></deviceStatus>

Scenario: Test authentication with already activated signStatus
!-- Call SignActivationList.getActivationKey to retrieve activation key and signTid when signStatus is 0
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Given an Authentication Resource
When I authenticate the device: corpid 000000000000, storeid 000031, terminalid 2222, uuid 69758ab0-3ae6-4397-b3c9-b3fc53d3d04f, udid cc4acfb8acfcd3cb8712d61ee2365b96ce32daba
Then the result should be 0
Then the signStatus should be 0
Then the activationKey.signActivationKey should be empty
Then the activationKey.signTid should be empty
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><deviceStatus><message>Device authentication result</message><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><corpCompany></corpCompany><corpID></corpID><corpName></corpName><deviceName></deviceName><signStatus>0</signStatus><storeID>000031</storeID><storeName></storeName><terminalID>2222</terminalID><terminalStatus>0</terminalStatus><webAppUrl></webAppUrl></deviceStatus>



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 6 stories (of which 0 pending) containing 26 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.723 sec - in ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceActivationKeyTest
Running ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceSetActivationStatusTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/resource/test/authentication_resource_set_activation_status_test.scenario

(ncr/res/mobilepos/authentication/resource/test/authentication_resource_set_activation_status_test.scenario)
Scenario: Test setting of signature service activation status for a device
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Using timeout for story authentication_resource_set_activation_status_test.scenario of 300 secs.
Given an Authentication Resource
!-- call AuthenticationResource.setActivationStatus()
When I set activation status of device {000000000000,000031,1111,cc4acfb8acfcd3cb8712d61ee2365b96ce32dabc,69758ab0-3ae6-4397-b3c9-b3fc53d3d04e} to signstatus 1, signtid {XXXXX00011245}, signactivationkey ABC12356
When I authenticate the device: corpid {000000000000}, storeid 000031, terminalid 1111, uuid {69758ab0-3ae6-4397-b3c9-b3fc53d3d04e}, udid {cc4acfb8acfcd3cb8712d61ee2365b96ce32dabc}
Then the result should be 0
Then the signStatus should be 0
Then the activationKey.signActivationKey should be empty
Then the activationKey.signTid should be empty

Scenario: Test setting of signature service activation status for a device different corpid
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Given an Authentication Resource
!-- call AuthenticationResource.setActivationStatus()
When I set activation status of device {9999,000001,1234,bc4acfb8acfcd3cb8712d61ee2365b96ce32daba,79758ab0-3ae6-4397-b3c9-b3fc53d3d04f} to signstatus 1, signtid {XXXXX00011246}, signactivationkey ABC12357
When I authenticate the device: corpid 9999, storeid 000001, terminalid 1234, uuid {79758ab0-3ae6-4397-b3c9-b3fc53d3d04f}, udid {bc4acfb8acfcd3cb8712d61ee2365b96ce32daba}
Then the result should be 0
Then the signStatus should be 0
Then the activationKey.signActivationKey should be empty
Then the activationKey.signTid should be empty



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 7 stories (of which 0 pending) containing 28 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.509 sec - in ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceSetActivationStatusTest
Running ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/resource/test/authentication_resource_test.scenario

(ncr/res/mobilepos/authentication/resource/test/authentication_resource_test.scenario)
Scenario: test get device status
DataSet:test/ncr/res/mobilepos/authentication/resource/test/insertAuthResourceDevices.xml
Using timeout for story authentication_resource_test.scenario of 300 secs.
Given an Authentication Resource
When I authenticate the device: 000000000000, 000031, 1111, 69758ab0-3ae6-4397-b3c9-b3fc53d3d04e, cc4acfb8acfcd3cb8712d61ee2365b96ce32dabc
Then the result should be 0
When I authenticate the device: 000000000000, 000031, a, a, a
Then the result should be 102



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 8 stories (of which 0 pending) containing 29 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.632 sec - in ncr.res.mobilepos.authentication.resource.test.AuthenticationResourceTest
Running ncr.res.mobilepos.authentication.resource.test.RegistrationResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/resource/test/registration_resource_test.scenario

(ncr/res/mobilepos/authentication/resource/test/registration_resource_test.scenario)
Scenario: Initialization Common
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/AUTH_DEVICES_Empty.xml
Given AUT_DEVICES is empty
DataSet:test/ncr/res/mobilepos/authentication/resource/datasets/MST_CORP_URL.xml
Using timeout for story registration_resource_test.scenario of 300 secs.
Given dataset MST_CORP_URL.xml is loaded

Scenario: Device Registration invalid passcode
Given a Registration Resource
When I register a device of companyid 01 storeid 0001 deviceid 1111 devicename Firefox passcode 124 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 13
Then the device data returned should be:

|corpid|corpname|storeid|storename|deviceid|devicename|
|||||||


Scenario: Device Registration unknown storeid in CORPSTORE
Given a Registration Resource
When I register a device of companyid 01 storeid 000001 deviceid 1111 devicename Firefox passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 11
Then the device data returned should be:

|corpid|corpname|storeid|storename|deviceid|devicename|
|||||||


Scenario: Device Registration Permission denied
Given a Registration Resource
When I register a device of companyid 01 storeid 000033 deviceid 1111 devicename Firefox passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 14
Then the device data returned should be:

|corpid|corpname|storeid|storename|deviceid|devicename|
|||||||


Scenario: Device Registration success
Given a Registration Resource
When I register a device of companyid 01 storeid 000031 deviceid 1111 devicename device 1111 passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 0
Then the device data returned should be:

|storeid|storename|deviceid|devicename|
|000031|TestStore1|1111|device 1111|


Scenario: Device Registration duplicate storeid, terminalid
Given a Registration Resource
When I register a device of companyid 01 storeid 000031 deviceid 1111 devicename device1111@888 passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 101

Scenario: Device Registration success
Given a Registration Resource
When I register a device of companyid 01 storeid 000031 deviceid 2222 devicename device's 2222 passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 0
Then the device data returned should be:

|storeid|storename|deviceid|devicename|
|000031|TestStore1|2222|device's 2222|


Scenario: Device Registration duplicate terminalid but in different store
Given a Registration Resource
When I register a device of companyid 01 storeid 000032 deviceid 1111 devicename device1111@999-000032 passcode 999 udid 0000000000000000000000000000000000000000 uuid eb7068c3-9412-4024-86a9-c42ff5c908f1 signstatus 1 signtid {} signactivationkey {}
Then result should be 0
Then the device data returned should be:

|corpid|corpname|storeid|storename|deviceid|devicename|
|999|TestCorp|000032|TestStore2|1111|device1111@999-000032|

Then the following authenticated devices in the database should be:

|storeid|terminalid|state|
|000031|1111|1|
|000031|2222|1|
|000032|1111|1|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 9 stories (of which 0 pending) containing 37 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.738 sec - in ncr.res.mobilepos.authentication.resource.test.RegistrationResourceTest
Running ncr.res.mobilepos.authentication.test.AuthenticationTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/test/authentication_test.scenario

(ncr/res/mobilepos/authentication/test/authentication_test.scenario)
Scenario: Device Authentication
Given the Web API Starts Up with test/ncr/res/mobilepos/authentication/test/prm_system_config_12taxrate_roundup.xml System Configuration
Using timeout for story authentication_test.scenario of 300 secs.
Given a deviceinfo test/ncr/res/mobilepos/authentication/test/data_devices.xml in database

Scenario: Authenticate device (Before registration - failed)
When I authenticate device companyid {} storeid {} deviceid {} training 0 udid 0 uuid 0
Then I should get the NCRWSSResultCode 102

Scenario: Authenticate device (post-registration/reload - failed scenario)
When I authenticate device companyid 01 storeid 0247 deviceid 0003 training 0 udid 0000000000000000000000000000000000000000 uuid 3248bf2c-17ff-4481-8270-aadf0b766934
Then I should get the NCRWSSResultCode 102

Scenario: Authenticate Unregistered device (Successful authentication)
When I authenticate device companyid 01 storeid 0247 deviceid 0004 training 0 udid 0000000000000000000000000000000000000000 uuid 3248bf2c-17ff-4481-8270-aadf0b766934
Then I should get the following:

|Message|StoreID|CorpID|TerminalId|signStatus|NCRWSSResultCode|
|Device authentication result|0247|01|0004|1|0|

Then I should get the device info:

|CompanyId|RetailStoreID|DeviceID|Name|NCRWSSResultCode|
|01|0247|0004|POS#4|0|

Then I should get attributes:

|message|NCRWSSResultCode|
|Success|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 10 stories (of which 0 pending) containing 41 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.639 sec - in ncr.res.mobilepos.authentication.test.AuthenticationTest
Running ncr.res.mobilepos.authentication.test.RegistrationTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/authentication/test/registration_test.scenario

(ncr/res/mobilepos/authentication/test/registration_test.scenario)
Scenario: Device Registration
Given the Web API Starts Up with test/ncr/res/mobilepos/authentication/test/prm_system_config_12taxrate_roundup.xml System Configuration
Using timeout for story registration_test.scenario of 300 secs.
Given a deviceinfo test/ncr/res/mobilepos/authentication/test/data_devices.xml in database

Scenario: Register device(Failed registration - Non-Existing StoredId)
When I get device attribute companyid 01 storeid 0001 terminalid 0001
Then I should get the resultcode resultCode 157

Scenario: Register device(Successful registration)
When I get device attribute companyid 01 storeid 0247 terminalid 0003
Then I should get the following:

|Message|CompanyId|StoreId|TerminalId|DeviceName|NCRWSSResultCode|
|Success|01|0247|0003|POS#3|0|

When I register device companyid 01 storeid 0247 terminalid 0003 devicename  passcode  uuid 834b647f-bda7-4f5c-b1a9-42ab6b27b356 udid 0000000000000000000000000000000000000000 signstatus 1
Then I should get the following registration response:

|Message|StoreID|CorpID|TerminalId|NCRWSSResultCode|
|Registration Success|0247|01|0003|0|

Then I should get the following attribute message Success
Then I should get the following terminal info response 0



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 11 stories (of which 0 pending) containing 44 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.54 sec - in ncr.res.mobilepos.authentication.test.RegistrationTest
Running ncr.res.mobilepos.barcode.resource.test.GetDiscountInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/barcode/resource/test/get_discount_info_test.scenario

(ncr/res/mobilepos/barcode/resource/test/get_discount_info_test.scenario)
Scenario: If no common/specific store, response with 157 error code
Given an empty table in MST_PRICE_DISCOUNT
When I get discount information of companyid:01 storeid:0247 cardtype:86 seqno:15 discounttype:3
Then I should get NCRWSSResultCode:157
Then the JSON should have the following format: {"message":"No Rows Available","NCRWSSResultCode":157,"NCRWSSExtendedResultCode":157}

Scenario: If specific store only, gets discount information of specific store then response should have specific storeid
Using timeout for story get_discount_info_test.scenario of 300 secs.
Given data in table MST_PRICE_DISCOUNT
When I get discount information of companyid:01 storeid:0247 cardtype:86 seqno:15 discounttype:3
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"[{\"companyId\":\"01\",\"storeId\":\"0247\",\"cardType\":\"86\",\"seqNo\":\"15\",\"subNo\":\"1\",\"discountType\":\"3\",\"discountClass\":\"1\",\"dpt\":\"000\",\"discountRefType\":\"1\",\"discountValue\":\"20\",\"startDate\":\"2011-12-01\",\"endDateRefType\":\"1\",\"endDate\":\"2099-12-31\",\"entryDate\":\"2011-11-11\",\"discountName\":\"DMïîñÂäÑà¯\"}]","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: If common store only, gets discount information of common store but response should have specific storeid
When I get discount information of companyid:02 storeid:0247 cardtype:86 seqno:15 discounttype:3
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"[{\"companyId\":\"02\",\"storeId\":\"0247\",\"cardType\":\"86\",\"seqNo\":\"15\",\"subNo\":\"1\",\"discountType\":\"3\",\"discountClass\":\"1\",\"dpt\":\"000\",\"discountRefType\":\"1\",\"discountValue\":\"20\",\"startDate\":\"2011-12-01\",\"endDateRefType\":\"1\",\"endDate\":\"2099-12-31\",\"entryDate\":\"2011-11-11\",\"discountName\":\"DMïîñÂäÑà¯\"}]","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: If both common and specific store, gets discount information of specific store then response should have specific storeid
When I get discount information of companyid:03 storeid:0247 cardtype:86 seqno:15 discounttype:3
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"[{\"companyId\":\"03\",\"storeId\":\"0247\",\"cardType\":\"86\",\"seqNo\":\"15\",\"subNo\":\"1\",\"discountType\":\"3\",\"discountClass\":\"1\",\"dpt\":\"000\",\"discountRefType\":\"1\",\"discountValue\":\"20\",\"startDate\":\"2011-12-01\",\"endDateRefType\":\"1\",\"endDate\":\"2099-12-31\",\"entryDate\":\"2011-11-11\",\"discountName\":\"DMïîñÂäÑà¯\"}]","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 12 stories (of which 0 pending) containing 48 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.516 sec - in ncr.res.mobilepos.barcode.resource.test.GetDiscountInfoTest
Running ncr.res.mobilepos.barcodeassignment.util.BarcodeAssignmentUtilityTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in ncr.res.mobilepos.barcodeassignment.util.BarcodeAssignmentUtilityTest
Running ncr.res.mobilepos.cashaccount.resource.test.GetCashTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/cashaccount/resource/test/get_cash_test.scenario

(ncr/res/mobilepos/cashaccount/resource/test/get_cash_test.scenario)
Scenario: Get Cash on Hand with missing TillId (ItemType = 3 [Purchase, deposit / withdrawal, others])
Using timeout for story get_cash_test.scenario of 300 secs.
Given a RESTransaction table data txu_total_dailyreport
Given a CashAccount Resource
When getting the cash balance for 01 0247 null 0001 2016-06-29 0 3 07 06
Then resultCode should be 0
Then cashOnHand should be 20000

Scenario: Get Cash on Hand with TillId (ItemType = 3 [Purchase, deposit / withdrawal, others])
Given a RESMaster table data devices
Given a CashAccount Resource
When getting the cash balance for 01 0247 02470001 0001 2016-06-29 0 3 07 06
Then resultCode should be 0
Then cashOnHand should be 20000



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 13 stories (of which 0 pending) containing 50 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.042 sec - in ncr.res.mobilepos.cashaccount.resource.test.GetCashTest
Running ncr.res.mobilepos.constant.EnvironmentEntriesTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in ncr.res.mobilepos.constant.EnvironmentEntriesTest
Running ncr.res.mobilepos.constant.SystemFileConfigTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/constant/system_file_config_test.scenario

(ncr/res/mobilepos/constant/system_file_config_test.scenario)
Scenario: Normal case 1
Given the system path is test/resources/sys/normal
When SystemFileConfig is instantiated
Then it sucessfully instantiates
Then no Exception is thrown
Then the result should be CompanyID:01 and StoreID:0001

Scenario: Normal case 2
Given the system path is test/resources/sys/datenotset
When SystemFileConfig is instantiated
Then it sucessfully instantiates
Then no Exception is thrown
Then the result should be CompanyID:02 and StoreID:0002
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
Scenario: No CompanyID
Given the system path is test/resources/sys/nocompanyid

	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
When SystemFileConfig is instantiated
Then it fails to instantiate
Then IOException is thrown
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)

Scenario: No StoreID
Given the system path is test/resources/sys/nostoreid
When SystemFileConfig is instantiated
Then it fails to instantiate
Then IOException is thrown
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)

Scenario: Invalid path
Given the system path is xxx/xxx/xxx/xxx
When SystemFileConfig is instantiated
Then it fails to instantiate
Then IOException is thrown
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
javax.naming.NameNotFoundException: Name [java:] is not bound in this Context. Unable to find [java:].
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:492)
	at org.apache.naming.NamingContext.destroySubcontext(NamingContext.java:528)

Scenario: Empty CompanyID
Given the system path is test/resources/sys/emptycompanyid
When SystemFileConfig is instantiated
Then it fails to instantiate
Then IOException is thrown

Scenario: Empty StoreID
Given the system path is test/resources/sys/emptystoreid
When SystemFileConfig is instantiated
Then it fails to instantiate
Then IOException is thrown
	at javax.naming.InitialContext.destroySubcontext(InitialContext.java:481)
	at ncr.res.mobilepos.helper.Requirements.TearDown(Requirements.java:174)
	at ncr.res.mobilepos.constant.SystemFileConfigSteps.tearDownClass(SystemFileConfigSteps.java:33)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$MethodInvoker.invoke(StepCreator.java:958)
	at org.jbehave.core.steps.StepCreator$BeforeOrAfterStep.perform(StepCreator.java:624)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:993)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 14 stories (of which 0 pending) containing 57 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.367 sec - in ncr.res.mobilepos.constant.SystemFileConfigTest
Running ncr.res.mobilepos.constant.WindowsEnvironmentVariablesTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/constant/windows_environment_variables_test.scenario

(ncr/res/mobilepos/constant/windows_environment_variables_test.scenario)
Scenario: Successfully instantiated, ENTERPRISE
Using timeout for story windows_environment_variables_test.scenario of 300 secs.
Given System Variables has key SYS, value C:\\software\\ncr\\res\\sys
Given System Variables has key SERVERTYPE, value ENTERPRISE
When Initialization is triggered
Then No NamingException should be thrown
Then Instance should be created
Then getSystemPath returns C:\\software\\ncr\\res\\sys
Then server type is ENTERPRISE

Scenario: Successfully instantiated, HOST
Given System Variables has key SYS, value C:\\software\\ncr\\res\\sys
Given System Variables has key SERVERTYPE, value HOST
When Initialization is triggered
Then No NamingException should be thrown
Then Instance should be created
Then getSystemPath returns C:\\software\\ncr\\res\\sys
Then server type is HOST

Scenario: instantiation failed.
When Initialization is triggered
Then NamingException should be thrown
Then Instance should not be created

Scenario: instantiation failed, SERVERTYPE is missing.
Given System Variables has key SYS, value C:\\software\\ncr\\res\\sys
When Initialization is triggered
Then NamingException should be thrown
Then Instance should not be created



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 15 stories (of which 0 pending) containing 61 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.8 sec - in ncr.res.mobilepos.constant.WindowsEnvironmentVariablesTest
Running ncr.res.mobilepos.credential.resource.test.ListOperatorsTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/credential/resource/test/list_operators_test.scenario

(ncr/res/mobilepos/credential/resource/test/list_operators_test.scenario)
Scenario: No Operator Listed
Given a table entry named MST_USER_CREDENTIALS_EMPTY.xml in the database
When a request to list all the operators with RetailStoreID 00001 and Key {} and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|

Then the Result Code value returned should be (0)

Scenario: No operators of unknown storeid
Using timeout for story list_operators_test.scenario of 300 secs.
Given a table entry named MST_USER_CREDENTIALS_forListOperators.xml in the database
When a request to list all the operators with RetailStoreID 00002 and Key {} and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|

Then the Result Code value returned should be (0)

Scenario: List Operators with key empty
Given a table entry named MST_USER_CREDENTIALS_forListOperators.xml in the database
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|
|11|Ichiro Suzuki|1|0001|

Then TransactionList should have RetailStoreID of 0247
Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with prefix key operator number(not existing)
When a request to list all the operators with RetailStoreID 0247 and Key 222 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|

Then the Result Code value returned should be (0)

Scenario: List Operators with prefix key operator number(same initial key number)
When a request to list all the operators with RetailStoreID 0247 and Key 1 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with prefix key operator number(complete key operator number)
When a request to list all the operators with RetailStoreID 0247 and Key 11 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with partial key operator name(not existing)
When a request to list all the operators with RetailStoreID 0247 and Key None and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|

Then the Result Code value returned should be (0)

Scenario: List Operators with partial key operator name(lastname) (but added in Key and not in name parameter)
When a request to list all the operators with RetailStoreID 00001 and Key Suzuki and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|

Then the Result Code value returned should be (0)

Scenario: List Operators with partial key operator name(lastname)
Given a table entry named MST_USER_CREDENTIALS_forListOperators.xml in the database
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name Suzuki and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with partial key operator name(firstname)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name Taro and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with partial key operator name(not case sensitive)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name taro and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with partial key operator name(anywhere in the name)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name aro Yamada and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with partial key operator name(complete name)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name Taro Yamada and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with prefix key operator number(complete operator number with null operator name)
When a request to list all the operators with RetailStoreID 0248 and Key 2 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|2||1|0001|

Then TransactionList should have RetailStoreID of 0248
Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0248</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>2</OperatorID><OperatorName></OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0248</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0248</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>2</OperatorID><OperatorName></OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0248</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with prefix key operator number(complete operator number with null operator name, and workstationid)
When a request to list all the operators with RetailStoreID 0248 and Key 3 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|3||1||

Then TransactionList should have RetailStoreID of 0248
Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0248</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>3</OperatorID><OperatorName></OperatorName><OperatorType>1</OperatorType><WorkstationID></WorkstationID><RetailStoreID>0248</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0248</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>3</OperatorID><OperatorName></OperatorName><OperatorType>1</OperatorType><WorkstationID></WorkstationID><RetailStoreID>0248</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with Operator name has a number
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name 1 and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|

Then the Result Code value returned should be (0)

Scenario: List Operators with partial key operator name(lastname) and operatorNo specified
When a request to list all the operators with RetailStoreID 0247 and Key 1 and Name Suzuki and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with null passcode
When a request to list all the operators with RetailStoreID 0249 and Key 4 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|4|Employee 4|1|0001|

Then TransactionList should have RetailStoreID of 0249
Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0249</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>4</OperatorID><OperatorName>Employee 4</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0249</RetailStoreID></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0249</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>4</OperatorID><OperatorName>Employee 4</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0249</RetailStoreID></Employee></EmployeeList></Employees>

Scenario: List Operators with empty passcode
When a request to list all the operators with RetailStoreID 0249 and Key 5 and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|5|Employee 5|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0249</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>5</OperatorID><OperatorName>Employee 5</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0249</RetailStoreID><Passcode></Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0249</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>5</OperatorID><OperatorName>Employee 5</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0249</RetailStoreID><Passcode></Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators using Global Constant
When I set the search limit to 2
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name {} and limit 0
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with limit
When I set the search limit to 1
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name {} and limit 1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operators with limit -1 (All operators)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name {} and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Taro Yamada|1|0001|
|11|Ichiro Suzuki|1|0001|

Then the Result Code returned should be (OK)
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>
Then xml string should be <?xml version="1.0" encoding="UTF-8" standalone="yes"?><Employees><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><RetailStoreID>0247</RetailStoreID><EmployeeList><Employee><CompanyId>01</CompanyId><OperatorID>1</OperatorID><OperatorName>Taro Yamada</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee><Employee><CompanyId>01</CompanyId><OperatorID>11</OperatorID><OperatorName>Ichiro Suzuki</OperatorName><OperatorType>1</OperatorType><WorkstationID>0001</WorkstationID><RetailStoreID>0247</RetailStoreID><Passcode>***</Passcode></Employee></EmployeeList></Employees>

Scenario: List Operator with special charcters
Given a table entry named MST_USER_CREDENTIALS_forListOperatorsWithSpecialChars.xml in the database
!-- Search key with (%) and (_) and ([)
When a request to list all the operators with RetailStoreID 0247 and Key {} and Name % and limit -1
Then I should have the following employees:

|operatorno|operatorname|operatortype|workstationid|
|1|Ta%r_[o] Yamada|1|0001|

Then the Result Code returned should be (OK)



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 16 stories (of which 0 pending) containing 84 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.412 sec - in ncr.res.mobilepos.credential.resource.test.ListOperatorsTest
Running ncr.res.mobilepos.credential.resource.test.SignOnTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/credential/resource/test/sign_on_test.scenario

(ncr/res/mobilepos/credential/resource/test/sign_on_test.scenario)
Scenario: Sign on success
Using timeout for story sign_on_test.scenario of 300 secs.
Given an initial data from MST_USER_CREDENTIALS_forSignOnSignOff.xml
Given a Credential Resource
When signing on companyid 01 operator 111 passcode 333 terminal 0001 isdemo false
Then I should get resultcode 0
Then Operator result should be

|operatorno|passcode|name|
|111||Kimura Suzuki|


Scenario: Sign on fail (incorrect passcode)
Given a Credential Resource
When signing on companyid 01 operator 111 passcode 222 terminal 0001 isdemo false
Then I should get resultcode 306
Then Operator result should be

|operatorno|passcode|name|
||||


Scenario: Sign on fail (operator not found)
Given a Credential Resource
When signing on companyid 01 operator {asdadasdefef} passcode 222 terminal 0001 isdemo false
Then I should get resultcode 305
Then Operator result should be

|operatorno|passcode|name|
||||




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 17 stories (of which 0 pending) containing 87 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.571 sec - in ncr.res.mobilepos.credential.resource.test.SignOnTest
Running ncr.res.mobilepos.customeraccount.test.CustomerAccountTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/customeraccount/test/customer_account_test.scenario

(ncr/res/mobilepos/customeraccount/test/customer_account_test.scenario)
Scenario: Test Customeraccount
Given a loaded dataset test/ncr/res/mobilepos/customeraccount/test/data_customeraccount.xml

Scenario: check companyId isNullOrEmpty.
Using timeout for story customer_account_test.scenario of 300 secs.
When I get loyaltyaccountinfo attribute companyId {} storeId 0001 connName â¡ì°óSéi  connKanaName Ç©Ç∆Ç§  connTel ConnTel1
Then the Result Code is 154

Scenario: check storeId isNullOrEmpty.
When I get loyaltyaccountinfo attribute companyId 01 storeId {} connName â¡ì°óSéi  connKanaName Ç©Ç∆Ç§  connTel ConnTel1
Then the Result Code is 154

Scenario: none of the parameters are null.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0001 connName â¡ì°óSéi connKanaName Ç©Ç∆Ç§ connTel ConnTel1
Then I should get the following:

|ConnCode|ConnName|ConnKanaName|ConnTel|
|0001|â¡ì°óSéi|Ç©Ç∆Ç§Ç‰Ç§Ç∂|ConnTel1001|


Scenario: connName and connKanaName and connTel are null.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0001 connName {} connKanaName {} connTel {}
Then I should get the Result size is 0

Scenario: connKanaName and connTel are null.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0001 connName â¡ì° connKanaName {} connTel {}
Then I should get the following:

|ConnCode|ConnName|ConnKanaName|ConnTel|
|0001|â¡ì°óSéi|Ç©Ç∆Ç§Ç‰Ç§Ç∂|ConnTel1001|
|0002|â¡ì°ñ{àÆ|ÉtÉWÉÇÉgÉAÉLÉâ|ConnTel2001|


Scenario: connName and connTel are null.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0001 connName {} connKanaName Ç©Ç∆Ç§ connTel {}
Then I should get the following:

|ConnCode|ConnName|ConnKanaName|ConnTel|
|0001|â¡ì°óSéi|Ç©Ç∆Ç§Ç‰Ç§Ç∂|ConnTel1001|


Scenario: get common store(0) data.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0247 connName â¡ì° connKanaName {} connTel {}
Then I should get the following:

|ConnCode|ConnName|ConnKanaName|ConnTel|
|0001|â¡ì°óSéicommon|Ç©Ç∆Ç§Ç‰Ç§Ç∂|ConnTel1001|
|0002|â¡ì°ñ{àÆ0247|ÉtÉWÉÇÉgÉAÉLÉâ|ConnTel2001|


Scenario: connName and connKanaName are null.
When I get loyaltyaccountinfo attribute companyId 01 storeId 0001 connName {} connKanaName {} connTel ConnTel1
Then I should get the following:

|ConnCode|ConnName|ConnKanaName|ConnTel|
|0001|â¡ì°óSéi|Ç©Ç∆Ç§Ç‰Ç§Ç∂|ConnTel1001|

{"LoyaltyAccountList":[{"CompanyId":"01","StoreId":"0001","ConnCode":"0001","OrgCode":"01","ConnCat":1,"ConnGrp":"ConnGrp0001","ConnName":"â¡ì°óSéi","ConnKanaName":"Ç©Ç∆Ç§Ç‰Ç§Ç∂","ConnZip":"ConnZip01","ConnAddr":"ConnAddr0001","ConnTel":"ConnTel1001","ConnFax":"ConnFax0001","ConnOwner":"ConnOwner0001","ConnLimit":"ConnLimit0001","ConnCloseDate":"0612","OnlineType":1,"SlipType":2,"PaymentType":3,"CostRate":20,"ConnStartDate":"2015-08-10 00:00:00.0","ConnEndDate":"2015-08-15 00:00:00.0","ConnSubCode":"ConnSubCode0001","SubCode1":"SubCode10001","SubCode2":"SubCode20001","SubCode3":"SubCode30001","SubCode4":"SubCode40001","SubCode5":"SubCode50001","SubNum1":11.0,"SubNum2":12.0,"SubNum3":13.0,"SubNum4":14.0,"SubNum5":15.0}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then the JSON should have the following format : 
{"LoyaltyAccountList":[{"CompanyId":"01","StoreId":"0001","ConnCode":"0001","OrgCode":"01","ConnCat":1,"ConnGrp":"ConnGrp0001","ConnName":"â¡ì°óSéi","ConnKanaName":"Ç©Ç∆Ç§Ç‰Ç§Ç∂","ConnZip":"ConnZip01","ConnAddr":"ConnAddr0001","ConnTel":"ConnTel1001","ConnFax":"ConnFax0001","ConnOwner":"ConnOwner0001","ConnLimit":"ConnLimit0001","ConnCloseDate":"0612","OnlineType":1,"SlipType":2,"PaymentType":3,"CostRate":20,"ConnStartDate":"2015-08-10 00:00:00.0","ConnEndDate":"2015-08-15 00:00:00.0","ConnSubCode":"ConnSubCode0001","SubCode1":"SubCode10001","SubCode2":"SubCode20001","SubCode3":"SubCode30001","SubCode4":"SubCode40001","SubCode5":"SubCode50001","SubNum1":11.0,"SubNum2":12.0,"SubNum3":13.0,"SubNum4":14.0,"SubNum5":15.0}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 18 stories (of which 0 pending) containing 96 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.673 sec - in ncr.res.mobilepos.customeraccount.test.CustomerAccountTest
Running ncr.res.mobilepos.customerclass.resource.test.GetCustomerClassInfoResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/customerclass/resource/test/get_customer_class_info_resource_test.scenario

(ncr/res/mobilepos/customerclass/resource/test/get_customer_class_info_resource_test.scenario)
Scenario: Common StoreId (0) only in MST_CUSTOMERCLASS table
DataSet:test/ncr/res/mobilepos/customerclass/resource/test/MST_CUSTOMERCLASS_Scenario1.xml
Given a table MST_CUSTOMERCLASS_Scenario1.xml
Given that customerclassinfo service
When I get customerclassinfo of CompanyId:01 StoreId:0123
{"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"01","CustomerClassName":"èóê´ÇPÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then I should get the following json : {"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"01","CustomerClassName":"èóê´ÇPÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Specific StoreId (0123) and Common StoreId(0) in MST_CUSTOMERCLASS table
DataSet:test/ncr/res/mobilepos/customerclass/resource/test/MST_CUSTOMERCLASS_Scenario2.xml
Using timeout for story get_customer_class_info_resource_test.scenario of 300 secs.
Given a table MST_CUSTOMERCLASS_Scenario2.xml
Given that customerclassinfo service
When I get customerclassinfo of CompanyId:01 StoreId:0123
{"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"02","CustomerClassName":"èóê´2ÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then I should get the following json : {"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"02","CustomerClassName":"èóê´2ÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Specific StoreId (0123) only in in MST_CUSTOMERCLASS table
DataSet:test/ncr/res/mobilepos/customerclass/resource/test/MST_CUSTOMERCLASS_Scenario3.xml
Given a table MST_CUSTOMERCLASS_Scenario3.xml
Given that customerclassinfo service
When I get customerclassinfo of CompanyId:01 StoreId:0123
{"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"01","CustomerClassName":"èóê´ÇPÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then I should get the following json : {"CustomerClassInfoList":[{"CompanyId":"01","StoreId":"0123","CustomerClassId":"01","CustomerClassName":"èóê´ÇPÇOë„","CustomerClassKanaName":"01","GenerationType":"0","SexType":"","OtherType":""}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: No Common StoreId(0) or Specific StoreId (0123) in MST_CUSTOMERCLASS table
DataSet:test/ncr/res/mobilepos/customerclass/resource/test/MST_CUSTOMERCLASS_Scenario4.xml
Given a table MST_CUSTOMERCLASS_Scenario4.xml
Given that customerclassinfo service
When I get customerclassinfo of CompanyId:01 StoreId:0123
{"CustomerClassInfoList":[],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then I should get the following json : {"CustomerClassInfoList":[],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 19 stories (of which 0 pending) containing 100 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.686 sec - in ncr.res.mobilepos.customerclass.resource.test.GetCustomerClassInfoResourceTest
Running ncr.res.mobilepos.daofactory.JndiDBManagerMSSqlServerTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/daofactory/jndi_d_b_manager_m_s_sql_server_test.scenario

(ncr/res/mobilepos/daofactory/jndi_d_b_manager_m_s_sql_server_test.scenario)
Scenario: JndiDBManagerMSSqlServer instantiates successfully with found DataSource in JNDI
When DataSource is properly bound to InitialContext
Then DBManager doesn't throw DaoException

Scenario: JndiDBManagerMSSqlServer is not able to find DataSource in JNDI, then it fails with DaoException
When DataSource is not bound
Then DBManager throws DaoException caused by NamingException



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 20 stories (of which 0 pending) containing 102 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.385 sec - in ncr.res.mobilepos.daofactory.JndiDBManagerMSSqlServerTest
Running ncr.res.mobilepos.department.resource.test.DepartmentResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/department/resource/test/department_resource_test.scenario

(ncr/res/mobilepos/department/resource/test/department_resource_test.scenario)
Scenario: Invalid Parameters
Given I have Department Resource
!-- Unknown store id
When I get Department with companyid 01 storeid 0032 and dptid 001
Then the resultcode should be 180 and extendedResultCode should be 133
!-- Unknown department
When I get Department with companyid 01 storeid 0031 and dptid 040
Then the resultcode should be 180 and extendedResultCode should be 133
!-- Unknown store id and Unknown department
When I get Department with companyid 01 storeid 0032 and dptid 040
Then the resultcode should be 180 and extendedResultCode should be 133
!-- DepartmentId exceeds to 20 characters
When I get Department with companyid 01 storeid 000031 and dptid 012345678901234567899
Then the resultcode should be 180 and extendedResultCode should be 133
!-- StoreId exceeds to 6 characters
When I get Department with companyid 01 storeid 0000311 and dptid 01234567890123456789
Then the resultcode should be 180 and extendedResultCode should be 133

Scenario: Department Query
Given entries for department in database
Using timeout for story department_resource_test.scenario of 300 secs.
Given I have Department Resource
When I get Department with companyid 01 storeid 0031 and dptid 001
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|001|dpttest1|ïîñÂÉeÉXÉg1|5|5|5.0|5.000|5|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- Department exist in the Enterprise Store
When I get Department with companyid 01 storeid 0031 and dptid 004
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|004|dpttest4|ïîñÂÉeÉXÉg4|5|5|5.0|5.000|5|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- Department exist both in Store and Enterprise Store
When I get Department with companyid 01 storeid 0031 and dptid 003
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|003|dpttest3|ïîñÂÉeÉXÉg3|5|5|5.0|5.000|5|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- StoreId and DepartmentId equals in the Store and Enterprise Store
When I get Department with companyid 01 storeid 000031 and dptid 01234567890123456789
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|000031|01234567890123456789|Dpt 01234567890123456789|ïîñÂ01234567890123456789|5|5|5.0|5.000|5|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0

Scenario: Not Active Departments Should Not Be Viewed
Given entries for department in database
Given I have Department Resource
!-- Deleted Status
When I get Department with companyid 01 storeid 0031 and dptid 100
Then the resultcode should be 180 and extendedResultCode should be 133
!-- Neither Deleted or Active Status
When I get Department with companyid 01 storeid 0031 and dptid 101
Then the resultcode should be 180 and extendedResultCode should be 133
!-- Empty Status
When I get Department with companyid 01 storeid 0031 and dptid 102
Then the resultcode should be 180 and extendedResultCode should be 133
!-- NULL Status
When I get Department with companyid 01 storeid 0031 and dptid 103
Then the resultcode should be 180 and extendedResultCode should be 133

Scenario: Database throw Exceptions
Given I have Department Resource
Given that database is throwing an unexpected DaoException
When I get Department with companyid 01 storeid 0031 and dptid 102
Then the resultcode should be 139 and extendedResultCode should be 0
Given that database is throwing an unexpected SQLException
When I get Department with companyid 01 storeid 0031 and dptid 102
Then the resultcode should be 134 and extendedResultCode should be 0
Given that database is throwing an unexpected SQLStatementException
When I get Department with companyid 01 storeid 0031 and dptid 102
Then the resultcode should be 139 and extendedResultCode should be 0
Given that database is throwing an unexpected Exception
When I get Department with companyid 01 storeid 0031 and dptid 102
Then the resultcode should be 133 and extendedResultCode should be 0



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 21 stories (of which 0 pending) containing 106 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.805 sec - in ncr.res.mobilepos.department.resource.test.DepartmentResourceTest
Running ncr.res.mobilepos.department.resource.test.DiscountDepartmentResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/department/resource/test/discount_department_resource_test.scenario

(ncr/res/mobilepos/department/resource/test/discount_department_resource_test.scenario)
Scenario: Department Query No PriceProm
Using timeout for story discount_department_resource_test.scenario of 300 secs.
Given entries for discount_department in database
Given I have Department Resource companyid 01 storeid 0031
!-- Discount exist
When I get Department with companyid 01 storeid 0031 and dptid 201
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|PROMOTIONID|PROMDISCOUNTCLASS|PROMDISCOUNTAMT|PROMDISCOUNTRATE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|201|Dpt 201|ïîñÂ201|5|5|5.0|5.000|5|0001|2|500|0.0|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- Discount exist TargetStore
When I get Department with companyid 01 storeid 0031 and dptid 202
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|PROMOTIONID|PROMDISCOUNTCLASS|PROMDISCOUNTAMT|PROMDISCOUNTRATE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|202|Dpt 202|ïîñÂ202|5|5|5.0|5.000|5|0002|1|0|10.5|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- Discount not exist DayOfWeekSetting
When I get Department with companyid 01 storeid 0031 and dptid 203
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|PROMOTIONID|PROMDISCOUNTCLASS|PROMDISCOUNTAMT|PROMDISCOUNTRATE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|203|Dpt 203|ïîñÂ203|5|5|5.0|5.000|5|null|null|null|null|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0
!-- Discount exist DayOfWeekSetting
When I get Department with companyid 01 storeid 0031 and dptid 204
Then I should get department model with properties:

|RETAILSTOREID|DPT|DPTNAME|DPTNAMELOCAL|NONSALES|DISCOUNTTYPE|DISCOUNTRATE|TAXRATE|TAXTYPE|PROMOTIONID|PROMDISCOUNTCLASS|PROMDISCOUNTAMT|PROMDISCOUNTRATE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|
|0031|204|Dpt 204|ïîñÂ204|5|5|5.0|5.000|5|0004|1|0|33.3|0|0|1|0|12123|

Then the resultcode should be 0 and extendedResultCode should be 0



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 22 stories (of which 0 pending) containing 107 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.488 sec - in ncr.res.mobilepos.department.resource.test.DiscountDepartmentResourceTest
Running ncr.res.mobilepos.department.resource.test.ListDepartmentsResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/department/resource/test/list_departments_resource_test.scenario

(ncr/res/mobilepos/department/resource/test/list_departments_resource_test.scenario)
Scenario: List Departments
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
Using timeout for story list_departments_resource_test.scenario of 300 secs.
Then I should have the following departments: 

|STOREID|DPT|STATUS|
|0|101|Active|
|0|102|Active|
|0|103|Active|
|0|104|Active|
|0|105|Active|
|0031|201|Active|
|0031|202|Active|
|0031|203|Active|
|0031|204|Active|
|0031|205|Active|
|0031|306|Deleted|
|0031|307|Active|
|0031|308|Active|
|0031|309|Active|
|0031|310|Deleted|
|0|901|Active|
|0031|902|Active|

When I list all departments of storeid 0031
Then I should get resultcode 0 and 15 department list
Then I should get list: 

|DPT|DPTNAME|DPTNAMELOCAL|INHERITFLAG|EXCEPTIONFLAG|SUBSMALLINT5|DISCOUNTTYPE|DISCOUNTFLAG|DISCOUNTAMT|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|INPUTTYPE|
|309|Department 309|ïîñÂ309|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|308|Department 308|ïîñÂ308|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|307|Department 307|ïîñÂ307|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|205|Department 205|ïîñÂ205|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|204|Department 204|ïîñÂ204|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|203|Department 203|ïîñÂ203|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|202|Department 202|ïîñÂ202|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|201|Department 201|ïîñÂ201|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|105|Department 105|ïîñÂ105|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|104|Department 104|ïîñÂ104|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|103|Department 103|ïîñÂ103|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|102|Department 102|ïîñÂ102|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|101|Department 101|ïîñÂ101|5|5|0|1|null|0|0|8.000|1|0|0|1|0|45678|123456|
|901|Department 901|ïîñÂ901|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|902|Department 902|ïîñÂ902|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|


Scenario: List Departments of non-existing store
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
When I list all departments of storeid 0032
Then I should get resultcode 0 and 6 department list
Then I should get list: 

|DPT|DPTNAME|DPTNAMELOCAL|INHERITFLAG|EXCEPTIONFLAG|SUBSMALLINT5|DISCOUNTTYPE|DISCOUNTFLAG|DISCOUNTAMT|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|INPUTTYPE|
|105|Department 105|ïîñÂ105|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|104|Department 104|ïîñÂ104|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|103|Department 103|ïîñÂ103|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|102|Department 102|ïîñÂ102|0|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|101|Department 101|ïîñÂ101|5|5|0|1|null|0|0|8.000|1|0|0|1|0|45678|123456|
|901|Department 901|ïîñÂ901|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|


Scenario: List Departments of company and store
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
When I list all departments of companyid 02 storeid 0031
Then I should get resultcode 0 and 2 department list
Then I should get list: 

|DPT|DPTNAME|DPTNAMELOCAL|INHERITFLAG|EXCEPTIONFLAG|SUBSMALLINT5|DISCOUNTTYPE|DISCOUNTFLAG|DISCOUNTAMT|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|INPUTTYPE|
|901|Department 901|ïîñÂ901|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|902|Department 902|ïîñÂ902|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|


Scenario: List Departments of company and non-existing store
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
When I list all departments of companyid 02 storeid 0032
Then I should get resultcode 0 and 1 department list
Then I should get list: 

|DPT|DPTNAME|DPTNAMELOCAL|INHERITFLAG|EXCEPTIONFLAG|SUBSMALLINT5|DISCOUNTTYPE|DISCOUNTFLAG|DISCOUNTAMT|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|INPUTTYPE|
|901|Department 901|ïîñÂ901|5|5|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|


Scenario: List Departments of non-existin company and non-existing store
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
When I list all departments of companyid 03 storeid 0032
Then I should get resultcode 180

Scenario: List Departments from all stores
Give a Department Resource
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
When I list all departments of storeid {}
Then I should get resultcode 0 and 15 department list
Then I should get list: 

|DPT|DPTNAME|DPTNAMELOCAL|INHERITFLAG|EXCEPTIONFLAG|DISCOUNTTYPE|DISCOUNTFLAG|DISCOUNTAMT|DISCOUNTRATE|TAXRATE|TAXTYPE|SUBNUM1|SUBNUM2|SUBNUM3|SUBNUM4|SUBCODE1|INPUTTYPE|
|309|Department 309|ïîñÂ309|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|308|Department 308|ïîñÂ308|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|307|Department 307|ïîñÂ307|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|205|Department 205|ïîñÂ205|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|204|Department 204|ïîñÂ204|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|203|Department 203|ïîñÂ203|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|202|Department 202|ïîñÂ202|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|201|Department 201|ïîñÂ201|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|105|Department 105|ïîñÂ105|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|104|Department 104|ïîñÂ104|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|103|Department 103|ïîñÂ103|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|102|Department 102|ïîñÂ102|0|0|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|101|Department 101|ïîñÂ101|5|5|1|null|0|0|8.000|1|0|0|1|0|45678|123456|
|901|Department 901|ïîñÂ901|5|5|1|null|0|0|8.000|1|0|0|1|0|12123|999999|
|902|Department 902|ïîñÂ902|5|5|1|null|0|0|8.000|1|0|0|1|0|12123|999999|


Scenario: Database throw Exceptions
DataSet:test/ncr/res/mobilepos/department/resource/test/MST_DPTINFO_forList.xml
Given a Department Resource
Given that database is throwing an unexpected DaoException
When I list all departments of storeid 0031
Then I should get resultcode 139
Given that database is throwing an unexpected SQLException
When I list all departments of storeid 0031
Then I should get resultcode 134
Given that database is throwing an unexpected SQLStatementException
When I list all departments of storeid 0031
Then I should get resultcode 139
org.mockito.exceptions.base.MockitoException: 
Checked exception is invalid for this method!
Invalid: java.lang.Exception
	at ncr.res.mobilepos.department.resource.test.ListDepartmentsResourceSteps.givenThrownException(ListDepartmentsResourceSteps.java:295)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.jbehave.core.steps.StepCreator$ParametrisedStep.perform(StepCreator.java:733)
	at org.jbehave.core.embedder.PerformableTree$FineSoFar.run(PerformableTree.java:346)
	at org.jbehave.core.embedder.PerformableTree$PerformableSteps.perform(PerformableTree.java:1088)
	at org.jbehave.core.embedder.PerformableTree$AbstractPerformableScenario.performRestartableSteps(PerformableTree.java:953)
	at org.jbehave.core.embedder.PerformableTree$NormalPerformableScenario.perform(PerformableTree.java:992)
	at org.jbehave.core.embedder.PerformableTree$PerformableScenario.perform(PerformableTree.java:902)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.performScenarios(PerformableTree.java:825)
	at org.jbehave.core.embedder.PerformableTree$PerformableStory.perform(PerformableTree.java:798)
	at org.jbehave.core.embedder.PerformableTree.performCancellable(PerformableTree.java:422)
	at org.jbehave.core.embedder.PerformableTree.perform(PerformableTree.java:393)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:292)
	at org.jbehave.core.embedder.StoryManager$EnqueuedStory.call(StoryManager.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Given that database is throwing an unexpected Exception
When I list all departments of storeid 0031
Then I should get resultcode 133



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 23 stories (of which 0 pending) containing 114 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.305 sec - in ncr.res.mobilepos.department.resource.test.ListDepartmentsResourceTest
Running ncr.res.mobilepos.device.resource.test.GetDeviceStatusTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/device/resource/test/get_device_status_test.scenario

(ncr/res/mobilepos/device/resource/test/get_device_status_test.scenario)
Scenario: BusinessDate is null/empty
Given that no businessdate
When getting device status companyId:01 storeId:0247 terminalId:0001
Then it should get NCRWSSResultCode:1518

Scenario: companyId is null/empty
Using timeout for story get_device_status_test.scenario of 300 secs.
Given that has businessdate
When getting device status companyId:null storeId:0247 terminalId:0001
Then it should get NCRWSSResultCode:1518
When getting device status companyId:empty storeId:0247 terminalId:0001
Then it should get NCRWSSResultCode:1518
When getting device status companyId:01 storeId:null terminalId:0001
Then it should get NCRWSSResultCode:154
When getting device status companyId:01 storeId:empty terminalId:0001
Then it should get NCRWSSResultCode:154
When getting device status companyId:01 storeId:0247 terminalId:null
Then it should get NCRWSSResultCode:154
When getting device status companyId:01 storeId:0247 terminalId:empty
Then it should get NCRWSSResultCode:154

Scenario: Get Device Status (Unused)
Given that has businessdate
Given that has no data in txu_pos_ctrl
When getting device status companyId:01 storeId:0247 terminalId:0001
Then it should get NCRWSSResultCode:1800

Scenario: Get Device Status (SodTime is before BusinessDate)
Given that has businessdate
Given that has no data in txu_pos_ctrl
When getting device status companyId:01 storeId:0247 terminalId:0012
Then it should get NCRWSSResultCode:1800

Scenario: Get Device Status (1: Opening)
Given that has businessdate
Given that has data in txu_pos_ctrl
When getting device status companyId:01 storeId:0247 terminalId:0001
Then it should get OpenCloseStat:1
Then it should get NCRWSSResultCode:0

Scenario: Get Device Status (2: Daily Settlement)
Given that has businessdate
When getting device status companyId:01 storeId:0247 terminalId:0002
Then it should get OpenCloseStat:2
Then it should get NCRWSSResultCode:0

Scenario: Get Device Status (3: Monthly Settlement)
Given that has businessdate
When getting device status companyId:01 storeId:0247 terminalId:0003
Then it should get OpenCloseStat:3
Then it should get NCRWSSResultCode:0

Scenario: Get Device Status (4: Closed)
Given that has businessdate
When getting device status companyId:01 storeId:0247 terminalId:0004
Then it should get OpenCloseStat:4
Then it should get NCRWSSResultCode:0



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 24 stories (of which 0 pending) containing 122 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.322 sec - in ncr.res.mobilepos.device.resource.test.GetDeviceStatusTest
Running ncr.res.mobilepos.device.resource.test.GetTerminalInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/device/resource/test/get_terminal_info_test.scenario

(ncr/res/mobilepos/device/resource/test/get_terminal_info_test.scenario)
Scenario: Successfully get terminal info
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId 01, storeId 0031 and terminalId 0001
Then I should have the following data:

|Key|Value|
|companyId|01|
|storeId|0031|
|terminalId|0001|
|floorId|0001|
|terminalName|Terminal1|
|ipAddress|127.0.0.1|
|storeClass|1|
|terminalType|1|
|tillType|1|
|relationType|1|
|connectionFlag1|0|
|connectionFlag2|0|
|connectionFlag3|0|
|connectionFlag4|0|
|connectionFlag5|0|
|connectionFlag6|0|
|connectionFlag7|0|
|connectionFlag8|0|
|logoFileName|logofile|
|inshiFileName|inshifile|
|note|note|

Then the result should be RES_OK

Scenario: Get terminal info where companyId is empty
Using timeout for story get_terminal_info_test.scenario of 300 secs.
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId , storeId 0031 and terminalId 0002
Then TerminalInfo should be null
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get terminal info where storeId is null
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId 01, storeId null and terminalId 0002
Then TerminalInfo should be null
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get terminal info where storeId is empty
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId 01, storeId  and terminalId 0002
Then TerminalInfo should be null
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get terminal info where terminalId is null
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId 01, storeId 0031 and terminalId null
Then TerminalInfo should be null
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get terminal info where terminalId is empty
Given I have a DeviceInfo resource and other resources
When I request to get terminal info of companyId 01, storeId 0031 and terminalId empty
Then TerminalInfo should be null
Then the result should be RES_ERROR_INVALIDPARAMETER



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 25 stories (of which 0 pending) containing 128 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.813 sec - in ncr.res.mobilepos.device.resource.test.GetTerminalInfoTest
Running ncr.res.mobilepos.device.resource.test.GetWorkingDevicesTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/device/resource/test/get_working_devices_test.scenario

(ncr/res/mobilepos/device/resource/test/get_working_devices_test.scenario)
Scenario: With Other Working Devices
Using timeout for story get_working_devices_test.scenario of 300 secs.
Given that has working devices
When getting working devices companyId:01 storeId:0247 terminalId:0004
Then it should get the following terminals:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0001|02470001|POS#1|1|2016-08-16 15:55:39.0|NULL|
|01|0247|0002|02470002|POS#2|1|2016-08-16 02:52:24.0|NULL|
|01|0247|0003|02470002|POS#3|1|2016-08-16 13:56:40.0|NULL|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|

Then it should get the following group:
|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|

Then it should get the following groups of 02470004:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|

Then it should get the following groups of 02470002:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0002|02470002|POS#2|1|2016-08-16 02:52:24.0|NULL|
|01|0247|0003|02470002|POS#3|1|2016-08-16 13:56:40.0|NULL|

Then it should get the following groups of 02470001:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0001|02470001|POS#1|1|2016-08-16 15:55:39.0|NULL|


Scenario: With Working Devices
Given that has no other working devices
When getting working devices companyId:01 storeId:0247 terminalId:0004
Then it should get the following terminals:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|

Then it should get the following group:
|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|

Then it should get the following groups of 02470004:

|companyid|storeid|terminalid|tillid|terminalname|openclosestat|sodtime|eodtime|
|01|0247|0004|02470004|POS#4ÉeÉXÉg|1|2016-08-16 16:42:09.0|NULL|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 26 stories (of which 0 pending) containing 130 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.905 sec - in ncr.res.mobilepos.device.resource.test.GetWorkingDevicesTest
Running ncr.res.mobilepos.deviceattribute.resource.test.GetDeviceAttributeTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/deviceattribute/resource/test/get_device_attribute_test.scenario

(ncr/res/mobilepos/deviceattribute/resource/test/get_device_attribute_test.scenario)
Scenario: Successfully get device attribute info
Using timeout for story get_device_attribute_test.scenario of 300 secs.
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId 01, storeId 0247 and terminalId 0001
Then I should have the following data:

|companyId|storeId|terminalId|training|deviceName|attributeId|printerId|tillId|linkQueueBuster|printDes|drawerId|displayName|attributeDes|
|01|0247|0001|0|POS#1|1|0001|02470001|0001||02470001|Device0001|??????|

Then the result should be RES_OK

Scenario: Get device attribute info where companyId is null
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId null, storeId 0001 and terminalId 01
Then the result should be RES_ERROR_NODATAFOUND

Scenario: Get device attribute info where companyId is empty
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId empty, storeId 01 and terminalId 0001
Then the result should be RES_ERROR_NODATAFOUND

Scenario: Get device attribute info where terminalId is null
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId 0001, storeId 01 and terminalId null
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get device attribute info where terminalId is empty
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId 01, storeId 0001 and terminalId empty
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get device attribute info where storeId is null
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId 0001, storeId null and terminalId 0247
Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Get device attribute info where storeId is empty
Given I have a DeviceInfo resource and other resources
When I request to get device attribute info of companyId 0001, storeId empty and terminalId 01
Then the result should be RES_ERROR_INVALIDPARAMETER



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 27 stories (of which 0 pending) containing 137 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.047 sec - in ncr.res.mobilepos.deviceattribute.resource.test.GetDeviceAttributeTest
Running ncr.res.mobilepos.deviceinfo.resource.test.DeviceInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/deviceinfo/resource/test/device_info_test.scenario

(ncr/res/mobilepos/deviceinfo/resource/test/device_info_test.scenario)
Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for an existing device with printer already set and existing (Get also printer information)
DataSet:test/ncr/res/mobilepos/deviceinfo/resource/test/MST_DEVICE_INFO_9999_000031_9999_1_9876.xml
Using timeout for story device_info_test.scenario of 300 secs.
Given an initial deviceinfo entry in database
DataSet:test/ncr/res/mobilepos/deviceinfo/resource/test/MST_PRINTERINFO.xml
Given entries in MST_PRINTERINFO database table
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000031, deviceid 9999 and trainingmode 0
Then ResultCode should be 0
Then printer should be not null
Then printerid should be 102
Then printername should be Test Printer 2
Then description should be Unit test printer 2
Then linkposterminalid should be 1234

Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for an existing device with printer already set and not existing
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000031, deviceid 9990 and trainingmode 0
Then ResultCode should be 0
Then printer should be not null
Then printerid should be null
Then printername should be empty
Then description should be empty
Then linkposterminalid should be 1234

Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for an existing device with printer not yet set for storeid 000031
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000031, deviceid 9998 and trainingmode 0
Then ResultCode should be 0
Then printer should be not null
Then printerid should be null
Then printername should be empty
Then description should be empty
Then linkposterminalid should be 1234

Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for an existing device with printer not yet set for storeid 000032 (Set the printer to first printer in corp&&store if printerid is zero)
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000032, deviceid 9998 and trainingmode 0
Then ResultCode should be 0
Then printer should be not null
Then printerid should be null
Then printername should be empty
Then description should be empty
Then linkposterminalid should be 1234

Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for a non-existing device
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000031, deviceid 6547 and trainingmode 0
Then ResultCode should be 223
Then printer should be not null
Then printerid should be null
Then printername should be empty
Then description should be empty
Then linkposterminalid should be empty

Scenario: Test Get Peripheral Device Info from PeripheralDeviceControl service for an existing device with printer not yet set for storeid 000031 and no printer can be found
DataSet:test/ncr/res/mobilepos/deviceinfo/resource/test/MST_DEVICE_INFO_9999_000031_9999_1_9876.xml
Given an initial deviceinfo entry in database
DataSet:test/ncr/res/mobilepos/device/resource/test/MST_PRINTERINFO_EMPTY.xml
Given an empty MST_PRINTERINFO database table
Given a PeripheralDeviceControl service
When I get PeripheralDeviceInfo for companyid 01, storeid 000031, deviceid 9997 and trainingmode 0
Then ResultCode should be 0
Then printer should be not null
Then printerid should be null
Then printername should be empty
Then description should be empty
Then linkposterminalid should be 1234

Scenario: Test Get the deviceIndicators where data is null
Given a PeripheralDeviceControl service
DataSet:test/ncr/res/mobilepos/deviceinfo/resource/test/PRM_DEVICE_INDICATOR.xml
Given the table PRM_DEVICE_INDICATOR database
When I get deviceIndicators for attributeid 10
Then the result base should be 0
Then I should get the deviceIndicators size : 0

Scenario: Test Get the deviceIndicators
Given a PeripheralDeviceControl service
DataSet:test/ncr/res/mobilepos/deviceinfo/resource/test/PRM_DEVICE_INDICATOR.xml
Given the table PRM_DEVICE_INDICATOR database
When I get deviceIndicators for attributeid 1
Then the result base should be 0
Then I should get the deviceIndicators :

|DisplayName|CheckInterval|NormalValue|Request|RequestType|ReturnKey|URL|DisplayOrder|
|Enterprise|30|T.B.D|T.B.D|GET|T.B.D|https://127.0.0.1:8443/resTransaction/rest/initialization/status|1|
|Infox|30|T.B.D|T.B.D|EVENT|T.B.D|ws://127.0.0.1:15010/resSocket/socket|2|
|ê}èëÉJÅ[Éh|30|T.B.D|T.B.D|EVENT|T.B.D|ws://127.0.0.1:15010/resSocket/socket|3|
|íﬁëKã@|30|CashChanger.Status.Successful|{"event":"CashChanger.Status", "type":"request", "terminalId" : "?"}|WS|event|ws://127.0.0.1:15010/resSocket/socket|4|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 28 stories (of which 0 pending) containing 145 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.028 sec - in ncr.res.mobilepos.deviceinfo.resource.test.DeviceInfoTest
Running ncr.res.mobilepos.discountplaninfo.resource.test.GetPromotionInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/discountplaninfo/resource/test/get_promotion_info_test.scenario

(ncr/res/mobilepos/discountplaninfo/resource/test/get_promotion_info_test.scenario)
Scenario: If no common/specific store, response with 157 error code
Given an empty table in MST_PRICE_PROMOTION
When I get promotion information of companyid:01 storeid:0247 discreason:61 discbarcodetype:19 partialflag:0 pricediscflag:1,0 ratedisc:1,0
Then I should get NCRWSSResultCode:157
Then the JSON should have the following format: {"message":"No Rows Available","NCRWSSResultCode":157,"NCRWSSExtendedResultCode":157}

Scenario: If specific store only, gets discount information of specific store then response should have specific storeid
Using timeout for story get_promotion_info_test.scenario of 300 secs.
Given data in table MST_PRICE_PROMOTION
When I get promotion information of companyid:01 storeid:0247 discreason:61 discbarcodetype:19 partialflag:0 pricediscflag:1,0 ratedisc:1,0
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"{\"companyId\":\"01\",\"storeId\":\"0247\",\"promotionId\":\"61\",\"promotionName\":\"ì¡ï äÑà¯\",\"receiptName\":\"ì¡ï äÑà¯\",\"discountReason\":\"61\",\"discountReasonName\":\"ì¡ï äÑà¯\",\"promotionType\":\"6\",\"discountType\":\"2\",\"inputFlag\":\"0\",\"partialFlag\":\"0\",\"rateDiscountFlag\":\"1\",\"priceDiscountFlag\":\"0\",\"buttonFlag\":\"0\",\"barcodeFlag\":\"0\",\"barcodeStartCode\":\"\",\"barcodeEndCode\":\"\",\"barcodeIdCode1\":\"\",\"barcodeIdCode2\":\"\",\"pointCombinationUseFlag\":\"1\",\"pointAddFlag\":\"1\",\"discountBarcodeType\":\"19\"}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: If common store only, gets discount information of common store but response should have specific storeid
When I get promotion information of companyid:02 storeid:0247 discreason:61 discbarcodetype:19 partialflag:0 pricediscflag:1,0 ratedisc:1,0
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"{\"companyId\":\"02\",\"storeId\":\"0247\",\"promotionId\":\"61\",\"promotionName\":\"ì¡ï äÑà¯\",\"receiptName\":\"ì¡ï äÑà¯\",\"discountReason\":\"61\",\"discountReasonName\":\"ì¡ï äÑà¯\",\"promotionType\":\"6\",\"discountType\":\"2\",\"inputFlag\":\"0\",\"partialFlag\":\"0\",\"rateDiscountFlag\":\"1\",\"priceDiscountFlag\":\"0\",\"buttonFlag\":\"0\",\"barcodeFlag\":\"0\",\"barcodeStartCode\":\"\",\"barcodeEndCode\":\"\",\"barcodeIdCode1\":\"\",\"barcodeIdCode2\":\"\",\"pointCombinationUseFlag\":\"1\",\"pointAddFlag\":\"1\",\"discountBarcodeType\":\"19\"}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: If both common and specific store, gets discount information of specific store then response should have specific storeid
When I get promotion information of companyid:03 storeid:0247 discreason:61 discbarcodetype:19 partialflag:0 pricediscflag:1,0 ratedisc:1,0
Then I should get NCRWSSResultCode:0
Then the JSON should have the following format: {"message":"Success","JSONObject":"{\"companyId\":\"03\",\"storeId\":\"0247\",\"promotionId\":\"61\",\"promotionName\":\"ì¡ï äÑà¯\",\"receiptName\":\"ì¡ï äÑà¯\",\"discountReason\":\"61\",\"discountReasonName\":\"ì¡ï äÑà¯\",\"promotionType\":\"6\",\"discountType\":\"2\",\"inputFlag\":\"0\",\"partialFlag\":\"0\",\"rateDiscountFlag\":\"1\",\"priceDiscountFlag\":\"0\",\"buttonFlag\":\"0\",\"barcodeFlag\":\"0\",\"barcodeStartCode\":\"\",\"barcodeEndCode\":\"\",\"barcodeIdCode1\":\"\",\"barcodeIdCode2\":\"\",\"pointCombinationUseFlag\":\"1\",\"pointAddFlag\":\"1\",\"discountBarcodeType\":\"19\"}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 29 stories (of which 0 pending) containing 149 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.632 sec - in ncr.res.mobilepos.discountplaninfo.resource.test.GetPromotionInfoTest
Running ncr.res.mobilepos.eod.test.EodCashsalesTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_cashsales_test.scenario

(ncr/res/mobilepos/eod/test/eod_cashsales_test.scenario)
Scenario: Cancelled EOD @Cash Sales Report (in POS with or without weather and customer count settings)
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_cashsales_test.scenario of 300 secs.
Given that has no other working devices
Given that execute authority is done for companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 30 stories (of which 0 pending) containing 150 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.769 sec - in ncr.res.mobilepos.eod.test.EodCashsalesTest
Running ncr.res.mobilepos.eod.test.EodCouponentryTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_couponentry_test.scenario
!-- Note: No confirmation because UI does not have API calls to resTransaction
(ncr/res/mobilepos/eod/test/eod_couponentry_test.scenario)
Scenario: Cancelled EOD during Coupon Entry
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_couponentry_test.scenario of 300 secs.
Given that has no other working devices
Given that execute authority is done for companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-16|1|0|

When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 31 stories (of which 0 pending) containing 151 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.864 sec - in ncr.res.mobilepos.eod.test.EodCouponentryTest
Running ncr.res.mobilepos.eod.test.EodCouponsummaryTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_couponsummary_test.scenario

(ncr/res/mobilepos/eod/test/eod_couponsummary_test.scenario)
Scenario: Cancelled EOD @Coupon Summary Screen (Without Coupon Transaction Within Businessday)
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_couponsummary_test.scenario of 300 secs.
Given that has no other working devices
Given that has no last payin/payout transactions
Given that has suspended transactions
When getting execute authority companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|
|0|0|

When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-16|1|0|

When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|


Scenario: Continue EOD @Coupon Summary Screen (Without Coupon Transaction Within Businessday)
Given that has credit payments
When getting credit companyId:01 storeId:0247 businessDate:2016-08-16 trainingFlag:0 dataType:2 itemLevel1:01 tillId:02470001 terminalId:null
Then it should get the following:

|CompanyId|RetailStoreId|BusinessDayDate|TrainingFlag|SalesCntSum|SalesItemAmt|SalesItemCnt|SalesAmtSum|
|01|0247|2016-08-16|0|1|0.0|0|1080.0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 32 stories (of which 0 pending) containing 153 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.171 sec - in ncr.res.mobilepos.eod.test.EodCouponsummaryTest
Running ncr.res.mobilepos.eod.test.EodCreditentryTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_creditentry_test.scenario
!-- Note: No confirmation because UI does not have API calls to resTransaction
(ncr/res/mobilepos/eod/test/eod_creditentry_test.scenario)
Scenario: Cancelled EOD @EOD Credit Screen (without Credit transaction within the business day)
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_creditentry_test.scenario of 300 secs.
Given that has no other working devices
Given that execute authority is done for companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|


Scenario: Continue EOD @EOD Credit Screen (without Credit transaction within the business day)
Given that has payments type
When getting the voucher list companyId:01 storeId:0247 businessDayDate:2016-08-16 trainingFlag:0 tillId:02470001 terminalId:empty
Then it should get the following:

|CompanyId|StoreId|VoucherCompanyId|VoucherType|TrainingFlag|SalesItemCnt|SalesItemAmt|VoucherName|VoucherKanaName|
|01|0247|0101|10|0|0|0.0|è§ïiåîÇP|JCB|
|01|0247|0102|10|0|0|0.0|è§ïiåîÇQ|UC|
|01|0247|0103|10|0|0|0.0|è§ïiåîÇR|VISA|
|01|0247|0104|10|0|0|0.0|è§ïiåîÇS|DC/UFJ NICOS|
|01|0247|0106|10|0|0|0.0|è§ïiåîÇT|∆Œ›¿ﬁ≤≈∞Ω|
|01|0247|0109|10|0|0|0.0|è§ïiåîÇU|∆Øæ›⁄›|
|01|0247|0110|10|0|0|0.0|è§ïiåîÇV|NC∂∞ƒﬁ|
|01|0247|0111|10|0|0|0.0|è§ïiåîÇW|ºÆ≥≈≤º› ﬂ›|
|01|0247|0112|10|0|0|0.0|è§ïiåîÇX|¥Ω∫∞ƒ|
|01|0247|0115|10|0|0|0.0|è§ïiåîÇPÇO|OCS|
|01|0247|0118|10|0|0|0.0|ÉOÉãÅ[Évåî|∏ﬁŸ∞Ãﬁπ›|
|01|0247|0161|10|0|0|0.0|ÇªÇÃëºåîÇP|ø…¿π› 1|
|01|0247|0162|10|0|0|0.0|ÇªÇÃëºåîÇQ|ø…¿π› 2|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 33 stories (of which 0 pending) containing 155 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.869 sec - in ncr.res.mobilepos.eod.test.EodCreditentryTest
Running ncr.res.mobilepos.eod.test.EodFinalTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_final_test.scenario

(ncr/res/mobilepos/eod/test/eod_final_test.scenario)
Scenario: Execute @EOD final screen (with weather and customer count settings, store total on)
!-- # of EOD Transaction
Given that has no EOD transaction
Using timeout for story eod_final_test.scenario of 300 secs.
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|

When getting transaction count of companyId=01, storeId=0247, txtype=EOD, trainingFlag=0
Then it should get TxCount:0, NCRWSSResultCode:0
!-- # of EOD Transaction by business date
Given that has no EOD transaction
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|

When getting tx count by businessdate of companyId=01, storeId=0247, workStationId=0002, txtype=EOD, businessDate=20170410, trainingFlag=0
Then it should get TxCount:0, NCRWSSResultCode:0

2. https://localhost:8443/resTransaction/rest/cashaccount/getcash
!-- Total Cash of ChangeFund Transactions
Given that has no changefund data
Then TXU_TOTAL_DAILYREPORT table should have:

|CompanyId|RetailStoreId|WorkstationId|BusinessDayDate|ItemType|ItemLevel1|ItemLevel2|ItemLevel3|ItemLevel4|TrainingFlag|ItemCnt|ItemAmt|

When getting daily sales report for companyId:01 storeId:0247 tillId:empty terminalId:0001 businessDate:2016-08-09 trainingFlag:0 dataType:3 itemLevel1:07 itemLevel2:06
!-- Then it should get NCRWSSResultCode:1301
!-- List of Report
Given that no report items
Then MST_DEVICEINFO table should have:

|CompanyId|StoreId|TerminalId|Training|DeviceName|AttributeId|TillId|LastTxId|Status|
|01|0247|0001|0|POS#0001ÉeÉXÉg|4|02470001|1335|Active|

Then MST_NAME_DAILYREPORT table should have:

|CompanyId|StoreId|DataType|ItemLevel1|ItemLevel2|ItemLevel3|ItemLevel4|ItemName|DisplayOrder|DeleteFlag|
|01|0|2|01|01|||ÅüÉNÉåÉWÉbÉgéxï•|170|0|
|01|0|3|07|05|||Åúåªã‡ç›çÇ|2390|0|

Then TXU_TOTAL_DAILYREPORT table should have:

|CompanyId|RetailStoreId|WorkstationId|BusinessDayDate|ItemType|ItemLevel1|ItemLevel2|ItemLevel3|ItemLevel4|TrainingFlag|ItemCount|ItemAmt|

When getting report items of companyId:01, storeId:0247, tillId:02470001, businessDate:2016-08-09, trainingFlag:0
Then it should get the following:

|CompanyId|StoreId|DataType|ItemLevel1|ItemLevel2|ItemLevel3|ItemLevel4|ItemName|TillId|ItemCount|ItemAmt|NCRWSSExtendedResultCode|NCRWSSResultCode|
|01|0|2|01|01|||ÅüÉNÉåÉWÉbÉgéxï•|02470001|0|0|0|0|
|01|0|3|07|05|||Åúåªã‡ç›çÇ|02470001|0|0|0|0|

!-- Save EOD POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
Given that no transactions
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">ê∞ÇÍ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="è§ïiåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="è§ïiåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="è§ïiåîÇR"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="è§ïiåîÇS"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="è§ïiåîÇT"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="è§ïiåîÇU"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="è§ïiåîÇV"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="è§ïiåîÇW"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="è§ïiåîÇX"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="è§ïiåîÇPÇO"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="ÉOÉãÅ[Évåî"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="ÇªÇÃëºåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="ÇªÇÃëºåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>ÅüÉNÉåÉWÉbÉgéxï•</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>Åúåªã‡ç›çÇ</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1669|2016-08-09|0|EOD|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">ê∞ÇÍ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="è§ïiåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="è§ïiåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="è§ïiåîÇR"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="è§ïiåîÇS"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="è§ïiåîÇT"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="è§ïiåîÇU"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="è§ïiåîÇV"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="è§ïiåîÇW"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="è§ïiåîÇX"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="è§ïiåîÇPÇO"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="ÉOÉãÅ[Évåî"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="ÇªÇÃëºåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="ÇªÇÃëºåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>ÅüÉNÉåÉWÉbÉgéxï•</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>Åúåªã‡ç›çÇ</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|

Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-09|0|1|

Then MST_DEVICEINFO table should have:

|CompanyId|StoreId|TerminalId|Training|DeviceName|AttributeId|TillId|LastTxId|Status|
|01|0247|0001|0|POS#0001ÉeÉXÉg|4|02470001|1669|Active|

!-- PresetCMInfo
Given that presetcminfo data
When getting presetcminfo of companyid:01, storeid:0247, terminalid:0001, businessdaydate:2016-08-09
Then it should get NCRWSSResultCode:0
Then it should get the following:

|CompanyId|CMName|CMType|BizCatId|StoreId|TerminalId|Top1Message|Top2Message|Top3Message|Top4Message|Top5Message|Bottom1Message|Bottom2Message|Bottom3Message|Bottom4Message|Bottom5Message|
|01|CM2|3|02|0247|0|è„íiÇPçsñ⁄|è„íiÇQçsñ⁄|è„íiÇRçsñ⁄|è„íiÇSçsñ⁄|è„íiÇTçsñ⁄|â∫íiÇPçsñ⁄|â∫íiÇQçsñ⁄|â∫íiÇRçsñ⁄|â∫íiÇSçsñ⁄|â∫íiÇTçsñ⁄|

!-- Operator SignOff
Given that operator has sign-on
When signing-off with operatorid:9011011
Then it should get NCRWSSResultCode:0
!-- Save PosEOD POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1669|2016-08-09|0|EOD|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">ê∞ÇÍ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="è§ïiåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="è§ïiåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="è§ïiåîÇR"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="è§ïiåîÇS"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="è§ïiåîÇT"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="è§ïiåîÇU"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="è§ïiåîÇV"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="è§ïiåîÇW"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="è§ïiåîÇX"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="è§ïiåîÇPÇO"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="ÉOÉãÅ[Évåî"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="ÇªÇÃëºåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="ÇªÇÃëºåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>ÅüÉNÉåÉWÉbÉgéxï•</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>Åúåªã‡ç›çÇ</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|01|0247|0001|1670|2016-08-09|0|PosEod|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>|

Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-09|0|1|

Then MST_DEVICEINFO table should have:

|CompanyId|StoreId|TerminalId|Training|DeviceName|AttributeId|TillId|LastTxId|Status|
|01|0247|0001|0|POS#0001ÉeÉXÉg|4|02470001|1670|Active|

!-- Save SignOff POSLog
!-- #1 Update MST_TILLIDINFO.EodFlag=9
!-- #2 Update MST_DEVICEINFO.LastTxId=POSlog.SequenceNumber
!-- #3 Save poslog to TXL_SALES_JOURNAL
When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1671</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:46</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:46</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1669|2016-08-09|0|EOD|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1669</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:44</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:44</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TransactionLink><EODCount></EODCount><AuthorizationNumber>1669</AuthorizationNumber><Weather Code="01">ê∞ÇÍ</Weather><CustomerCount><Visited></Visited><Registered></Registered></CustomerCount><LatestUpdateStoreID>0247</LatestUpdateStoreID><LatestUpdateBusinessDate>2017-04-10T11:56:44</LatestUpdateBusinessDate><LatestUpdateSequenceNumber>1669</LatestUpdateSequenceNumber><LatestUpdateOperatorID>9011011</LatestUpdateOperatorID></TransactionLink><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>EOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><GroupTicket><RegisteredCount>0</RegisteredCount><RegisteredCountInStore>0</RegisteredCountInStore><TotalCount>0</TotalCount></GroupTicket><CreditDebit><RegisteredCount>0</RegisteredCount><CurrentCount>0</CurrentCount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></CreditDebit><Voucher TenderType="1" SubTenderType="0101" TenderName="è§ïiåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0102" TenderName="è§ïiåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0103" TenderName="è§ïiåîÇR"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0104" TenderName="è§ïiåîÇS"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0106" TenderName="è§ïiåîÇT"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0109" TenderName="è§ïiåîÇU"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0110" TenderName="è§ïiåîÇV"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0111" TenderName="è§ïiåîÇW"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0112" TenderName="è§ïiåîÇX"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0115" TenderName="è§ïiåîÇPÇO"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0118" TenderName="ÉOÉãÅ[Évåî"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0161" TenderName="ÇªÇÃëºåîÇP"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Voucher TenderType="1" SubTenderType="0162" TenderName="ÇªÇÃëºåîÇQ"><RegisteredAmount>0</RegisteredAmount><CurrentAmount>0</CurrentAmount><Difference>0</Difference></Voucher><Tender TenderType="Cash"><NetTotal>0</NetTotal><GrossTotal>0</GrossTotal><Difference>0</Difference><ChangeReserve>0</ChangeReserve><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender><TransactionDailyReport Type="Terminal"><Line Type="2" Level1="01" Level2="01" Level3=" " Level4=" "><ItemName>ÅüÉNÉåÉWÉbÉgéxï•</ItemName><Count>0</Count><Amount>0</Amount></Line><Line Type="3" Level1="07" Level2="05" Level3=" " Level4=" "><ItemName>Åúåªã‡ç›çÇ</ItemName><Count>0</Count><Amount>0</Amount></Line></TransactionDailyReport></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|01|0247|0001|1670|2016-08-09|0|PosEod|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>PosEod</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1670</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:45</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:45</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><POSEOD Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></POSEOD></ControlTransaction></Transaction></POSLog>|
|01|0247|0001|1671|2016-08-09|0|SignOff|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1671</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-10T11:56:46</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-10T11:56:46</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>|

Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-09|0|1|

Then MST_DEVICEINFO table should have:

|CompanyId|StoreId|TerminalId|Training|DeviceName|AttributeId|TillId|LastTxId|Status|
|01|0247|0001|0|POS#0001ÉeÉXÉg|4|02470001|1671|Active|

!-- Payment Amt Count By terminalId
Given that payment amt data
When getting payment amt of companyid:01, storeid:0247, businessdaydate:2016-06-20, trainingFlag:0, terminalId:0004, txType:
Then it should get NCRWSSResultCode:0
Then it should get the following:

|TenderId|TenderName|TenderType|TenderIdentification|SumAmt|
|0222|è§ïiåîÇP|10|2|3000|
|0223|è§ïiåîÇQ|10|2|0|
|0224|ÉOÉãÅ[Évåî|10|2|9000|

!-- Payment Amt Count By terminalId but data is null
Given that payment amt data
When getting payment amt of companyid:02, storeid:0247, businessdaydate:2016-06-20, trainingFlag:0, terminalId:0004, txType:
Then it should get NCRWSSResultCode:0
Then it should get paymentList:0
!-- Payment Amt Count By txType
Given that payment amt data
When getting payment amt of companyid:01, storeid:0247, businessdaydate:2016-06-20, trainingFlag:0, terminalId:, txType:900
Then it should get NCRWSSResultCode:0
Then it should get the following:

|TenderId|TenderName|TenderType|TenderIdentification|SumAmt|SumBalancingRegisterAmt|SumBalancingCurrentAmt|SumBalancingDifferenceAmt|
|0222|è§ïiåîÇP|10|2|2010|1100|2200|3300|
|0224|ÉOÉãÅ[Évåî|10|2|300|1010|2020|3030|

!-- Payment Amt Count By txType but data is null
Given that payment amt data
When getting payment amt of companyid:02, storeid:0247, businessdaydate:2016-06-20, trainingFlag:0, terminalId:, txType:900
Then it should get NCRWSSResultCode:0
Then it should get paymentList:0



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 34 stories (of which 0 pending) containing 156 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.154 sec - in ncr.res.mobilepos.eod.test.EodFinalTest
Running ncr.res.mobilepos.eod.test.EodGiftentryTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_giftentry_test.scenario
!-- Note: No confirmation because UI does not have API calls to resTransaction
(ncr/res/mobilepos/eod/test/eod_giftentry_test.scenario)
Scenario: Cancelled EOD during Gift Entry
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_giftentry_test.scenario of 300 secs.
Given that has no other working devices
Given that execute authority is done for companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-16|1|0|

When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 35 stories (of which 0 pending) containing 157 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.774 sec - in ncr.res.mobilepos.eod.test.EodGiftentryTest
Running ncr.res.mobilepos.eod.test.EodNoncashsummaryTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_noncashsummary_test.scenario

(ncr/res/mobilepos/eod/test/eod_noncashsummary_test.scenario)
Scenario: Cancelled EOD @Noncash summary report screen (without non-cash transaction within the business day)
!-- Expected: EodFlag becomes 0 from 9
Using timeout for story eod_noncashsummary_test.scenario of 300 secs.
Given that has no other working devices
Given that execute authority is done for companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|


Scenario: Continue EOD @Noncash summary report screen (without non-cash transaction within the business day)
!-- ItemType3 - Purchase, Deposit / Withdrawal, Others
Given that has cashbalance data in TXU_TOTAL_DAILYREPORT
When getting daily sales report for companyId:01 storeId:0247 tillId:02470001 terminalId:empty businessDate:2016-08-09 trainingFlag:0 dataType:3 itemLevel1:07 itemLevel2:05
Then it should get the following:

|NCRWSSResultCode|CashOnHand|
|0|203321|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 36 stories (of which 0 pending) containing 159 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.897 sec - in ncr.res.mobilepos.eod.test.EodNoncashsummaryTest
Running ncr.res.mobilepos.eod.test.EodStartTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/eod/test/eod_start_test.scenario

(ncr/res/mobilepos/eod/test/eod_start_test.scenario)
Scenario: EOD With Suspended Transactions
Given that has no last payin/payout transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0001 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|TrainingModeFlag|CancelFlag|
|157|0|null|null|

Using timeout for story eod_start_test.scenario of 300 secs.
Given that has suspended transactions
When getting suspended transactions companyid:01 storeid:0247 queue:0001 trainingflag:0 layawayflag:0 txtype:0
Then it should get the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|Queue|BusinessDayDate|TrainingFlag|BusinessDateTime|OperatorId|OperatorName|SalesTotalAmt|SalesTotalQty|Status|
|01|0247|0001|0001|0001|2016-08-16|0|2017-03-02 16:03:32.0|9011011|îƒópîÃîÑàı3|6292|1|0|

!-- RETRY
When getting suspended transactions companyid:01 storeid:0247 queue:0001 trainingflag:0 layawayflag:0 txtype:0
Then it should get the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|Queue|BusinessDayDate|TrainingFlag|BusinessDateTime|OperatorId|OperatorName|SalesTotalAmt|SalesTotalQty|Status|
|01|0247|0001|0001|0001|2016-08-16|0|2017-03-02 16:03:32.0|9011011|îƒópîÃîÑàı3|6292|1|0|

!-- CONTINUE
Given that has no other working devices
When getting execute authority companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|
|0|0|

When getting working devices companyId:01 storeId:0247 terminalId:0001
Then it should get the NCRWSSResultCode:0
Then it should get the following group.terminals:
|terminalName|terminalid|
|POS#0001ÉeÉXÉg|0001|

!-- CANCEL
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0001 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|TrainingModeFlag|CancelFlag|
|157|0|null|null|

When getting suspended transactions companyid:01 storeid:0247 queue:0001 trainingflag:0 layawayflag:0 txtype:0
Then it should get the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|Queue|BusinessDayDate|TrainingFlag|BusinessDateTime|OperatorId|OperatorName|SalesTotalAmt|SalesTotalQty|Status|
|01|0247|0001|0001|0001|2016-08-16|0|2017-03-02 16:03:32.0|9011011|îƒópîÃîÑàı3|6292|1|0|

When getting till information of storeid:0247 tillid:02470001
Then it should get the following:

|NCRWSSResultCode|StoreId|TillId|BusinessDayDate|SodFlag|EodFlag|
|0|0247|02470001|2016-08-16|0|9|

When releasing execute authority for EOD companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD
Then it should get the NCRWSSResultCode:0
Then MST_TILLIDINFO table should have:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|01|0247|02470001|0001|2016-08-16|1|0|

When getting the device status of companyId:01 storeId:0247 terminalId:0001
Then it should get the following:

|OpenCloseStatus|NCRWSSResultCode|NCRWSSExtendedResultCode|
|1|0|0|


Scenario: EOD Without Suspended Transactions
Given that has no last payin/payout transactions
Given that has no suspended transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0001 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|TrainingModeFlag|CancelFlag|
|157|0|null|null|

When getting suspended transactions companyid:01 storeid:0247 queue:0001 trainingflag:0 layawayflag:0 txtype:0
Then it should get the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|Queue|BusinessDayDate|TrainingFlag|BusinessDateTime|OperatorId|OperatorName|SalesTotalAmt|SalesTotalQty|Status|

!-- WITH NO OTHER WORKING DEVICES
Given that has no other working devices
When getting execute authority companyid:01 retailstoreid:0247 tillid:02470001 terminalid:0001 operatorno:9011011 processing:EOD compulsoryflag:false
Then it should get the following:

|NCRWSSResultCode|NCRWSSExtendedResultCode|
|0|0|

When getting working devices companyId:01 storeId:0247 terminalId:0001
Then it should get the NCRWSSResultCode:0
Then it should get the following group.terminals:
|terminalName|terminalid|
|POS#0001ÉeÉXÉg|0001|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 37 stories (of which 0 pending) containing 161 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.399 sec - in ncr.res.mobilepos.eod.test.EodStartTest
Running ncr.res.mobilepos.forwardItem.resource.test.ForwardItemTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/forwardItem/resource/test/forward_item_test.scenario

(ncr/res/mobilepos/forwardItem/resource/test/forward_item_test.scenario)
Scenario: forward_item_test with UserPermission.
Using timeout for story forward_item_test.scenario of 300 secs.
Given entries for forward_item in RESMaster
When I get operator with companyid 01 storeid 0247 workstationid 0001 and operatorid 1
Then I should get the OperatorResult :

|OperatorNo|OperatorType|Securitylevel|
|1|1|1|


Scenario: forward_item_with_tag_test with saveForwardPosLogIncludeTag insert(Insert Success).
Given entries for forward_item_with_tag in RESTransaction
When I get ResultBase with companyid 01 retailstoreid 0032 queue 1324 workstationid 0001 trainingmode 0 tag 0001 total 1620 and poslogxml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>ExchangeReturn</TransactionType><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0032</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6438</SequenceNumber><BusinessDayDate>2016-02-02</BusinessDayDate><BeginDateTime>2018-03-23T15:50:47</BeginDateTime><StartTransactionDateTime>2018-03-23T15:49:55</StartTransactionDateTime><OperatorID OperatorName="éRìcëæòY" OperatorNameKana="MGT111">0000001</OperatorID><ReceiptDateTime>2018-03-23T15:50:47</ReceiptDateTime><TillID>00310001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ"><Telephone><FullTelephoneNumber>0123456789012</FullTelephoneNumber><VoucherTelephoneNumber>0123456789012</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><RetailTransaction><AutoGenerationFlag>1</AutoGenerationFlag><AutoGenerationSequenceNumber>01003100011602026439</AutoGenerationSequenceNumber><TransactionLink><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6437</SequenceNumber><BusinessDayDate>2016-02-02</BusinessDayDate><BeginDateTime>2018-03-23T15:49:12</BeginDateTime><OperatorID>0000001</OperatorID></TransactionLink><Customer><CustomerDemographic>23</CustomerDemographic><ForeignerOption>False</ForeignerOption></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>99</PurSubsidy><BasketOption>False</BasketOption><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxType="0" Department="333" Line="1104" Class="110402" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">0216578877849</ItemID><ScanBarCode>0216578877849</ScanBarCode><Description>ÉeÉXÉg-6-äOê≈ÉZÉbÉgè§ïi</Description><MdKanaName>ÉeÉXÉgÇU</MdKanaName><Sku>2600008191878</Sku><SkuType>0</SkuType><MdVender>000170001-WARM GRAY</MdVender><SupplierCode>1100005100</SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>1182409</ColorId><ColorName></ColorName><SizeId>2013</SizeId><SizeName>bb</SizeName><GroupCode>0</GroupCode><DptNameLocal></DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>01</OldSizeId><SizePatternId1>LTGRY</SizePatternId1><SizePatternId2>M</SizePatternId2><BrandId>JPN</BrandId><BrandName></BrandName><OldSku>0084</OldSku><RepSku>0001</RepSku><RegularSalesUnitPrice>1500</RegularSalesUnitPrice><ActualSalesUnitPrice>1500</ActualSalesUnitPrice><ExtendedAmount>1500</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>525</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>120</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><QRPromotionInfo><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotionInfo><QRPromotion1><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotion1></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash" TenderTiming="0" TypeCode="Refund"><Amount>1620</Amount></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>120</Amount><TaxExcludeAmount>120</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">1500</Total><Total TotalType="TransactionGrandAmount">1620</Total></RetailTransaction></Transaction></POSLog>
Then I should get the ResultCode :

|ResultCode|
|0|


Scenario: forward_item_with_tag_test with saveForwardPosLogIncludeTag insert(Tag is exist).
When I get ResultBase with companyid 01 retailstoreid 0031 queue 1324 workstationid 0001 trainingmode 0 tag 0001 total 1620 and poslogxml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>ExchangeReturn</TransactionType><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6438</SequenceNumber><BusinessDayDate>2016-02-02</BusinessDayDate><BeginDateTime>2018-03-23T15:50:47</BeginDateTime><StartTransactionDateTime>2018-03-23T15:49:55</StartTransactionDateTime><OperatorID OperatorName="éRìcëæòY" OperatorNameKana="MGT111">0000001</OperatorID><ReceiptDateTime>2018-03-23T15:50:47</ReceiptDateTime><TillID>00310001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ"><Telephone><FullTelephoneNumber>0123456789012</FullTelephoneNumber><VoucherTelephoneNumber>0123456789012</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><RetailTransaction><AutoGenerationFlag>1</AutoGenerationFlag><AutoGenerationSequenceNumber>01003100011602026439</AutoGenerationSequenceNumber><TransactionLink><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6437</SequenceNumber><BusinessDayDate>2016-02-02</BusinessDayDate><BeginDateTime>2018-03-23T15:49:12</BeginDateTime><OperatorID>0000001</OperatorID></TransactionLink><Customer><CustomerDemographic>23</CustomerDemographic><ForeignerOption>False</ForeignerOption></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>99</PurSubsidy><BasketOption>False</BasketOption><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxType="0" Department="333" Line="1104" Class="110402" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">0216578877849</ItemID><ScanBarCode>0216578877849</ScanBarCode><Description>ÉeÉXÉg-6-äOê≈ÉZÉbÉgè§ïi</Description><MdKanaName>ÉeÉXÉgÇU</MdKanaName><Sku>2600008191878</Sku><SkuType>0</SkuType><MdVender>000170001-WARM GRAY</MdVender><SupplierCode>1100005100</SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>1182409</ColorId><ColorName></ColorName><SizeId>2013</SizeId><SizeName>bb</SizeName><GroupCode>0</GroupCode><DptNameLocal></DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>01</OldSizeId><SizePatternId1>LTGRY</SizePatternId1><SizePatternId2>M</SizePatternId2><BrandId>JPN</BrandId><BrandName></BrandName><OldSku>0084</OldSku><RepSku>0001</RepSku><RegularSalesUnitPrice>1500</RegularSalesUnitPrice><ActualSalesUnitPrice>1500</ActualSalesUnitPrice><ExtendedAmount>1500</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>525</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>120</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><QRPromotionInfo><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotionInfo><QRPromotion1><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotion1></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash" TenderTiming="0" TypeCode="Refund"><Amount>1620</Amount></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>120</Amount><TaxExcludeAmount>120</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">1500</Total><Total TotalType="TransactionGrandAmount">1620</Total></RetailTransaction></Transaction></POSLog>
Then I should get the ResultCode :

|ResultCode|
|347|


Scenario: forward_item_with_tag_test with saveForwardPosLogIncludeTag insert(Date Format Error).
When I get ResultBase with companyid 01 retailstoreid 0033 queue 1324 workstationid 0001 trainingmode 0 tag 0001 total 1620 and poslogxml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>ExchangeReturn</TransactionType><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0033</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6438</SequenceNumber><BusinessDayDate>2016-02-02123</BusinessDayDate><BeginDateTime>2018-03-23T15:50:47</BeginDateTime><StartTransactionDateTime>2018-03-23T15:49:55</StartTransactionDateTime><OperatorID OperatorName="éRìcëæòY" OperatorNameKana="MGT111">0000001</OperatorID><ReceiptDateTime>2018-03-23T15:50:47</ReceiptDateTime><TillID>00310001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµ"><Telephone><FullTelephoneNumber>0123456789012</FullTelephoneNumber><VoucherTelephoneNumber>0123456789012</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><RetailTransaction><AutoGenerationFlag>1</AutoGenerationFlag><AutoGenerationSequenceNumber>01003100011602026439</AutoGenerationSequenceNumber><TransactionLink><OrganizationHierarchy Level="Xebio" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>6437</SequenceNumber><BusinessDayDate>2016-02-02</BusinessDayDate><BeginDateTime>2018-03-23T15:49:12</BeginDateTime><OperatorID>0000001</OperatorID></TransactionLink><Customer><CustomerDemographic>23</CustomerDemographic><ForeignerOption>False</ForeignerOption></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>99</PurSubsidy><BasketOption>False</BasketOption><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxType="0" Department="333" Line="1104" Class="110402" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">0216578877849</ItemID><ScanBarCode>0216578877849</ScanBarCode><Description>ÉeÉXÉg-6-äOê≈ÉZÉbÉgè§ïi</Description><MdKanaName>ÉeÉXÉgÇU</MdKanaName><Sku>2600008191878</Sku><SkuType>0</SkuType><MdVender>000170001-WARM GRAY</MdVender><SupplierCode>1100005100</SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>1182409</ColorId><ColorName></ColorName><SizeId>2013</SizeId><SizeName>bb</SizeName><GroupCode>0</GroupCode><DptNameLocal></DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>01</OldSizeId><SizePatternId1>LTGRY</SizePatternId1><SizePatternId2>M</SizePatternId2><BrandId>JPN</BrandId><BrandName></BrandName><OldSku>0084</OldSku><RepSku>0001</RepSku><RegularSalesUnitPrice>1500</RegularSalesUnitPrice><ActualSalesUnitPrice>1500</ActualSalesUnitPrice><ExtendedAmount>1500</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>525</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>120</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><QRPromotionInfo><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotionInfo><QRPromotion1><QRPromotion><QRPromotionId>1</QRPromotionId><QRPromotionName>22</QRPromotionName><QRMinimumPrice>10</QRMinimumPrice><QROutputType>1</QROutputType><QROutputTargetValue>1</QROutputTargetValue><QRBmpFileName>1</QRBmpFileName></QRPromotion></QRPromotion1></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash" TenderTiming="0" TypeCode="Refund"><Amount>1620</Amount></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>120</Amount><TaxExcludeAmount>120</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1500</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">1500</Total><Total TotalType="TransactionGrandAmount">1620</Total></RetailTransaction></Transaction></POSLog>
Then I should get the ResultCode :

|ResultCode|
|344|


Scenario: forward_item_with_tag_test with saveForwardPosLogIncludeTag insert(JAXB Error).
When I get ResultBase with companyid 01 retailstoreid 0034 queue 1324 workstationid 0001 trainingmode 0 tag 0001 total 1620 and poslogxml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false">
Then I should get the ResultCode :

|ResultCode|
|140|


Scenario: forward_item_test with Tag select(Success).
Given entries for forword_item_resume_with_tag in RESTransaction
When I get forwardItem with companyId 01 retailStoreId 0016 queue 0001 businessDayDate 2018-03-04 tag 0001 and trainingFlag 0
Then I should get the forwardItemSuccessResult :

|Status|NCRWSSResultCode|NCRWSSExtendedResultCode|Tx|
|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–Å@ãIà…ö†âÆèëìX" ID="01" /><RetailStoreID>0016</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>0440</SequenceNumber><BusinessDayDate>2018-03-04</BusinessDayDate><BeginDateTime>2018-05-24T17:34:34</BeginDateTime><OperatorID OperatorName="ìXï‹Å@ÇaÇb" OperatorNameKana="√Ωƒ¿›ƒ≥º¨5" OperatorGroup="5">0000006</OperatorID><ReceiptDateTime>2018-05-24T17:34:34</ReceiptDateTime><TillID>00160002</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><SummaryReceiptReservation>0</SummaryReceiptReservation><BusinessUnit Name="êVèhñ{ìX" VoucherName="êVèhñ{ìX"><Telephone><FullTelephoneNumber>03-3354-0131</FullTelephoneNumber><VoucherTelephoneNumber>03-3354-0131</VoucherTelephoneNumber></Telephone><Address> </Address></BusinessUnit><RetailTransaction OutsideSalesFlag="false"><Customer><CustomerDemographic></CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="0026" Line="0026" Class="0026" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="Manual">4910112341211</ItemID><ScanBarCode>4910112341211</ScanBarCode><Description>òaéGéèÅ[è§ïiàÍóó</Description><MdKanaName>ºÆ≥À›≤¡◊›1</MdKanaName><Sku>4910112341211</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode></SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>2</ColorId><ColorName></ColorName><SizeId>26</SizeId><SizeName></SizeName><GroupCode>0011</GroupCode><DptNameLocal>òaéGéè</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>0</OldSizeId><SizePatternId1>26</SizePatternId1><SizePatternId2>26</SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1000</TaxableAmount></Tax><PointDiscountFlag>1</PointDiscountFlag><PointFlag>1</PointFlag><AggregateFlag>1</AggregateFlag><ItemAmount>1001</ItemAmount><CategoryCode></CategoryCode><LabelPrice>1000</LabelPrice><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><MagazineCode>49101</MagazineCode><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>1</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="0161" Line="0161" Class="0161" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="Manual">0401230011000</ItemID><ScanBarCode>0401230011000</ScanBarCode><Description>óméGéèÅ[è§ïiàÍóó</Description><MdKanaName>ºÆ≥À›≤¡◊›2</MdKanaName><Sku>0401230011000</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode></SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>3</ColorId><ColorName></ColorName><SizeId>61</SizeId><SizeName></SizeName><GroupCode>0022</GroupCode><DptNameLocal>óméGéèINTER MAX</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>0</OldSizeId><SizePatternId1>22</SizePatternId1><SizePatternId2>01</SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>2000</RegularSalesUnitPrice><ActualSalesUnitPrice>2000</ActualSalesUnitPrice><ExtendedAmount>2000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1999</TaxableAmount></Tax><PointDiscountFlag>1</PointDiscountFlag><PointFlag>1</PointFlag><AggregateFlag>1</AggregateFlag><ItemAmount>2000</ItemAmount><CategoryCode></CategoryCode><LabelPrice>1000</LabelPrice><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>1</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>2</Amount><TaxIncludeAmount>1</TaxIncludeAmount><TaxExcludeAmount>1</TaxExcludeAmount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2999</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">3000</Total><Total TotalType="TransactionGrandAmount">3001</Total></RetailTransaction></Transaction></POSLog>|


Scenario: forward_item_test with Tag in Training mode select(Success).
Given entries for forword_item_resume_with_tag in RESTransaction
When I get forwardItem with companyId 01 retailStoreId 0016 queue 0001 businessDayDate 2018-03-04 tag 0001 and trainingFlag 1
Then I should get the forwardItemSuccessResult :

|Status|NCRWSSResultCode|NCRWSSExtendedResultCode|Tx|
|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="true"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–Å@ãIà…ö†âÆèëìX" ID="01" /><RetailStoreID>0016</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>0441</SequenceNumber><BusinessDayDate>2018-03-04</BusinessDayDate><BeginDateTime>2018-05-24T17:34:34</BeginDateTime><OperatorID OperatorName="ìXï‹Å@ÇaÇb" OperatorNameKana="√Ωƒ¿›ƒ≥º¨5" OperatorGroup="5">0000006</OperatorID><ReceiptDateTime>2018-05-24T17:34:34</ReceiptDateTime><TillID>00160002</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><SummaryReceiptReservation>0</SummaryReceiptReservation><BusinessUnit Name="êVèhñ{ìX" VoucherName="êVèhñ{ìX"><Telephone><FullTelephoneNumber>03-3354-0131</FullTelephoneNumber><VoucherTelephoneNumber>03-3354-0131</VoucherTelephoneNumber></Telephone><Address> </Address></BusinessUnit><RetailTransaction OutsideSalesFlag="false"><Customer><CustomerDemographic></CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="0026" Line="0026" Class="0026" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="Manual">4910112341211</ItemID><ScanBarCode>4910112341211</ScanBarCode><Description>òaéGéèÅ[è§ïiàÍóó</Description><MdKanaName>ºÆ≥À›≤¡◊›1</MdKanaName><Sku>4910112341211</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode></SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>2</ColorId><ColorName></ColorName><SizeId>26</SizeId><SizeName></SizeName><GroupCode>0011</GroupCode><DptNameLocal>òaéGéè</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>0</OldSizeId><SizePatternId1>26</SizePatternId1><SizePatternId2>26</SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1000</TaxableAmount></Tax><PointDiscountFlag>1</PointDiscountFlag><PointFlag>1</PointFlag><AggregateFlag>1</AggregateFlag><ItemAmount>1001</ItemAmount><CategoryCode></CategoryCode><LabelPrice>1000</LabelPrice><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><MagazineCode>49101</MagazineCode><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>1</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="0161" Line="0161" Class="0161" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="Manual">0401230011000</ItemID><ScanBarCode>0401230011000</ScanBarCode><Description>óméGéèÅ[è§ïiàÍóó</Description><MdKanaName>ºÆ≥À›≤¡◊›2</MdKanaName><Sku>0401230011000</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode></SupplierCode><SubSupplierCode></SubSupplierCode><ColorId>3</ColorId><ColorName></ColorName><SizeId>61</SizeId><SizeName></SizeName><GroupCode>0022</GroupCode><DptNameLocal>óméGéèINTER MAX</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>0</OldSizeId><SizePatternId1>22</SizePatternId1><SizePatternId2>01</SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>2000</RegularSalesUnitPrice><ActualSalesUnitPrice>2000</ActualSalesUnitPrice><ExtendedAmount>2000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1999</TaxableAmount></Tax><PointDiscountFlag>1</PointDiscountFlag><PointFlag>1</PointFlag><AggregateFlag>1</AggregateFlag><ItemAmount>2000</ItemAmount><CategoryCode></CategoryCode><LabelPrice>1000</LabelPrice><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>1</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>2</Amount><TaxIncludeAmount>1</TaxIncludeAmount><TaxExcludeAmount>1</TaxExcludeAmount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2999</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">3000</Total><Total TotalType="TransactionGrandAmount">3001</Total></RetailTransaction></Transaction></POSLog>|


Scenario: forward_item_test with Tag in Training mode select(Success).
Given entries for forword_item_resume_with_tag in RESTransaction
When I get forwardItem with companyId 01 retailStoreId 0016 queue 0001 businessDayDate 2018-03-04 tag 0001 and trainingFlag 0
Then I should get the ResultCode :

|ResultCode|
|140|


Scenario: forward_item_test with Tag select(Error).
Given entries for forword_item_resume_with_tag_error in RESTransaction
When I get forwardItem with companyId 01 retailStoreId 0016 queue 0001 businessDayDate 2018-03-04 tag 0001 and trainingFlag 0
Then I should get the forwardItemErrorResult :

|NCRWSSResultCode|
|141|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 38 stories (of which 0 pending) containing 170 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.612 sec - in ncr.res.mobilepos.forwardItem.resource.test.ForwardItemTest
Running ncr.res.mobilepos.giftcard.test.GiftCardTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/giftcard/test/gift_card_test.scenario

(ncr/res/mobilepos/giftcard/test/gift_card_test.scenario)
Scenario: GiftCard test (QueryMember) for toppan-gift.xml file does not exist.
Given toppan-gift.xml file does not exist.
Using timeout for story gift_card_test.scenario of 300 secs.
When I test queryMember with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 138

Scenario: GiftCard test (sales) for toppan-gift.xml file does not exist.
Given toppan-gift.xml file does not exist.
When I test sales with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 138

Scenario: GiftCard test (cancel) for toppan-gift.xml file does not exist.
Given toppan-gift.xml file does not exist.
When I test cancel with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 138

Scenario: GiftCard test (activate) for toppan-gift.xml file does not exist.
Given toppan-gift.xml file does not exist.
When I test activate with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 138

Scenario: GiftCard test (charge) for toppan-gift.xml file does not exist.
Given toppan-gift.xml file does not exist.
When I test charge with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} campaign true privatebrand 1
Then I should get the result: 138

Scenario: GiftCard test (queryMember) for toppan-gift.xml file exists and giftcard service not started.
Given toppan-gift.xml file exists.
When I test queryMember with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 151

Scenario: GiftCard test (sales) for toppan-gift.xml file and giftcard service not started.
Given toppan-gift.xml file exists.
When I test sales with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 151

Scenario: GiftCard test (cancel) for toppan-gift.xml file and giftcard service not started.
Given toppan-gift.xml file exists.
When I test cancel with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 151

Scenario: GiftCard test (activate) for toppan-gift.xml file and giftcard service not started.
Given toppan-gift.xml file exists.
When I test activate with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the result: 151

Scenario: GiftCard test (charge) for toppan-gift.xml file and giftcard service not started.
Given toppan-gift.xml file exists.
When I test charge with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} campaign true privatebrand 1
Then I should get the result: 151

Scenario: GiftCard test (queryMember) for toppan-gift.xml exists and mockito giftcard service started.
Given toppan-gift.xml file exists.
Given I assume external library, CenterAccess returns normal result.
When I test queryMember with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand null
Then I should get the GiftResult :

|PriorAmount|CurrentAmount|ErrorCode|SubErrorCode|AuthorizationNumber|ExpirationDate|ActivationStatus|ExpirationStatus|LostStatus|
|100|200|0|0|01|2017-04-18|0|0|0|


Scenario: GiftCard test (sales) for toppan-gift.xml and mockito giftcard service started.
Given toppan-gift.xml file exists.
Given I assume external library, CenterAccess returns normal result.
When I test sales with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the GiftResult :

|PriorAmount|CurrentAmount|ErrorCode|SubErrorCode|AuthorizationNumber|ExpirationDate|ActivationStatus|ExpirationStatus|LostStatus|
|100|200|0|0|01|2017-04-18|0|0|0|


Scenario: GiftCard test (cancel) for toppan-gift.xml and mockito giftcard service started.
Given toppan-gift.xml file exists.
Given I assume external library, CenterAccess returns normal result.
When I test cancel with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the GiftResult :

|PriorAmount|CurrentAmount|ErrorCode|SubErrorCode|AuthorizationNumber|ExpirationDate|ActivationStatus|ExpirationStatus|LostStatus|
|100|200|0|0|01|2017-04-18|0|0|0|


Scenario: GiftCard test (activate) for toppan-gift.xml and mockito giftcard service started.
Given toppan-gift.xml file exists.
Given I assume external library, CenterAccess returns normal result.
When I test activate with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} privatebrand 1
Then I should get the GiftResult :

|PriorAmount|CurrentAmount|ErrorCode|SubErrorCode|AuthorizationNumber|ExpirationDate|ActivationStatus|ExpirationStatus|LostStatus|
|100|200|0|0|01|2017-04-18|0|0|0|


Scenario: GiftCard test (charge) for toppan-gift.xml and mockito giftcard service started.
Given toppan-gift.xml file exists.
Given I assume external library, CenterAccess returns normal result.
When I test charge with storeid 001 workstationid 0001 transactionid 1 test false giftcard {"JIS1":"JIS1-39 9012345678901234567890123456789","JIS2":"JIS2","Amount":"100","PIN":"PIN","TransactionId":"1"} campaign true privatebrand 1
Then I should get the GiftResult :

|PriorAmount|CurrentAmount|ErrorCode|SubErrorCode|AuthorizationNumber|ExpirationDate|ActivationStatus|ExpirationStatus|LostStatus|
|100|200|0|0|01|2017-04-18|0|0|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 39 stories (of which 0 pending) containing 185 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 22.998 sec - in ncr.res.mobilepos.giftcard.test.GiftCardTest
Running ncr.res.mobilepos.helper.DebugLoggerTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in ncr.res.mobilepos.helper.DebugLoggerTest
Running ncr.res.mobilepos.helper.LoggerTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.153 sec - in ncr.res.mobilepos.helper.LoggerTest
Running ncr.res.mobilepos.helper.POSLogHandlerTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in ncr.res.mobilepos.helper.POSLogHandlerTest
Running ncr.res.mobilepos.helper.SnapLoggerTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.144 sec - in ncr.res.mobilepos.helper.SnapLoggerTest
Running ncr.res.mobilepos.helper.SpmFileWriterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in ncr.res.mobilepos.helper.SpmFileWriterTest
Running ncr.res.mobilepos.helper.StringUtilityTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in ncr.res.mobilepos.helper.StringUtilityTest
Running ncr.res.mobilepos.initialization.resource.InitializationStatusResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/initialization/resource/initialization_status_resource_test.scenario

(ncr/res/mobilepos/initialization/resource/initialization_status_resource_test.scenario)
Scenario: Successful Test Initialization Status
Given Web application was initialized
Given Business logic factories were initialized
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG

Scenario: Initialization Status returns Error with WindowsEnvironmentVariables failure
Using timeout for story initialization_status_resource_test.scenario of 300 secs.
Given Web application was initialized
Given Business logic factories were initialized
Given WindowsEnvironmentVariables failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with EnvironmentEntries failure
Given Web application was initialized
Given Business logic factories were initialized
Given EnvironmentEntries failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with Logger failure
Given Web application was initialized
Given Business logic factories were initialized
Given Logger failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with SnapLogger failure
Given Web application was initialized
Given Business logic factories were initialized
Given SnapLogger failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with DebugLogger failure
Given Web application was initialized
Given Business logic factories were initialized
Given DebugLogger failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with SpmFileWriter failure
Given Web application was initialized
Given Business logic factories were initialized
Given SpmFileWriter failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with SQLStatement failure
Given Web application was initialized
Given Business logic factories were initialized
Given SQLStatement failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with JndiDBManagerMSSqlServer failure
Given Web application was initialized
Given Business logic factories were initialized
Given JndiDBManagerMSSqlServer failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns OK even with ToppanGiftCardConfigFactory failure, because it is optional.
Given Web application was initialized
Given Business logic factories were initialized
Given ToppanGiftCardConfigFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG

Scenario: Initialization Status returns OK even with QrCodeInfoFactory failure, because it is optional.
Given Web application was initialized
Given Business logic factories were initialized
Given QrCodeInfoFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG

Scenario: Initialization Status returns Error with BarcodeAssignmentFactory failure
Given Web application was initialized
Given Business logic factories were initialized
Given BarcodeAssignmentFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_ERROR_INITIALIZATION and extendedResultCode should be RES_ERROR_INITIALIZATION and message should be RES_FAILED_MSG

Scenario: Initialization Status returns Error with PricePromInfoFactory failure
Given Web application was initialized
Given Business logic factories were initialized
Given PricePromInfoFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG

Scenario: Initialization Status returns Error with PriceMMInfoFactory failure
Given Web application was initialized
Given Business logic factories were initialized
Given PriceMMInfoFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG

Scenario: Initialization Status returns Error with TaxRateInfoFactory failure
Given Web application was initialized
Given Business logic factories were initialized
Given TaxRateInfoFactory failed to instantiate
When the status check API are called
Then the resultcode should be RES_OK_INITIALIZATION and extendedResultCode should be RES_OK_INITIALIZATION and message should be RES_SUCCESS_MSG



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 40 stories (of which 0 pending) containing 200 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.257 sec - in ncr.res.mobilepos.initialization.resource.InitializationStatusResourceTest
Running ncr.res.mobilepos.journalization.resource.test.GetLastPayTxPoslogTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/get_last_pay_tx_poslog_test.scenario

(ncr/res/mobilepos/journalization/resource/test/get_last_pay_tx_poslog_test.scenario)
Scenario: No Pay POSLog
Given that has no last payout transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0004 businessdate:2016-08-16 trainingflag:0
Then it should get the NCRWSSResultCode:157
Using timeout for story get_last_pay_tx_poslog_test.scenario of 300 secs.

Scenario: With (1) PayOut POSLog
Given that has last payout transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0004 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|Amount|
|0|0247|0004|1556|2016-08-16|PayOut|10000.00|


Scenario: With (2) PayOut POSLogs
Given that has 2 last payout transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0004 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|Amount|
|0|0247|0004|1555|2016-08-16|PayOut|20000.00|


Scenario: With (1) PayIn POSLogs
Given that has 1 last payin transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0004 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|Amount|
|0|0247|0004|1000|2016-08-16|PayIn|10000.00|


Scenario: With PayIn and PayOut POSLogs
Given that has payin and payout transactions
When getting last payin/payout transactions companyid:01 storeid:0247 terminalid:0004 businessdate:2016-08-16 trainingflag:0
Then it should get the following:

|NCRWSSResultCode|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|Amount|
|0|0247|0004|1000|2016-08-16|PayIn|10000.00|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 41 stories (of which 0 pending) containing 205 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.993 sec - in ncr.res.mobilepos.journalization.resource.test.GetLastPayTxPoslogTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceCancelTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_cancel_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_cancel_test.scenario)
Scenario: Journalization of cancel transaction
Given a RESMaster DBInitiator
Using timeout for story journalization_resource_cancel_test.scenario of 300 secs.
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4230</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item  B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4230
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4230|2014-04-07|2014-04-07 16:05:42.0|Cancel|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4230</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item  B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog>|


Scenario: Cancel transaction journalization (already existing)
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4230</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item  B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4230|2014-04-07|2014-04-07 16:05:42.0|Cancel|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4230</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item  B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog>|


Scenario: Cancel transaction journalization (5-digit transaction number)
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|12345|2014-04-07|2014-04-07 16:05:42.0|Cancel|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Cancel</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>51</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>37</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">468</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>-126</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>50</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>36</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">459</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>720</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>01</PriceDerivationRuleID></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>53</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">667</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal"></Total><Total TotalType="TransactionGrandAmount"></Total></RetailTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 42 stories (of which 0 pending) containing 208 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.545 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceCancelTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceEODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_e_o_d_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_e_o_d_test.scenario)
Scenario: Journalize & Re-journalize EOD Transaction (Duplicate)
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Using timeout for story journalization_resource_e_o_d_test.scenario of 300 secs.
Given a MST_TILLIDINFO with OK data
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given manual business date is 2012-01-31
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize EOD Transaction
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4210
Then status should be OK
Then table TXL_SALES_JOURNAL will have 2 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|4210|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize EOD Transaction (5-digit Transaction Number)
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then table TXL_SALES_JOURNAL will have 3 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|4210|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|12345|2014-04-07|2014-04-07 21:00:45.0|EOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|

!-- Test scenarios for EOD involving updating of MST_TILLIDINFO table

Scenario: Journalize EOD Transaction where Business Day Date is empty
Given manual business date is 2012-01-01
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate></BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be PARSE_ERROR

Scenario: Journalize EOD Transaction where storeId doesn't exist
Given a MST_TILLIDINFO where storeId doesn't exist
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_NOT_EXIST

Scenario: Journalize EOD Transaction where Business Day Date format is invalid
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014/04/07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be PARSE_ERROR

Scenario: Journalize EOD Transaction where Business Day Date null
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be GENERAL_ERROR

Scenario: Journalize EOD Transaction where Till ID doesn't exist
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00314567</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_NOT_EXIST

Scenario: Journalize EOD Transaction where EOD is already done
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>EOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>0023</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T21:00:45</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T21:00:45</ReceiptDateTime><TillID>00310023</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Ending TenderType="Cash"><Amount>200000</Amount></Ending></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_EOD_FINISHED



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 43 stories (of which 0 pending) containing 217 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.644 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceEODTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceGiftReceiptTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_gift_receipt_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_gift_receipt_test.scenario)
Scenario: Save GiftReceipt POSLog (Not Duplicate, Normal Mode)
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Using timeout for story journalization_resource_gift_receipt_test.scenario of 300 secs.
Given TXL_GIFTRECEIPT_HISTORY is empty
Given a Journalization Resource
!-- Save Sales POSLog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7519</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><BeginDateTime>2018-06-22T13:48:31</BeginDateTime><OperatorID OperatorName="ê”îCé“" OperatorNameKana="æ∑∆›º¨∑Æ∂Ã◊∏ﬁµ›" OperatorGroup="1">9011011</OperatorID><ReceiptDateTime>2018-06-22T13:48:31</ReceiptDateTime><TillID>02470011</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><SummaryReceiptReservation>0</SummaryReceiptReservation><BusinessUnit Name="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX" VoucherName="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX"><Telephone><FullTelephoneNumber>03-1234-0005</FullTelephoneNumber><VoucherTelephoneNumber>03-1234-0005</VoucherTelephoneNumber></Telephone><Address> </Address></BusinessUnit><RetailTransaction OutsideSalesFlag="false"><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="0005" Line="0005" Class="0005" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN">4055016449448</ItemID><ScanBarCode>4055016449448</ScanBarCode><Description>É~ÉbÉLÅ[100ÉVÉáÅ[ÉgÉXÉäÅ[ÉuÉOÉâÉtÉBÉbÉNTÉVÉÉÉc</Description><MdKanaName>Mickey 100 Short Sleeve Graphic Tee</MdKanaName><Sku>4055016449448</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode>0325</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId></ColorId><ColorName></ColorName><SizeId></SizeId><SizeName></SizeName><GroupCode></GroupCode><DptNameLocal>é´èë</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId></OldSizeId><SizePatternId1></SizePatternId1><SizePatternId2></SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>2000</RegularSalesUnitPrice><ActualSalesUnitPrice>2000</ActualSalesUnitPrice><ExtendedAmount>2000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="0" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>2</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2000</TaxableAmount></Tax><PointDiscountFlag>0</PointDiscountFlag><PointFlag>0</PointFlag><AggregateFlag>0</AggregateFlag><ItemAmount>2002</ItemAmount><CategoryCode></CategoryCode><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>2</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>True</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag><MakerPrice></MakerPrice><TaxExemptFlag></TaxExemptFlag><StoreSalesPrice>2000</StoreSalesPrice></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash" TenderClass="1" TypeCode="Sale"><Amount>2002</Amount><TenderName>åªã‡</TenderName><Category>0010</Category><TenderId>1</TenderId></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>2</Amount><TaxExcludeAmount>2</TaxExcludeAmount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2000</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">2000</Total><Total TotalType="TransactionGrandAmount">2002</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 7519
!-- Save GiftReceipt POSLog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>GiftReceipt</TransactionType><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7535</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><BeginDateTime>2018-06-20T22:20:45</BeginDateTime><OperatorID OperatorName="ãŸã}ìoò^ÇæÇØÇ≈Ç´ÇÈêl" OperatorNameKana="∑›∑≠≥ƒ≥€∏¿ﬁπ√ﬁ∑ŸÀƒ" OperatorGroup="3">9</OperatorID><ReceiptDateTime>2018-06-20T22:20:45</ReceiptDateTime><TillID>02470011</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><BusinessUnit Name="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX" VoucherName="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX"><Telephone><FullTelephoneNumber>03-1234-0005</FullTelephoneNumber><VoucherTelephoneNumber>03-1234-0005</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><ControlTransaction Version="2.2"><ReceiptReprint TypeCode="GiftReceipt"><TransactionLink><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7519</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><TotalAmount>2002</TotalAmount></TransactionLink></ReceiptReprint></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Save GiftReceipt POSLog (Duplicate, Normal Mode)
!-- Re-Save GiftReceipt POSLog (Duplicate)
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>GiftReceipt</TransactionType><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7535</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><BeginDateTime>2018-06-20T22:20:45</BeginDateTime><OperatorID OperatorName="ãŸã}ìoò^ÇæÇØÇ≈Ç´ÇÈêl" OperatorNameKana="∑›∑≠≥ƒ≥€∏¿ﬁπ√ﬁ∑ŸÀƒ" OperatorGroup="3">9</OperatorID><ReceiptDateTime>2018-06-20T22:20:45</ReceiptDateTime><TillID>02470011</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><BusinessUnit Name="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX" VoucherName="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX"><Telephone><FullTelephoneNumber>03-1234-0005</FullTelephoneNumber><VoucherTelephoneNumber>03-1234-0005</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><ControlTransaction Version="2.2"><ReceiptReprint TypeCode="GiftReceipt"><TransactionLink><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7519</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><TotalAmount>2002</TotalAmount></TransactionLink></ReceiptReprint></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
!-- Get GiftReceipt Count (With GiftPrint History)
When I request to get the gift receipt printed counts for companyid:01 storeid:0247 trainingmode:0 businessdate:2017-08-15 deviceid:0011 txid:7519
Then count should be 1

Scenario: Save GiftReceipt POSLog (Training Mode)
!-- Save Sales POSLog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="true"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7519</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><BeginDateTime>2018-06-22T13:48:31</BeginDateTime><OperatorID OperatorName="ê”îCé“" OperatorNameKana="æ∑∆›º¨∑Æ∂Ã◊∏ﬁµ›" OperatorGroup="1">9011011</OperatorID><ReceiptDateTime>2018-06-22T13:48:31</ReceiptDateTime><TillID>02470011</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><SummaryReceiptReservation>0</SummaryReceiptReservation><BusinessUnit Name="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX" VoucherName="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX"><Telephone><FullTelephoneNumber>03-1234-0005</FullTelephoneNumber><VoucherTelephoneNumber>03-1234-0005</VoucherTelephoneNumber></Telephone><Address> </Address></BusinessUnit><RetailTransaction OutsideSalesFlag="false"><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="0005" Line="0005" Class="0005" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN">4055016449448</ItemID><ScanBarCode>4055016449448</ScanBarCode><Description>É~ÉbÉLÅ[100ÉVÉáÅ[ÉgÉXÉäÅ[ÉuÉOÉâÉtÉBÉbÉNTÉVÉÉÉc</Description><MdKanaName>Mickey 100 Short Sleeve Graphic Tee</MdKanaName><Sku>4055016449448</Sku><SkuType></SkuType><MdVender></MdVender><SupplierCode>0325</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId></ColorId><ColorName></ColorName><SizeId></SizeId><SizeName></SizeName><GroupCode></GroupCode><DptNameLocal>é´èë</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId></OldSizeId><SizePatternId1></SizePatternId1><SizePatternId2></SizePatternId2><BrandId></BrandId><BrandName></BrandName><OldSku></OldSku><RepSku></RepSku><RegularSalesUnitPrice>2000</RegularSalesUnitPrice><ActualSalesUnitPrice>2000</ActualSalesUnitPrice><ExtendedAmount>2000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>0</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="0" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>2</Amount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2000</TaxableAmount></Tax><PointDiscountFlag>0</PointDiscountFlag><PointFlag>0</PointFlag><AggregateFlag>0</AggregateFlag><ItemAmount>2002</ItemAmount><CategoryCode></CategoryCode><BeforeDpt></BeforeDpt><ExceptionFlag>0</ExceptionFlag><ElectronicMoneyFlag>1</ElectronicMoneyFlag><TaxTypeSource>1</TaxTypeSource><DiscountTypeSource>2</DiscountTypeSource><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>True</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon><RestockFlag>0</RestockFlag><MakerPrice></MakerPrice><TaxExemptFlag></TaxExemptFlag><StoreSalesPrice>2000</StoreSalesPrice></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash" TenderClass="1" TypeCode="Sale"><Amount>2002</Amount><TenderName>åªã‡</TenderName><Category>0010</Category><TenderId>1</TenderId></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>2</Amount><TaxExcludeAmount>2</TaxExcludeAmount><Percent>0.1</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">2000</TaxableAmount></Tax></LineItem><Total TotalType="TransactionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">2000</Total><Total TotalType="TransactionGrandAmount">2002</Total></RetailTransaction></Transaction></POSLog> and trainingmode 1
Then result should be OK
Then txid should be 7519
!-- Save GiftReceipt POSLog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="true"><TransactionType>GiftReceipt</TransactionType><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7536</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><BeginDateTime>2018-06-20T22:20:45</BeginDateTime><OperatorID OperatorName="ãŸã}ìoò^ÇæÇØÇ≈Ç´ÇÈêl" OperatorNameKana="∑›∑≠≥ƒ≥€∏¿ﬁπ√ﬁ∑ŸÀƒ" OperatorGroup="3">9</OperatorID><ReceiptDateTime>2018-06-20T22:20:45</ReceiptDateTime><TillID>02470011</TillID><SummaryReceiptNo></SummaryReceiptNo><FloorID>01</FloorID><BusinessUnit Name="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX" VoucherName="ì˙ñ{NCRÅ@NCRäùèÍí¨ìX"><Telephone><FullTelephoneNumber>03-1234-0005</FullTelephoneNumber><VoucherTelephoneNumber>03-1234-0005</VoucherTelephoneNumber></Telephone><Address></Address></BusinessUnit><ControlTransaction Version="2.2"><ReceiptReprint TypeCode="GiftReceipt"><TransactionLink><OrganizationHierarchy Level="ì˙ñ{NCR01" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0011</WorkstationID><SequenceNumber>7519</SequenceNumber><BusinessDayDate>2017-08-15</BusinessDayDate><TotalAmount>2002</TotalAmount></TransactionLink></ReceiptReprint></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
!-- Get GiftReceipt Count (With GiftPrint History in TrainingMode)
When I request to get the gift receipt printed counts for companyid:01 storeid:0247 trainingmode:1 businessdate:2017-08-15 deviceid:0011 txid:7519
Then count should be 1



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 44 stories (of which 0 pending) containing 220 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.436 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceGiftReceiptTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceLoanTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_loan_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_loan_test.scenario)
Scenario: Journalize & Re-journalize Loan Transaction (Duplicate)
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Using timeout for story journalization_resource_loan_test.scenario of 300 secs.
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Loan|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog>|

!-- Re-journalize Previous Normal Transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Loan|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize Loan Transaction
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Loan|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize Loan Transaction (5-digit Transaction Number)
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|12345|2014-04-07|2014-04-07 13:05:42.0|Loan|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Loan</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderLoan TenderType="Cash"><Amount>35000</Amount></TenderLoan></TenderControlTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 45 stories (of which 0 pending) containing 223 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.009 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceLoanTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceNormalTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_normal_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_normal_test.scenario)
Scenario: Journalization Initialization
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Using timeout for story journalization_resource_normal_test.scenario of 300 secs.
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalize & Re-journalize Normal Transaction (Duplicate)
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- Re-journalize Previous Normal Transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalization of another normal transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4210
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|5001|4210|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalization of a normal transaction with Store Coupon
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5002</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-08-09</BusinessDayDate><BeginDateTime>2014-08-09T10:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-08-09T10:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">0000000000050</ItemID><Description>Item A</Description><RegularSalesUnitPrice>1080</RegularSalesUnitPrice><ActualSalesUnitPrice>1080</ActualSalesUnitPrice><ExtendedAmount>1080</ExtendedAmount><ExtendedDiscountAmount>613</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">540</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>34</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">433</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">4920000000456</ItemID><Description>Item B</Description><RegularSalesUnitPrice>756</RegularSalesUnitPrice><ActualSalesUnitPrice>756</ActualSalesUnitPrice><ExtendedAmount>756</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">101</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>48</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">607</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">492000000789</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>540</RegularSalesUnitPrice><ActualSalesUnitPrice>540</ActualSalesUnitPrice><ExtendedAmount>540</ExtendedAmount><ExtendedDiscountAmount>540</ExtendedDiscountAmount><ItemSellingRule DiscountableFlag="False" /><Quantity>1</Quantity><Tax TaxType="Sales"><Amount>40</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">500</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Amount>100</Amount><Tax TaxType="Sales" TypeCode="Refund"><Amount>7</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">93</TaxableAmount></Tax><PriceDerivationRule ApplicationType="Total" Reference="StoreCoupon"><PriceDerivationRuleID>9842011800054</PriceDerivationRuleID><ReasonCode>Coupon</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Discount><Percentage>10</Percentage><Amount>174</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>438</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>7</SequenceNumber><Tax TaxType="Sales"><Amount>115</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1447</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1736</Total><Total TotalType="TransactionGrandAmount">1562</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4211
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|5001|4210|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|5002|4211|2014-08-09|2014-08-09 10:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5002</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-08-09</BusinessDayDate><BeginDateTime>2014-08-09T10:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-08-09T10:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">0000000000050</ItemID><Description>Item A</Description><RegularSalesUnitPrice>1080</RegularSalesUnitPrice><ActualSalesUnitPrice>1080</ActualSalesUnitPrice><ExtendedAmount>1080</ExtendedAmount><ExtendedDiscountAmount>613</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">540</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>34</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">433</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">4920000000456</ItemID><Description>Item B</Description><RegularSalesUnitPrice>756</RegularSalesUnitPrice><ActualSalesUnitPrice>756</ActualSalesUnitPrice><ExtendedAmount>756</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">101</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>48</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">607</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">492000000789</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>540</RegularSalesUnitPrice><ActualSalesUnitPrice>540</ActualSalesUnitPrice><ExtendedAmount>540</ExtendedAmount><ExtendedDiscountAmount>540</ExtendedDiscountAmount><ItemSellingRule DiscountableFlag="False" /><Quantity>1</Quantity><Tax TaxType="Sales"><Amount>40</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">500</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Amount>100</Amount><Tax TaxType="Sales" TypeCode="Refund"><Amount>7</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">93</TaxableAmount></Tax><PriceDerivationRule ApplicationType="Total" Reference="StoreCoupon"><PriceDerivationRuleID>9842011800054</PriceDerivationRuleID><ReasonCode>Coupon</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Discount><Percentage>10</Percentage><Amount>174</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>438</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>7</SequenceNumber><Tax TaxType="Sales"><Amount>115</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1447</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1736</Total><Total TotalType="TransactionGrandAmount">1562</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalization of a normal transaction with Line Item text notes
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5002</WorkstationID><SequenceNumber>4212</SequenceNumber><BusinessDayDate>2014-08-09</BusinessDayDate><BeginDateTime>2014-08-09T10:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-08-09T10:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">0000000000050</ItemID><Description>Item A</Description><RegularSalesUnitPrice>1080</RegularSalesUnitPrice><ActualSalesUnitPrice>1080</ActualSalesUnitPrice><ExtendedAmount>1080</ExtendedAmount><ExtendedDiscountAmount>613</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">540</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>34</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">433</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">4920000000456</ItemID><Description>Item B</Description><RegularSalesUnitPrice>756</RegularSalesUnitPrice><ActualSalesUnitPrice>756</ActualSalesUnitPrice><ExtendedAmount>756</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">101</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>48</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">607</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">492000000789</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>540</RegularSalesUnitPrice><ActualSalesUnitPrice>540</ActualSalesUnitPrice><ExtendedAmount>540</ExtendedAmount><ExtendedDiscountAmount>540</ExtendedDiscountAmount><ItemSellingRule DiscountableFlag="False" /><Quantity>1</Quantity><Tax TaxType="Sales"><Amount>40</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">500</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Amount>100</Amount><Tax TaxType="Sales" TypeCode="Refund"><Amount>7</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">93</TaxableAmount></Tax><PriceDerivationRule ApplicationType="Total" Reference="StoreCoupon"><PriceDerivationRuleID>9842011800054</PriceDerivationRuleID><ReasonCode>Coupon</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Discount><Percentage>10</Percentage><Amount>174</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>438</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>7</SequenceNumber><Tax TaxType="Sales"><Amount>115</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1447</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1736</Total><Total TotalType="TransactionGrandAmount">1562</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4212
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|5001|4210|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|5002|4211|2014-08-09|2014-08-09 10:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5002</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-08-09</BusinessDayDate><BeginDateTime>2014-08-09T10:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-08-09T10:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">0000000000050</ItemID><Description>Item A</Description><RegularSalesUnitPrice>1080</RegularSalesUnitPrice><ActualSalesUnitPrice>1080</ActualSalesUnitPrice><ExtendedAmount>1080</ExtendedAmount><ExtendedDiscountAmount>613</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">540</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>34</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">433</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">4920000000456</ItemID><Description>Item B</Description><RegularSalesUnitPrice>756</RegularSalesUnitPrice><ActualSalesUnitPrice>756</ActualSalesUnitPrice><ExtendedAmount>756</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">101</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>48</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">607</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">492000000789</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>540</RegularSalesUnitPrice><ActualSalesUnitPrice>540</ActualSalesUnitPrice><ExtendedAmount>540</ExtendedAmount><ExtendedDiscountAmount>540</ExtendedDiscountAmount><ItemSellingRule DiscountableFlag="False" /><Quantity>1</Quantity><Tax TaxType="Sales"><Amount>40</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">500</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Amount>100</Amount><Tax TaxType="Sales" TypeCode="Refund"><Amount>7</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">93</TaxableAmount></Tax><PriceDerivationRule ApplicationType="Total" Reference="StoreCoupon"><PriceDerivationRuleID>9842011800054</PriceDerivationRuleID><ReasonCode>Coupon</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Discount><Percentage>10</Percentage><Amount>174</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>438</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>7</SequenceNumber><Tax TaxType="Sales"><Amount>115</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1447</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1736</Total><Total TotalType="TransactionGrandAmount">1562</Total></RetailTransaction></Transaction></POSLog>|
|0031|5002|4212|2014-08-09|2014-08-09 10:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5002</WorkstationID><SequenceNumber>4212</SequenceNumber><BusinessDayDate>2014-08-09</BusinessDayDate><BeginDateTime>2014-08-09T10:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-08-09T10:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">0000000000050</ItemID><Description>Item A</Description><RegularSalesUnitPrice>1080</RegularSalesUnitPrice><ActualSalesUnitPrice>1080</ActualSalesUnitPrice><ExtendedAmount>1080</ExtendedAmount><ExtendedDiscountAmount>613</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">540</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>34</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">433</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">4920000000456</ItemID><Description>Item B</Description><RegularSalesUnitPrice>756</RegularSalesUnitPrice><ActualSalesUnitPrice>756</ActualSalesUnitPrice><ExtendedAmount>756</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">101</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>48</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">607</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="EAN13">492000000789</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>540</RegularSalesUnitPrice><ActualSalesUnitPrice>540</ActualSalesUnitPrice><ExtendedAmount>540</ExtendedAmount><ExtendedDiscountAmount>540</ExtendedDiscountAmount><ItemSellingRule DiscountableFlag="False" /><Quantity>1</Quantity><Tax TaxType="Sales"><Amount>40</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">500</TaxableAmount></Tax><Note>Sale Note</Note></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Amount>100</Amount><Tax TaxType="Sales" TypeCode="Refund"><Amount>7</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">93</TaxableAmount></Tax><PriceDerivationRule ApplicationType="Total" Reference="StoreCoupon"><PriceDerivationRuleID>9842011800054</PriceDerivationRuleID><ReasonCode>Coupon</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Discount><Percentage>10</Percentage><Amount>174</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>001</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>438</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>7</SequenceNumber><Tax TaxType="Sales"><Amount>115</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1447</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1736</Total><Total TotalType="TransactionGrandAmount">1562</Total></RetailTransaction></Transaction></POSLog>|


Scenario: (RES-6871) Avoid Throwing Exception in SnapLogger Cause: SnapPath is not existing.
Given an snapPath file path is d:/ncr/res/log/snap_dir
Given an iowPath file path is d:/ncr/res/log
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- Re-journalize Previous Normal Transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalization of a normal transaction (5-digit Transaction Number)
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|12345|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalize a poslog with unknown device
Given RESMaster MST_DEVICEINFO_Empty table
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|5001|4209|2014-04-07|2014-04-07 16:05:42.0|Sales|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>5001</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Sales POSLog (MeX Base)
Given a Journalization Resource
Given a RESMaster DBInitiator
Given RESMaster MST_DEVICEINFO_Empty table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
!-- MeX: Cash Payment
When executing journal log with xml <?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0001|0002|3521|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|

!-- MeX: Credit Payment (CardType=ICCREDIT)
When executing journal log with xml <?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3498</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T10:48:16</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T10:48:16</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract" SetFlag="">200</Amount><SetAmount/><PreviousPrice>2000</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>1</PriceDerivationRuleID><Description>2å¬10Åì,3å¬30Åì</Description><ReasonCode>1</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310776</ItemID><ScanBarCode>4908087310776</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258306</Sku><SkuType>0</SkuType><MdVender>52UW8309</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>090</ColorId><ColorName>Ãﬁ◊Ø∏</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692182</OldSku><RepSku>00258306</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>1</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310783</ItemID><ScanBarCode>4908087310783</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258305</Sku><SkuType>0</SkuType><MdVender>52UW8314</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692177</OldSku><RepSku>00258305</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>2</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1944</Amount><Authorization SignatureRequiredFlag="False"><RequestingTerminalID>XXXXX-XXX-XXXXX</RequestingTerminalID><AuthorizationCode>XXXXXX</AuthorizationCode><AuthorizationDateTime>20160915161217</AuthorizationDateTime><MerchantNumber>1234</MerchantNumber><ApplicationIdentifier>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</ApplicationIdentifier><ApplicationTransactionCounter>XXXXXXXXXX</ApplicationTransactionCounter><NPCSeqNo>99999</NPCSeqNo><SlipNo>99999</SlipNo></Authorization><CreditDebit CardType="IC"><SettledBrand>ICCREDIT</SettledBrand><CardIssuerID>0005</CardIssuerID><IssueSequence/><IssuerName>XXXXXXXXXXXXXXXXXXXX</IssuerName><AccountNumber>999999XXXXXX9999</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo/><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>144</Amount><TaxExcludeAmount>144</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1800</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">1800</Total><Total TotalType="TransactionGrandAmount">1944</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0001|0002|3498|2016-10-04|2016-10-04 10:48:16.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3498</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T10:48:16</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T10:48:16</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract" SetFlag="">200</Amount><SetAmount/><PreviousPrice>2000</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>1</PriceDerivationRuleID><Description>2å¬10Åì,3å¬30Åì</Description><ReasonCode>1</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310776</ItemID><ScanBarCode>4908087310776</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258306</Sku><SkuType>0</SkuType><MdVender>52UW8309</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>090</ColorId><ColorName>Ãﬁ◊Ø∏</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692182</OldSku><RepSku>00258306</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>1</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310783</ItemID><ScanBarCode>4908087310783</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258305</Sku><SkuType>0</SkuType><MdVender>52UW8314</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692177</OldSku><RepSku>00258305</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>2</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1944</Amount><Authorization SignatureRequiredFlag="False"><RequestingTerminalID>XXXXX-XXX-XXXXX</RequestingTerminalID><AuthorizationCode>XXXXXX</AuthorizationCode><AuthorizationDateTime>20160915161217</AuthorizationDateTime><MerchantNumber>1234</MerchantNumber><ApplicationIdentifier>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</ApplicationIdentifier><ApplicationTransactionCounter>XXXXXXXXXX</ApplicationTransactionCounter><NPCSeqNo>99999</NPCSeqNo><SlipNo>99999</SlipNo></Authorization><CreditDebit CardType="IC"><SettledBrand>ICCREDIT</SettledBrand><CardIssuerID>0005</CardIssuerID><IssueSequence/><IssuerName>XXXXXXXXXXXXXXXXXXXX</IssuerName><AccountNumber>999999XXXXXX9999</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo/><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>144</Amount><TaxExcludeAmount>144</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1800</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">1800</Total><Total TotalType="TransactionGrandAmount">1944</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3521|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|

!-- MeX: Credit Payment (CardType=MSCREDIT)
When executing journal log with xml <?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0100</WorkstationID><SequenceNumber>6764</SequenceNumber><BusinessDayDate>2016-10-27</BusinessDayDate><BeginDateTime>2016-10-27T10:31:15</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2016-10-27T10:31:15</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ñkäCìπéDñyésñLïΩãÊåéä¶ìåéOè è\àÍíöñ⁄ÇPÅ|ÇPÇO</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>10</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>00</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName/><SizeId>5007</SizeId><SizeName/><GroupCode>null</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName/><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>21600</Amount><Authorization SignatureRequiredFlag="True"><RequestingTerminalID>1111122200000</RequestingTerminalID><AuthorizationCode>R23456</AuthorizationCode><AuthorizationDateTime>20161027103045</AuthorizationDateTime><ReferenceNumber>161027024701001234503207</ReferenceNumber><NPCSeqNo>12345</NPCSeqNo><SlipNo>12345</SlipNo></Authorization><CreditDebit CardType="Credit"><SettledBrand>MSCREDIT</SettledBrand><CardIssuerID>0105</CardIssuerID><IssueSequence>111112220000012345</IssueSequence><IssuerName>MUFG CARD</IssuerName><AccountNumber>XXXXXXXXXXXX3456</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo>0,0,,,</PaymentInfo><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>1600</Amount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">20000</Total><Total TotalType="TransactionGrandAmount">21600</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0001|0002|3498|2016-10-04|2016-10-04 10:48:16.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3498</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T10:48:16</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T10:48:16</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract" SetFlag="">200</Amount><SetAmount/><PreviousPrice>2000</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>1</PriceDerivationRuleID><Description>2å¬10Åì,3å¬30Åì</Description><ReasonCode>1</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310776</ItemID><ScanBarCode>4908087310776</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258306</Sku><SkuType>0</SkuType><MdVender>52UW8309</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>090</ColorId><ColorName>Ãﬁ◊Ø∏</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692182</OldSku><RepSku>00258306</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>1</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310783</ItemID><ScanBarCode>4908087310783</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258305</Sku><SkuType>0</SkuType><MdVender>52UW8314</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692177</OldSku><RepSku>00258305</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>2</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1944</Amount><Authorization SignatureRequiredFlag="False"><RequestingTerminalID>XXXXX-XXX-XXXXX</RequestingTerminalID><AuthorizationCode>XXXXXX</AuthorizationCode><AuthorizationDateTime>20160915161217</AuthorizationDateTime><MerchantNumber>1234</MerchantNumber><ApplicationIdentifier>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</ApplicationIdentifier><ApplicationTransactionCounter>XXXXXXXXXX</ApplicationTransactionCounter><NPCSeqNo>99999</NPCSeqNo><SlipNo>99999</SlipNo></Authorization><CreditDebit CardType="IC"><SettledBrand>ICCREDIT</SettledBrand><CardIssuerID>0005</CardIssuerID><IssueSequence/><IssuerName>XXXXXXXXXXXXXXXXXXXX</IssuerName><AccountNumber>999999XXXXXX9999</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo/><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>144</Amount><TaxExcludeAmount>144</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1800</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">1800</Total><Total TotalType="TransactionGrandAmount">1944</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3521|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0247|0100|6764|2016-10-27|2016-10-27 10:31:15.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0100</WorkstationID><SequenceNumber>6764</SequenceNumber><BusinessDayDate>2016-10-27</BusinessDayDate><BeginDateTime>2016-10-27T10:31:15</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2016-10-27T10:31:15</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ñkäCìπéDñyésñLïΩãÊåéä¶ìåéOè è\àÍíöñ⁄ÇPÅ|ÇPÇO</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>10</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>00</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName/><SizeId>5007</SizeId><SizeName/><GroupCode>null</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName/><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>21600</Amount><Authorization SignatureRequiredFlag="True"><RequestingTerminalID>1111122200000</RequestingTerminalID><AuthorizationCode>R23456</AuthorizationCode><AuthorizationDateTime>20161027103045</AuthorizationDateTime><ReferenceNumber>161027024701001234503207</ReferenceNumber><NPCSeqNo>12345</NPCSeqNo><SlipNo>12345</SlipNo></Authorization><CreditDebit CardType="Credit"><SettledBrand>MSCREDIT</SettledBrand><CardIssuerID>0105</CardIssuerID><IssueSequence>111112220000012345</IssueSequence><IssuerName>MUFG CARD</IssuerName><AccountNumber>XXXXXXXXXXXX3456</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo>0,0,,,</PaymentInfo><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>1600</Amount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">20000</Total><Total TotalType="TransactionGrandAmount">21600</Total></RetailTransaction></Transaction></POSLog>|

!-- MeX: Other Payment
When executing journal log with xml <?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3522</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Other" TypeCode="Sale"><Amount>71600</Amount><Other><TenderFlag>6</TenderFlag><TenderId>311</TenderId><TenderName>è¨êÿéË</TenderName><MemberNo>0</MemberNo><AuthorizationCode>0</AuthorizationCode><SlipNo>0</SlipNo><ChangeType>1</ChangeType><StampType>0</StampType><PointType>0</PointType></Other></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0001|0002|3498|2016-10-04|2016-10-04 10:48:16.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3498</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T10:48:16</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T10:48:16</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract" SetFlag="">200</Amount><SetAmount/><PreviousPrice>2000</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>1</PriceDerivationRuleID><Description>2å¬10Åì,3å¬30Åì</Description><ReasonCode>1</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310776</ItemID><ScanBarCode>4908087310776</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258306</Sku><SkuType>0</SkuType><MdVender>52UW8309</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>090</ColorId><ColorName>Ãﬁ◊Ø∏</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692182</OldSku><RepSku>00258306</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>1</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310783</ItemID><ScanBarCode>4908087310783</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258305</Sku><SkuType>0</SkuType><MdVender>52UW8314</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692177</OldSku><RepSku>00258305</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>2</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1944</Amount><Authorization SignatureRequiredFlag="False"><RequestingTerminalID>XXXXX-XXX-XXXXX</RequestingTerminalID><AuthorizationCode>XXXXXX</AuthorizationCode><AuthorizationDateTime>20160915161217</AuthorizationDateTime><MerchantNumber>1234</MerchantNumber><ApplicationIdentifier>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</ApplicationIdentifier><ApplicationTransactionCounter>XXXXXXXXXX</ApplicationTransactionCounter><NPCSeqNo>99999</NPCSeqNo><SlipNo>99999</SlipNo></Authorization><CreditDebit CardType="IC"><SettledBrand>ICCREDIT</SettledBrand><CardIssuerID>0005</CardIssuerID><IssueSequence/><IssuerName>XXXXXXXXXXXXXXXXXXXX</IssuerName><AccountNumber>999999XXXXXX9999</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo/><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>144</Amount><TaxExcludeAmount>144</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1800</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">1800</Total><Total TotalType="TransactionGrandAmount">1944</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3521|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3522|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3522</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Other" TypeCode="Sale"><Amount>71600</Amount><Other><TenderFlag>6</TenderFlag><TenderId>311</TenderId><TenderName>è¨êÿéË</TenderName><MemberNo>0</MemberNo><AuthorizationCode>0</AuthorizationCode><SlipNo>0</SlipNo><ChangeType>1</ChangeType><StampType>0</StampType><PointType>0</PointType></Other></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0247|0100|6764|2016-10-27|2016-10-27 10:31:15.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0100</WorkstationID><SequenceNumber>6764</SequenceNumber><BusinessDayDate>2016-10-27</BusinessDayDate><BeginDateTime>2016-10-27T10:31:15</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2016-10-27T10:31:15</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ñkäCìπéDñyésñLïΩãÊåéä¶ìåéOè è\àÍíöñ⁄ÇPÅ|ÇPÇO</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>10</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>00</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName/><SizeId>5007</SizeId><SizeName/><GroupCode>null</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName/><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>21600</Amount><Authorization SignatureRequiredFlag="True"><RequestingTerminalID>1111122200000</RequestingTerminalID><AuthorizationCode>R23456</AuthorizationCode><AuthorizationDateTime>20161027103045</AuthorizationDateTime><ReferenceNumber>161027024701001234503207</ReferenceNumber><NPCSeqNo>12345</NPCSeqNo><SlipNo>12345</SlipNo></Authorization><CreditDebit CardType="Credit"><SettledBrand>MSCREDIT</SettledBrand><CardIssuerID>0105</CardIssuerID><IssueSequence>111112220000012345</IssueSequence><IssuerName>MUFG CARD</IssuerName><AccountNumber>XXXXXXXXXXXX3456</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo>0,0,,,</PaymentInfo><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>1600</Amount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">20000</Total><Total TotalType="TransactionGrandAmount">21600</Total></RetailTransaction></Transaction></POSLog>|

!-- MeX: Voucher Payment
When executing journal log with xml <?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3523</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Voucher" TypeCode="Sale"><Amount>71600</Amount><Voucher><VoucherId>1</VoucherId><VoucherName>71600â~åî</VoucherName><ChangeType>1</ChangeType><FaceValueAmount>71600</FaceValueAmount><StampType>0</StampType><PointType>0</PointType></Voucher></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0001|0002|3498|2016-10-04|2016-10-04 10:48:16.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3498</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T10:48:16</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T10:48:16</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract" SetFlag="">200</Amount><SetAmount/><PreviousPrice>2000</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>1</PriceDerivationRuleID><Description>2å¬10Åì,3å¬30Åì</Description><ReasonCode>1</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>4</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310776</ItemID><ScanBarCode>4908087310776</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258306</Sku><SkuType>0</SkuType><MdVender>52UW8309</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>090</ColorId><ColorName>Ãﬁ◊Ø∏</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692182</OldSku><RepSku>00258306</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>1</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="0" Department="727" Line="06" Class="72706" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4908087310783</ItemID><ScanBarCode>4908087310783</ScanBarCode><Description>ÉXÉgÉbÉLÉìÉO</Description><MdKanaName>ΩƒØ∑›∏ﬁ</MdKanaName><Sku>00258305</Sku><SkuType>0</SkuType><MdVender>52UW8314</MdVender><SupplierCode>0379</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>31114</GroupCode><DptNameLocal>ñÏãÖè¨ï®</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004052</BrandId><BrandName>ÇlÇhÇyÇtÇmÇn</BrandName><OldSku>0379692177</OldSku><RepSku>00258305</RepSku><RegularSalesUnitPrice>1000</RegularSalesUnitPrice><ActualSalesUnitPrice>1000</ActualSalesUnitPrice><ExtendedAmount>1000</ExtendedAmount><ExtendedDiscountAmount>100</ExtendedDiscountAmount><CostPrice>520</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><InputType>1</InputType><Amount Action="Subtract">100</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>5</PriceDerivationRuleID><MSQuantity>1</MSQuantity><MSNo>1</MSNo><MSDetailNo>2</MSDetailNo></PriceDerivationRule></RetailPriceModifier><Tax TaxType="VAT"><Amount>72</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">900</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1944</Amount><Authorization SignatureRequiredFlag="False"><RequestingTerminalID>XXXXX-XXX-XXXXX</RequestingTerminalID><AuthorizationCode>XXXXXX</AuthorizationCode><AuthorizationDateTime>20160915161217</AuthorizationDateTime><MerchantNumber>1234</MerchantNumber><ApplicationIdentifier>XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</ApplicationIdentifier><ApplicationTransactionCounter>XXXXXXXXXX</ApplicationTransactionCounter><NPCSeqNo>99999</NPCSeqNo><SlipNo>99999</SlipNo></Authorization><CreditDebit CardType="IC"><SettledBrand>ICCREDIT</SettledBrand><CardIssuerID>0005</CardIssuerID><IssueSequence/><IssuerName>XXXXXXXXXXXXXXXXXXXX</IssuerName><AccountNumber>999999XXXXXX9999</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo/><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>144</Amount><TaxExcludeAmount>144</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1800</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">1800</Total><Total TotalType="TransactionGrandAmount">1944</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3521|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3521</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>71600</Amount></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3522|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3522</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Other" TypeCode="Sale"><Amount>71600</Amount><Other><TenderFlag>6</TenderFlag><TenderId>311</TenderId><TenderName>è¨êÿéË</TenderName><MemberNo>0</MemberNo><AuthorizationCode>0</AuthorizationCode><SlipNo>0</SlipNo><ChangeType>1</ChangeType><StampType>0</StampType><PointType>0</PointType></Other></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0001|0002|3523|2016-10-04|2016-10-04 17:01:50.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0001</RetailStoreID><WorkstationID TerminalType="2">0002</WorkstationID><SequenceNumber>3523</SequenceNumber><BusinessDayDate>2016-10-04</BusinessDayDate><BeginDateTime>2016-10-04T17:01:50</BeginDateTime><OperatorID OperatorName="ÉeÉXÉgè]ã∆àı(X)1" OperatorNameKana="√Ωƒºﬁ≠≥∑ﬁÆ≥≤›(X)1">0000001</OperatorID><ReceiptDateTime>2016-10-04T17:01:50</ReceiptDateTime><TillID>00010002</TillID><BusinessUnit Name="NCRìX" VoucherName="NCRìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 1-21-2</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>08</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>5</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>0</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName>»≤Àﬁ∞</ColorName><SizeId>5007</SizeId><SizeName>L</SizeName><GroupCode>21112</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName>ÉçÉTÉìÉZÉì</BrandName><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxType="1" Department="412" Line="02" Class="41202" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4994192918266</ItemID><ScanBarCode>4994192918266</ScanBarCode><Description>ÉLÉÉÉfÉBÉoÉbÉOÅ@ÇTÇuÇP</Description><MdKanaName>∑¨√ﬁ® ﬁØ∏ﬁ 5V1</MdKanaName><Sku>04705854</Sku><SkuType>0</SkuType><MdVender>CB5V1</MdVender><SupplierCode>3081</SupplierCode><SubSupplierCode>0000</SubSupplierCode><ColorId>000</ColorId><ColorName>-</ColorName><SizeId>0001</SizeId><SizeName>FF</SizeName><GroupCode>21114</GroupCode><DptNameLocal>ÇlÉLÉÉÉfÉBÉoÉbÉO</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>000</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>004378</BrandId><BrandName>É^ÉCÉgÉäÉXÉg</BrandName><OldSku>0000000000</OldSku><RepSku>04705854</RepSku><RegularSalesUnitPrice>50000</RegularSalesUnitPrice><ActualSalesUnitPrice>50000</ActualSalesUnitPrice><ExtendedAmount>50000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>27500</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>3703</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">46297</TaxableAmount></Tax><Associate><AssociateID></AssociateID><AssociateName></AssociateName><AssociateKanaName></AssociateKanaName></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tender TenderType="Voucher" TypeCode="Sale"><Amount>71600</Amount><Voucher><VoucherId>1</VoucherId><VoucherName>71600â~åî</VoucherName><ChangeType>1</ChangeType><FaceValueAmount>71600</FaceValueAmount><StampType>0</StampType><PointType>0</PointType></Voucher></Tender></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Tax TaxType="VAT"><Amount>5303</Amount><TaxIncludeAmount>3703</TaxIncludeAmount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">66297</TaxableAmount></Tax></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tax TaxType="Documentary"><TaxAuthority>StampDuty</TaxAuthority><Amount>200</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">71600</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">2</Total><Total TotalType="TransactionSubtotal">70000</Total><Total TotalType="TransactionGrandAmount">71600</Total></RetailTransaction></Transaction></POSLog>|
|0247|0100|6764|2016-10-27|2016-10-27 10:31:15.0|Sales|A010|<?xml version="1.0" encoding="UTF-8"?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>Sales</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0100</WorkstationID><SequenceNumber>6764</SequenceNumber><BusinessDayDate>2016-10-27</BusinessDayDate><BeginDateTime>2016-10-27T10:31:15</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2016-10-27T10:31:15</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX" VoucherName="Ω∞ ﬂ∞ΩŒﬂ∞¬æﬁÀﬁµÉhÅ[ÉÄéDñyåéä¶ìX"><Telephone><FullTelephoneNumber>011-859-6670</FullTelephoneNumber><VoucherTelephoneNumber>011-859-6670</VoucherTelephoneNumber></Telephone><Address>ñkäCìπéDñyésñLïΩãÊåéä¶ìåéOè è\àÍíöñ⁄ÇPÅ|ÇPÇO</Address></BusinessUnit><RetailTransaction><LayawayFlag>false</LayawayFlag><Customer><CustomerDemographic>10</CustomerDemographic></Customer><PointsLater>0</PointsLater><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><TeamOrder>False</TeamOrder><PurSubsidy>0</PurSubsidy><AllPointExp>False</AllPointExp><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxType="0" Department="405" Line="05" Class="40505" ItemType="0"><UrgentEntryFlag>0</UrgentEntryFlag><ItemID Type="EAN13">4589915154917</ItemID><ScanBarCode>4589915154917</ScanBarCode><Description>É_ÉìÉ{Å[ÉãÉjÉbÉgÉuÉãÉ]Éì</Description><MdKanaName>¿ﬁ›Œﬁ∞Ÿ∆ØƒÃﬁŸøﬁ›</MdKanaName><Sku>04983805</Sku><SkuType>00</SkuType><MdVender>045-52810 98</MdVender><SupplierCode>3056</SupplierCode><SubSupplierCode>4451</SubSupplierCode><ColorId>048</ColorId><ColorName/><SizeId>5007</SizeId><SizeName/><GroupCode>null</GroupCode><DptNameLocal>ÇkÉSÉãÉtÉAÉEÉ^Å[</DptNameLocal><SalesPriceFrom>0</SalesPriceFrom><OldSizeId>000</OldSizeId><SizePatternId1>010</SizePatternId1><SizePatternId2>000</SizePatternId2><BrandId>008703</BrandId><BrandName/><OldSku>0000000000</OldSku><RepSku>04983805</RepSku><RegularSalesUnitPrice>20000</RegularSalesUnitPrice><ActualSalesUnitPrice>20000</ActualSalesUnitPrice><ExtendedAmount>20000</ExtendedAmount><ExtendedDiscountAmount>0</ExtendedDiscountAmount><CostPrice>8000</CostPrice><ItemSellingRule ItemDiscountFlag="1" TotalDiscountFlag="1" NonItemFlag="1" PointFlag="1" /><Quantity>1</Quantity><Tax TaxType="VAT"><Amount>1600</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax><Associate><AssociateID/><AssociateName/><AssociateKanaName/></Associate><SizeChange>False</SizeChange><SizeChanged>False</SizeChanged><PointExp>False</PointExp><DiscountExp>False</DiscountExp><GuaranteeFlag>False</GuaranteeFlag><Coupon><CouponFlag>False</CouponFlag></Coupon></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>21600</Amount><Authorization SignatureRequiredFlag="True"><RequestingTerminalID>1111122200000</RequestingTerminalID><AuthorizationCode>R23456</AuthorizationCode><AuthorizationDateTime>20161027103045</AuthorizationDateTime><ReferenceNumber>161027024701001234503207</ReferenceNumber><NPCSeqNo>12345</NPCSeqNo><SlipNo>12345</SlipNo></Authorization><CreditDebit CardType="Credit"><SettledBrand>MSCREDIT</SettledBrand><CardIssuerID>0105</CardIssuerID><IssueSequence>111112220000012345</IssueSequence><IssuerName>MUFG CARD</IssuerName><AccountNumber>XXXXXXXXXXXX3456</AccountNumber><DestCompanyCode/><CreditStatus>00</CreditStatus><PaymentInfo>0,0,,,</PaymentInfo><ExpirationDate>XXXX</ExpirationDate><PaymentMethod PaymentMethodCode="10" PaymentMethodName="àÍäá" /><ChangeType/><StampType/><PointType/></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="VAT"><Amount>1600</Amount><TaxExcludeAmount>1600</TaxExcludeAmount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">20000</TaxableAmount></Tax></LineItem><Total TotalType="TransasctionPurchaseQuantity">1</Total><Total TotalType="TransactionSubtotal">20000</Total><Total TotalType="TransactionGrandAmount">21600</Total></RetailTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 46 stories (of which 0 pending) containing 232 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.081 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceNormalTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceOperatorSignOnOffTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_operator_sign_on_off_test.scenario
!-- SIGN-ON SCENARIO with Existing Device
(ncr/res/mobilepos/journalization/resource/test/journalization_resource_operator_sign_on_off_test.scenario)
Scenario: New entry in TXU_POS_CTRL, Update LastTxId of Device
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Using timeout for story journalization_resource_operator_sign_on_off_test.scenario of 300 secs.
Then RESMaster MST_DEVICEINFO database table should have the following row(s):

|StoreId|TerminalId|CompanyId|LastTxId|Training|Status|
|0031|1111|01|0|0|Active|
|0031|4567|01|0|0|Active|
|0031|5001|01|0|0|Active|
|0031|5002|01|0|0|Active|

Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_Empty table database
Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|

Given a Journalization Resource
When executing journal log with xml <POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1234|2014-04-07|2014-04-07 09:00:42.0|SignOn|A010|<POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|001|

Then RESMaster MST_DEVICEINFO database table should have the following row(s):

|StoreId|TerminalId|CompanyId|LastTxId|Training|Status|
|0031|1111|01|1234|0|Active|
|0031|4567|01|0|0|Active|
|0031|5001|01|0|0|Active|
|0031|5002|01|0|0|Active|

!-- SIGN-ON SCENARIOS with Non-Existing Device

Scenario: New entry in TXU_POS_CTRL, Ignore update LastTxId of device
Given RESMaster MST_DEVICEINFO_Empty table
Then RESMaster MST_DEVICEINFO database table should have the following row(s):

|StoreId|TerminalId|CompanyId|LastTxId|Training|Status|

Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_Empty table database
When executing journal log with xml <POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1234|2014-04-07|2014-04-07 09:00:42.0|SignOn|A010|<POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|001|

Then RESMaster MST_DEVICEINFO database table should have the following row(s):

|StoreId|TerminalId|CompanyId|LastTxId|Training|Status|


Scenario: Updating entry in TXU_POS_CTRL
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_SignOnSignOff table database
Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|NULL|
|0031|2222|111|

When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1234|2014-04-07|2014-04-07 09:00:42.0|SignOn|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|001|
|0031|2222|111|


Scenario: With SoftwareVersion BusinessUnit and EventLog
Given a TXU_SOFTWARE_VERSION_Empty table database
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0004</WorkstationID><SequenceNumber>1071</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-26T20:59:48</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-26T20:59:48</ReceiptDateTime><TillID>02470004</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOn></ControlTransaction></Transaction><EventLog>[{"to":"https://localhost:8443/resTransaction/rest/transaction/saveposlogxml","count":1,"stamp":1485431960518,"response":"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;&lt;POSLogResp&gt;&lt;NCRWSSExtendedResultCode&gt;0&lt;/NCRWSSExtendedResultCode&gt;&lt;NCRWSSResultCode&gt;0&lt;/NCRWSSResultCode&gt;&lt;Status&gt;0&lt;/Status&gt;&lt;TxID&gt;1070&lt;/TxID&gt;&lt;/POSLogResp&gt;"},{"source":"core","context":"Credential","event":"credential.signOut.successful","stamp":1485431960519,"data":"null"}]</EventLog></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1071
Then status should be OK
Then table TXL_SALES_JOURNAL will have 2 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1234|2014-04-07|2014-04-07 09:00:42.0|SignOn|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|
|0247|0004|1071|2016-08-16|2017-01-26 20:59:48.0|SignOn|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOn</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0004</WorkstationID><SequenceNumber>1071</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-26T20:59:48</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-26T20:59:48</ReceiptDateTime><TillID>02470004</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOn Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOn></ControlTransaction></Transaction><EventLog>[{"to":"https://localhost:8443/resTransaction/rest/transaction/saveposlogxml","count":1,"stamp":1485431960518,"response":"&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;&lt;POSLogResp&gt;&lt;NCRWSSExtendedResultCode&gt;0&lt;/NCRWSSExtendedResultCode&gt;&lt;NCRWSSResultCode&gt;0&lt;/NCRWSSResultCode&gt;&lt;Status&gt;0&lt;/Status&gt;&lt;TxID&gt;1070&lt;/TxID&gt;&lt;/POSLogResp&gt;"},{"source":"core","context":"Credential","event":"credential.signOut.successful","stamp":1485431960519,"data":"null"}]</EventLog></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|001|
|0031|2222|111|
|0247|0004|9011011|

Then the TXU_SOFTWARE_VERSION database table should have the following row(s):

|CompanyId|StoreId|TerminalId|Container|MobileShop|RESTransaction|RESTabletUI|RESUiConfig|
|01|0247|0004|5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36|null|3.2.0.7-SNAPSHOT(2016/10/12)|3.2.0.13.|3.2.0.13.|

!-- SIGN-OFF SCENARIOS

Scenario: New entry in TXU_POS_CTRL, Ignore update LastTxId of device
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_Empty table database
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator" /></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1235
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1235|2014-04-07|2014-04-07 09:00:42.0|SignOff|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|NULL|


Scenario: Updating entry in TXU_POS_CTRL
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_SignOnSignOff table database
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator" /></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1235
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1235|2014-04-07|2014-04-07 09:00:42.0|SignOff|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator" /></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|NULL|
|0031|2222|111|

!-- AUTOMATIC SIGN-OFF SCENARIOS

Scenario: New entry in TXU_POS_CTRL, Ignore update LastTxId of device
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_Empty table database
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1236</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><AutoSignoff Accountability="Operator"/></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1236
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1236|2014-04-07|2014-04-07 09:00:42.0|AutoSignOff|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1236</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><AutoSignoff Accountability="Operator"/></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|NULL|


Scenario: Updating entry in TXU_POS_CTRL
Given TXL_SALES_JOURNAL is empty
Given a TXU_POS_CTRL_SignOnSignOff table database
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1236</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><AutoSignoff Accountability="Operator"/></ControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1236
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|1111|1236|2014-04-07|2014-04-07 09:00:42.0|AutoSignOff|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1236</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><ControlTransaction Version="2.2"><AutoSignoff Accountability="Operator"/></ControlTransaction></Transaction></POSLog>|

Then the TXU_POS_CTRL database table should have the following row(s):

|StoreId|TerminalNo|OpeCode|
|0031|1111|NULL|
|0031|2222|111|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 47 stories (of which 0 pending) containing 240 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.755 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceOperatorSignOnOffTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourcePickupTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_pickup_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_pickup_test.scenario)
Scenario: Journalize & Re-journalize Pickup Transaction (Duplicate)
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Using timeout for story journalization_resource_pickup_test.scenario of 300 secs.
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Pickup|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog>|

!-- Re-journalize Previous Normal Transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Pickup|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize Pickup Transaction
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 13:05:42.0|Pickup|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize Pickup Transaction (5-digit Transaction Number)
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a Journalization Resource
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|12345|2014-04-07|2014-04-07 13:05:42.0|Pickup|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Pickup</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderPickup TenderType="Cash"><Amount>28000</Amount></TenderPickup></TenderControlTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 48 stories (of which 0 pending) containing 243 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.583 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourcePickupTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceReturnNoReceiptTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_return_no_receipt_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_return_no_receipt_test.scenario)
Scenario: Journalization of a return without receipt transaction
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Using timeout for story journalization_resource_return_no_receipt_test.scenario of 300 secs.
Given TXL_SALES_JOURNAL is empty
Given a corpid111
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|1234|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Journalization of a duplicate return without receipt transaction
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a corpid111
!-- first transaction poslog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|1234|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- duplicate transaction poslog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|1234|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- check if no duplicate poslog was saved
Then table TXL_SALES_JOURNAL will have 1 row(s)

Scenario: Journalization of two return without receipt transaction with same poslog but different txid
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a corpid111
!-- first transaction poslog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1234
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|1234|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- second transaction poslog
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 1235
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|1234|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1234</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|4567|1235|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>1235</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

!-- check if no duplicate poslog was saved
Then table TXL_SALES_JOURNAL will have 2 row(s)

Scenario: Journalization of a return without receipt transaction (5-digit Transaction Number)
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|12345|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 49 stories (of which 0 pending) containing 247 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.234 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceReturnNoReceiptTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceReturnWithReceiptTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_return_with_receipt_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_return_with_receipt_test.scenario)
Scenario: Journalize & Re-journalize Return Transaction (Duplicate)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Using timeout for story journalization_resource_return_with_receipt_test.scenario of 300 secs.
Given TXL_SALES_VOIDED is empty
Given a corpid111
IdentityInsert DataSet:test/ncr/res/mobilepos/journalization/resource/datasets/TXL_POSLOG_Returned_0074.xml
Given returned transaction 0074 is inserted
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 0075
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|74|2014-04-07|2014-04-07 16:05:42.0|Sale|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="PriceOverride"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0005</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1548</Amount><Tax><Amount>114</Amount></Tax><Voucher><VoucherID>12345</VoucherID></Voucher><Authorization SignatureRequiredFlag="false"><AuthorizationCode>004444</AuthorizationCode><RequestingTerminalID>4969380800020</RequestingTerminalID><AuthorizationDateTime>13/12/10 11:12:04</AuthorizationDateTime><ReferenceNumber>131210-00010001-12345-03200</ReferenceNumber></Authorization><CreditDebit CardType="Credit"><CardIssuerID>012</CardIssuerID><IssueSequence>496938080002012345</IssueSequence><IssuerName>NCR CARD</IssuerName><AccountNumber>xxxxxxxxxxxx4321</AccountNumber><PaymentMethod PaymentMethodCode="0" PaymentMethodName="??"><Ndivided>1</Ndivided></PaymentMethod></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|4567|75|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

Then the TXL_SALES_VOIDED database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|
|0031|4567|74|2014-04-07|Return|

!-- Re-journalize Previous Returned Transaction
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|74|2014-04-07|2014-04-07 16:05:42.0|Sale|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="PriceOverride"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0005</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1548</Amount><Tax><Amount>114</Amount></Tax><Voucher><VoucherID>12345</VoucherID></Voucher><Authorization SignatureRequiredFlag="false"><AuthorizationCode>004444</AuthorizationCode><RequestingTerminalID>4969380800020</RequestingTerminalID><AuthorizationDateTime>13/12/10 11:12:04</AuthorizationDateTime><ReferenceNumber>131210-00010001-12345-03200</ReferenceNumber></Authorization><CreditDebit CardType="Credit"><CardIssuerID>012</CardIssuerID><IssueSequence>496938080002012345</IssueSequence><IssuerName>NCR CARD</IssuerName><AccountNumber>xxxxxxxxxxxx4321</AccountNumber><PaymentMethod PaymentMethodCode="0" PaymentMethodName="??"><Ndivided>1</Ndivided></PaymentMethod></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|4567|75|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

Then the TXL_SALES_VOIDED database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|
|0031|4567|74|2014-04-07|Return|


Scenario: Normal Transaction(Transaction To Be Returned) Not Found
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a corpid111
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|75|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|


Scenario: Invalid Transaction Link (Transaction Link is not of Sale type)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a corpid111
IdentityInsert DataSet:test/ncr/res/mobilepos/journalization/resource/datasets/TXL_POSLOG_Returned_0074_Cancel.xml
Given returned transaction 0074_Cancel is inserted
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Original Transaction already voided
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given TXL_SALES_VOIDED is empty
Given a corpid111
IdentityInsert DataSet:test/ncr/res/mobilepos/journalization/resource/datasets/TXL_POSLOG_Normal_4209.xml
Given normal transaction 4209 is inserted
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Void</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:06:30</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:06:32</ReceiptDateTime><TillID>0</TillID><RetailTransaction TransactionStatus="Voided"><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Voided"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4211
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 16:05:42.0|Sale|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="PriceOverride"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0005</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1548</Amount><Tax><Amount>114</Amount></Tax><Voucher><VoucherID>12345</VoucherID></Voucher><Authorization SignatureRequiredFlag="false"><AuthorizationCode>004444</AuthorizationCode><RequestingTerminalID>4969380800020</RequestingTerminalID><AuthorizationDateTime>13/12/10 11:12:04</AuthorizationDateTime><ReferenceNumber>131210-00010001-12345-03200</ReferenceNumber></Authorization><CreditDebit CardType="Credit"><CardIssuerID>012</CardIssuerID><IssueSequence>496938080002012345</IssueSequence><IssuerName>NCR CARD</IssuerName><AccountNumber>xxxxxxxxxxxx4321</AccountNumber><PaymentMethod PaymentMethodCode="0" PaymentMethodName="??"><Ndivided>1</Ndivided></PaymentMethod></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|4567|4211|2014-04-07|2014-04-07 16:06:30.0|Void|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Void</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4211</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:06:30</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:06:32</ReceiptDateTime><TillID>0</TillID><RetailTransaction TransactionStatus="Voided"><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Voided"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Sale"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

Then table TXL_SALES_VOIDED will have 1 row(s)
Then the TXL_SALES_VOIDED database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|
|0031|4567|4209|2014-04-07|Void|

!-- Do a return transaction with transaction 4209
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0075</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Journalize Return Transaction (5-digit Transaction Number)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given TXL_SALES_VOIDED is empty
IdentityInsert DataSet:test/ncr/res/mobilepos/journalization/resource/datasets/TXL_POSLOG_Returned_0074.xml
Given returned transaction 0074 is inserted
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|74|2014-04-07|2014-04-07 16:05:42.0|Sale|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:05:42</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax></Sale></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Sale TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="PriceOverride"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0005</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax></Sale></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="CreditDebit" TypeCode="Sale"><Amount>1548</Amount><Tax><Amount>114</Amount></Tax><Voucher><VoucherID>12345</VoucherID></Voucher><Authorization SignatureRequiredFlag="false"><AuthorizationCode>004444</AuthorizationCode><RequestingTerminalID>4969380800020</RequestingTerminalID><AuthorizationDateTime>13/12/10 11:12:04</AuthorizationDateTime><ReferenceNumber>131210-00010001-12345-03200</ReferenceNumber></Authorization><CreditDebit CardType="Credit"><CardIssuerID>012</CardIssuerID><IssueSequence>496938080002012345</IssueSequence><IssuerName>NCR CARD</IssuerName><AccountNumber>xxxxxxxxxxxx4321</AccountNumber><PaymentMethod PaymentMethodCode="0" PaymentMethodName="??"><Ndivided>1</Ndivided></PaymentMethod></CreditDebit></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|
|0031|4567|12345|2014-04-07|2014-04-07 16:08:00.0|Return|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>Return</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:08:00</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T16:08:02</ReceiptDateTime><TillID>0</TillID><RetailTransaction><PriceDerivationResult MethodCode="Promotion"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">101</Amount><PreviousPrice>1101</PreviousPrice><PriceDerivationRule><PriceDerivationRuleID>0002</PriceDerivationRuleID><Description>Type2</Description><ReasonCode>0002</ReasonCode></PriceDerivationRule></PriceDerivationResult><Customer><CustomerDemographic>02</CustomerDemographic></Customer><TransactionLink ReasonCode="Return"><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>0074</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T16:05:42</BeginDateTime></TransactionLink><ItemCount>6</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000050</ItemID><Description>Item B5</Description><RegularSalesUnitPrice>556</RegularSalesUnitPrice><ActualSalesUnitPrice>556</ActualSalesUnitPrice><ExtendedAmount>556</ExtendedAmount><ExtendedDiscountAmount>101</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">51</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">422</TaxableAmount></Tax><Tax TaxType="Sales" NormalTaxType="Exceptional"><Amount>1</Amount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000040</ItemID><Description>Item B4</Description><RegularSalesUnitPrice>545</RegularSalesUnitPrice><ActualSalesUnitPrice>545</ActualSalesUnitPrice><ExtendedAmount>545</ExtendedAmount><ExtendedDiscountAmount>99</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Amount Action="Subtract">50</Amount><PriceDerivationRule ApplicationType="MixMatch"><PriceDerivationRuleID>0002</PriceDerivationRuleID><MMQuantity>1</MMQuantity><ReasonCode>0002</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">49</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>33</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">413</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Return TaxableFlag="True" Department="9999" Line="0" Class="0"><ItemID Type="Code128">0000000000400</ItemID><Description>Item C4</Description><RegularSalesUnitPrice>1440</RegularSalesUnitPrice><ActualSalesUnitPrice>1440</ActualSalesUnitPrice><ExtendedAmount>1440</ExtendedAmount><ExtendedDiscountAmount>793</ExtendedDiscountAmount><ItemSellingRule /><Quantity>1</Quantity><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>1</SequenceNumber><Percent Action="Subtract">50</Percent><Amount Action="Subtract">720</Amount><PriceDerivationRule ApplicationType="Item"><PriceDerivationRuleID>0001</PriceDerivationRuleID><ReasonCode>01</ReasonCode></PriceDerivationRule></RetailPriceModifier><RetailPriceModifier MethodCode="Markdown"><SequenceNumber>2</SequenceNumber><Percent Action="Subtract">10</Percent><Amount Action="Subtract">73</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule></RetailPriceModifier><Tax TaxType="Sales"><Amount>47</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">600</TaxableAmount></Tax><Disposal Method="Undecided" /><Note>Return Note</Note></Return></LineItem><LineItem><SequenceNumber>4</SequenceNumber><Discount><Percentage>10</Percentage><Amount>172</Amount><PriceDerivationRule ApplicationType="Total"><PriceDerivationRuleID>0002</PriceDerivationRuleID><ReasonCode>02</ReasonCode></PriceDerivationRule><Note>Discount Note</Note></Discount></LineItem><LineItem><SequenceNumber>5</SequenceNumber><Tender TenderType="Cash" TypeCode="Refund"><Amount>2000</Amount><TenderChange><Amount>452</Amount></TenderChange><Note>Tender Note</Note></Tender></LineItem><LineItem><SequenceNumber>6</SequenceNumber><Tax TaxType="Sales"><Amount>114</Amount><Percent>8</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">1434</TaxableAmount><Note>Tax Note</Note></Tax></LineItem><Total TotalType="TransactionSubtotal">1720</Total><Total TotalType="TransactionGrandAmount">1548</Total></RetailTransaction></Transaction></POSLog>|

Then the TXL_SALES_VOIDED database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TxType|
|0031|4567|74|2014-04-07|Return|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 50 stories (of which 0 pending) containing 252 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.627 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceReturnWithReceiptTest
Running ncr.res.mobilepos.journalization.resource.test.JournalizationResourceSODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/journalization/resource/test/journalization_resource_s_o_d_test.scenario

(ncr/res/mobilepos/journalization/resource/test/journalization_resource_s_o_d_test.scenario)
Scenario: Journalize & Re-journalize SOD Transaction (Duplicate)
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Using timeout for story journalization_resource_s_o_d_test.scenario of 300 secs.
Given TXL_SALES_JOURNAL is empty
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4209
Then status should be OK
Then table TXL_SALES_JOURNAL will have 1 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize SOD Transaction
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 4210
Then status should be OK
Then table TXL_SALES_JOURNAL will have 2 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|4210|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize SOD Transaction (5-digit Transaction Number)
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK
Then txid should be 12345
Then status should be OK
Then table TXL_SALES_JOURNAL will have 3 row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):

|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime|TxType|ServerId|Tx|
|0031|4567|4209|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|4210|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4210</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|
|0031|4567|12345|2014-04-07|2014-04-07 09:00:42.0|SOD|A010|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: Journalize SOD Transaction where Business Day Date is empty
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BusinessDayDate></BusinessDayDate><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be PARSE_ERROR

Scenario: Journalize SOD Transaction where (SOD, EOD) value is (9,0)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>1</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Journalize SOD Transaction where (SOD, EOD) value is (9,9)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>2</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Journalize SOD Transaction where (SOD, EOD) value is (9,1)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given a MST_TILLIDINFO with OK data
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>3</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Journalize SOD Transaction where tillId doesn't exist
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0004</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_NOT_EXIST

Scenario: Journalize SOD Transaction where storeId doesn't exist in MST_TILLIDINFO
Given a MST_TILLIDINFO where storeId doesn't exist
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_NOT_EXIST

Scenario: Journalize SOD Transaction where SOD hasn't been started yet (sodFlag = 0)
Given a MST_TILLIDINFO where sod and eod flags are invalid for SOD
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be OK

Scenario: Journalize SOD Transaction where SOD has already been performed (sodFlag = 1)
Given a MST_TILLIDINFO where sod and eod flags are invalid for SOD
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>1</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be TILL_SOD_FINISHED

Scenario: Journalize SOD Transaction but Business Day Date format is invalid
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014/04/07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be PARSE_ERROR

Scenario: Journalize SOD Transaction where Business Day Date is null
When executing journal log with xml <?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4309</SequenceNumber><BeginDateTime>2014-05-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog> and trainingmode 0
Then result should be GENERAL_ERROR



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 51 stories (of which 0 pending) containing 265 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.045 sec - in ncr.res.mobilepos.journalization.resource.test.JournalizationResourceSODTest
Running ncr.res.mobilepos.poslogstatus.test.PoslogStatusTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/poslogstatus/test/poslog_status_test.scenario

(ncr/res/mobilepos/poslogstatus/test/poslog_status_test.scenario)
Scenario: TXL_SALES_JOURNAL no data.
Given a loaded dataset txl_sales_journal_nodata
When a check status with consolidation true transfer true
Then a consolidationResult is 0
Then a transferResult is 0

Scenario: consolidation is true and transfer is true
Using timeout for story poslog_status_test.scenario of 300 secs.
Given a loaded dataset txl_sales_journal
When a check status with consolidation true transfer true
Then a consolidationResult is 1
Then a transferResult is 2

Scenario: consolidation is false and transfer is true
Given a loaded dataset txl_sales_journal
When a check status with consolidation false transfer true
Then a transferResult is 2

Scenario: consolidation is true and transfer is false
Given a loaded dataset txl_sales_journal
When a check status with consolidation true transfer false
Then a consolidationResult is 1

Scenario: consolidation is false and transfer is false
Given a loaded dataset txl_sales_journal
When a check status with consolidation false transfer false
Then a resultCode is 154
Then a resultExtendedCode is 154



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 52 stories (of which 0 pending) containing 270 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.06 sec - in ncr.res.mobilepos.poslogstatus.test.PoslogStatusTest
Running ncr.res.mobilepos.posmailinfo.resource.test.ListPosMailInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/posmailinfo/resource/test/list_pos_mail_info_test.scenario

(ncr/res/mobilepos/posmailinfo/resource/test/list_pos_mail_info_test.scenario)
Scenario: (BUG) MEXUI-726 (With Common and Specific to Store, TargetStoreType= 0 & 1)
Given data in table MST_POSMAIL_INFO
Using timeout for story list_pos_mail_info_test.scenario of 300 secs.
Given data in table MST_POSMAIL_STORE
When I get list of posmail messages with companyid:01, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): [{"RecordId":"1","MailSubject":"Message 01_1","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉo","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"},{"RecordId":"2","MailSubject":"Message 01_2","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉoÉXÉPÉbÉgÉ{Å[Éãã≥é∫Ç≈ÇÃêÈì`é‘ÅBëOíÎÇÕóöóèëÇÃÇÃÇÃÇÅBåŒÇ≈îﬂÇµÇ¢âπÇ™ÅAÉeÉåÉrÇÃâøäiÅBÇÕÇ≈éãè∞ñçÇÃÇÃç¿ÇËÇ‹Ç∑ÅBéÿÇËä∑Ç¶óöóèëÇÃÇÃÅBÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBíuÇ≠Ç±Ç∆ÅBï®ç°ÅAÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅB","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"}]

Scenario: (With Specific Store Is Set Only, TargetStoreType= 1)
When I get list of posmail messages with companyid:02, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): [{"RecordId":"2","MailSubject":"Message 02_2","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉoÉXÉPÉbÉgÉ{Å[Éãã≥é∫Ç≈ÇÃêÈì`é‘ÅBëOíÎÇÕóöóèëÇÃÇÃÇÃÇÅBåŒÇ≈îﬂÇµÇ¢âπÇ™ÅAÉeÉåÉrÇÃâøäiÅBÇÕÇ≈éãè∞ñçÇÃÇÃç¿ÇËÇ‹Ç∑ÅBéÿÇËä∑Ç¶óöóèëÇÃÇÃÅBÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBíuÇ≠Ç±Ç∆ÅBï®ç°ÅAÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅB","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"}]

Scenario: (With Common Store Is Set Only, TargetStoreType= 0)
When I get list of posmail messages with companyid:03, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): [{"RecordId":"1","MailSubject":"Message 03_1","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉo","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"},{"RecordId":"2","MailSubject":"Message 03_2","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉoÉXÉPÉbÉgÉ{Å[Éãã≥é∫Ç≈ÇÃêÈì`é‘ÅBëOíÎÇÕóöóèëÇÃÇÃÇÃÇÅBåŒÇ≈îﬂÇµÇ¢âπÇ™ÅAÉeÉåÉrÇÃâøäiÅBÇÕÇ≈éãè∞ñçÇÃÇÃç¿ÇËÇ‹Ç∑ÅBéÿÇËä∑Ç¶óöóèëÇÃÇÃÅBÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBíuÇ≠Ç±Ç∆ÅBï®ç°ÅAÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅB","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"}]

Scenario: (With No Common Store/Specific Is Set, companyid= 07)
When I get list of posmail messages with companyid:07, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): []

Scenario: (With Common And Not Set, TargetStoreType= 0 & 2)
When I get list of posmail messages with companyid:05, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): [{"RecordId":"1","MailSubject":"Message 05_1","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉo","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"}]

Scenario: (With Specific Set To Multiple Records, TargetStoreType= 1)
When I get list of posmail messages with companyid:06, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): [{"RecordId":"1","MailSubject":"Message 06_1","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉo","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"},{"RecordId":"2","MailSubject":"Message 06_2","MailBody":"ÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBñÓìõÇÃèTññÇíuÇ≠Ç±Ç∆ÅBåó¨ê´îrèoï®ç°ÅAÇ†Ç»ÇΩÇÃÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅBÉpÉtÉHÅ[É}ÉìÉXÇÃêÈì`ÅBåó¨ÇÃÇÃÉoÉXÉPÉbÉgÉ{Å[Éãã≥é∫Ç≈ÇÃêÈì`é‘ÅBëOíÎÇÕóöóèëÇÃÇÃÇÃÇÅBåŒÇ≈îﬂÇµÇ¢âπÇ™ÅAÉeÉåÉrÇÃâøäiÅBÇÕÇ≈éãè∞ñçÇÃÇÃç¿ÇËÇ‹Ç∑ÅBéÿÇËä∑Ç¶óöóèëÇÃÇÃÅBÇÃÉCÉvÉTÉÄÇÃíQÇ´ÇÃç¿ÇËÇ‹Ç∑ÅBÇµÇ©ÇµÅAÉTÉbÉJÅ[ÇÕã≠âªÇ≥ÇÍÇ‹Ç∑ÅBíuÇ≠Ç±Ç∆ÅBï®ç°ÅAÉTÉbÉJÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇËÇ‹Ç∑ÅB","RegOpeCode":"1","RegOpeName":"ã¥ñ{","StartDate":"2016/08/15","EndDate":"2016/08/17"}]

Scenario: Get List of POS Mail Messages (With 0 Data)
Given an empty table in MST_POSMAIL_INFO
Given an empty table in MST_POSMAIL_STORE
When I get list of posmail messages with companyid:01, storeid:0247, terminalid:0001, businessdate:2016-08-16
Then I should get NCRWSSResultCode:0
Then I should get InfoData(JSON String): []



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 53 stories (of which 0 pending) containing 277 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.879 sec - in ncr.res.mobilepos.posmailinfo.resource.test.ListPosMailInfoTest
Running ncr.res.mobilepos.pricing.pricemminfo.test.PriceMMListTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/pricemminfo/test/price_m_m_list_test.scenario

(ncr/res/mobilepos/pricing/pricemminfo/test/price_m_m_list_test.scenario)
Scenario: test PriceMMInfo.
Using timeout for story price_m_m_list_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/pricing/pricemminfo/test/data_PriceMM.xml

Scenario: when the sku is not exist in DB
When get the priceMMInfo with sku 20000001
Then the Result Code is 0
Then the emptyResult is null

Scenario: when the priceMMSku not contains "*"
When get the priceMMInfo with sku 11000002
Then the Result Code is 0
Then I should get the PriceMMInfo :

|MMNo|ConditionCount1|ConditionCount2|ConditionCount3|ConditionPrice1|ConditionPrice2|ConditionPrice3|DecisionPrice1|DecisionPrice2|DecisionPrice3|AveragePrice1|AveragePrice2|AveragePrice3|Note|Sku|
|1|1|2|3|100.0|100.0|100.0|200.0|200.0|200.0|150.0|150.0|150.0|ëSìX11|11000002|


Scenario: when the priceMMSku contains "*"
When get the priceMMInfo with sku 11100003
Then the Result Code is 0
Then I should get the PriceMMInfo :

|MMNo|ConditionCount1|ConditionCount2|ConditionCount3|ConditionPrice1|ConditionPrice2|ConditionPrice3|DecisionPrice1|DecisionPrice2|DecisionPrice3|AveragePrice1|AveragePrice2|AveragePrice3|Note|Sku|
|1|1|2|3|100.0|100.0|100.0|200.0|200.0|200.0|150.0|150.0|150.0|ëSìX11|1110000*|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 54 stories (of which 0 pending) containing 281 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.91 sec - in ncr.res.mobilepos.pricing.pricemminfo.test.PriceMMListTest
Running ncr.res.mobilepos.pricing.pricemminfo.test.PriceMMTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/pricemminfo/test/price_m_m_test.scenario

(ncr/res/mobilepos/pricing/pricemminfo/test/price_m_m_test.scenario)
Scenario: test PriceMMInfo.
Using timeout for story price_m_m_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/pricing/pricemminfo/test/data_PriceMM.xml

Scenario: COMPANYID exist but STOREID not exist.
When the tomcat startUp with companyId 01 and storeId null
Then the Result Code is 2

Scenario: STOREID exist but COMPANYID not exist.
When the tomcat startUp with companyId null and storeId 0001
Then the Result Code is 2

Scenario: Business date is not set.
When the tomcat startUp with companyId 02 and storeId 0002
Then the Result Code is 2

Scenario: can't find rigth info because deleteFlag is 1.
When the tomcat startUp with companyId 03 and storeId 0003
Then the Result Code is 0
Then the emptyResult is []

Scenario: get the right info.
When the tomcat startUp with companyId 01 and storeId 0001
Then the Result Code is 0
Then I should get the PricePromInfo :

|MMNo|ConditionCount1|ConditionCount2|ConditionCount3|ConditionPrice1|ConditionPrice2|ConditionPrice3|DecisionPrice1|DecisionPrice2|DecisionPrice3|AveragePrice1|AveragePrice2|AveragePrice3|Note|Sku|
|1|1|2|3|100.0|100.0|100.0|200.0|200.0|200.0|150.0|150.0|150.0|ëSìX11|11000001|
|1|1|2|3|100.0|100.0|100.0|200.0|200.0|200.0|150.0|150.0|150.0|ëSìX11|11000002|
|1|1|2|3|100.0|100.0|100.0|200.0|200.0|200.0|150.0|150.0|150.0|ëSìX11|1110000*|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 55 stories (of which 0 pending) containing 287 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.42 sec - in ncr.res.mobilepos.pricing.pricemminfo.test.PriceMMTest
Running ncr.res.mobilepos.pricing.promdetailinfo.test.PromDetailListTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/promdetailinfo/test/prom_detail_list_test.scenario

(ncr/res/mobilepos/pricing/promdetailinfo/test/prom_detail_list_test.scenario)
Scenario: test PricePromInfo.
Using timeout for story prom_detail_list_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/pricing/promdetailinfo/test/data_promDetail.xml

Scenario: can not get the info from DB.
When get the pricePromInfo with sku 20000001 dpt 100 line 99
Then the Result Code is 0
Then the emptyResult is null

Scenario: when the PromotionType is 1, dpt != null and dpt is right.
When get the pricePromInfo with sku 11000001 dpt 393 line 01
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|DiscountClass|DiscountRate|DiscountAmt|
|0001|1|10.0|0|


Scenario: when the PromotionType is 2, line != null and line is right.
When get the pricePromInfo with sku 11000005 dpt null line 05
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|DiscountClass|DiscountRate|DiscountAmt|
|0001|1|20.0|0|


Scenario: sku not exist in db
When get the pricePromInfo with sku null dpt 394 line 06
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|DiscountClass|DiscountRate|DiscountAmt|
|0001|1|10.0|0|


Scenario: when the PromotionType is 3, pricePromSku not contains "*"
When get the pricePromInfo with sku 11000008 dpt null line 06
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|DiscountClass|DiscountRate|DiscountAmt|
|0001|1|30.0|0|


Scenario: when the PromotionType is 3, pricePromSku contains "*"
When get the pricePromInfo with sku 11100008 dpt null line 06
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|DiscountClass|DiscountRate|DiscountAmt|
|0001|1|40.0|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 56 stories (of which 0 pending) containing 294 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.215 sec - in ncr.res.mobilepos.pricing.promdetailinfo.test.PromDetailListTest
Running ncr.res.mobilepos.pricing.promdetailinfo.test.PromDetailTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/promdetailinfo/test/prom_detail_test.scenario

(ncr/res/mobilepos/pricing/promdetailinfo/test/prom_detail_test.scenario)
Scenario: test PricePromInfo.
Using timeout for story prom_detail_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/pricing/promdetailinfo/test/data_promDetail.xml

Scenario: COMPANYID exist but STOREID not exist.
When the tomcat startUp with companyId 01 and storeId null
Then the Result Code is 2

Scenario: STOREID exist but COMPANYID not exist.
When the tomcat startUp with companyId null and storeId 0001
Then the Result Code is 2

Scenario: Business date is not set.
When the tomcat startUp with companyId 02 and storeId 0002
Then the Result Code is 2

Scenario: can't find rigth info because deleteFlag is 1.
When the tomcat startUp with companyId 03 and storeId 0003
Then the Result Code is 0
Then the emptyResult is []

Scenario: get the right info.
When the tomcat startUp with companyId 01 and storeId 0001
Then the Result Code is 0
Then I should get the PricePromInfo :

|PromotionNo|PromotionName|PromotionType|BrandFlag|Dpt|Line|Class|Sku|DiscountClass|DiscountRate|DiscountAmt|BrandId|
|0001|ëSìX11DeleteFlag0|3|0|394|06|39301|null|1|30.0|0|null|
|0001|ëSìX11DeleteFlag0|3|0|394|07|39301|1110000*|1|40.0|0|null|
|0001|ëSìX11DeleteFlag0|3|0|394|08|39301|11000008|1|30.0|0|null|
|0001|ëSìX11DeleteFlag0|2|0|394|null|39301|11000004|1|20.0|0|null|
|0001|ëSìX11DeleteFlag0|2|0|394|05|39301|11000005|1|20.0|0|null|
|0001|ëSìX11DeleteFlag0|1|0|null|02|39301|11000002|1|10.0|0|null|
|0001|ëSìX11DeleteFlag0|1|0|393|01|39301|11000001|1|10.0|0|null|
|0001|ëSìX11DeleteFlag0|1|0|394|03|39301|11000003|1|10.0|0|null|
|0003|ëSìX13DeleteFlag0WeekFlag1|1|0|393|01|39301|13000001|1|30.0|0|null|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 57 stories (of which 0 pending) containing 300 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.433 sec - in ncr.res.mobilepos.pricing.promdetailinfo.test.PromDetailTest
Running ncr.res.mobilepos.pricing.resource.test.GetBarcodeAssignmentTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/resource/test/get_barcode_assignment_test.scenario

(ncr/res/mobilepos/pricing/resource/test/get_barcode_assignment_test.scenario)
Scenario: Get Barcode Format for Multi Forward/Recall Card
Given I have Item resource
Given ItemCode.xml file exist
When I get barcode info
Then I should get the following:

|id|description|type|format|
|multiForwardRecallCard|É}ÉãÉ`ÉTÉXÉyÉìÉhÉJÅ[ÉhÇÃÉoÅ[ÉRÅ[Éhå`éÆ|single|[^[Bb](\d{4})[Aa]$]|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 58 stories (of which 0 pending) containing 301 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.679 sec - in ncr.res.mobilepos.pricing.resource.test.GetBarcodeAssignmentTest
Running ncr.res.mobilepos.pricing.resource.test.GetItemsPriceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/resource/test/get_items_price_test.scenario

(ncr/res/mobilepos/pricing/resource/test/get_items_price_test.scenario)
Scenario: Get Item Price (Single Sale)
Given entries for item_price in database
Given I have Item resource
Using timeout for story get_items_price_test.scenario of 300 secs.
When I get item by plu using 01 0247 2017-02-28 ({"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2017-02-28T23:37:17","Status":"","EndDateTime":"2017-02-28T23:37:17","Sales": [{"ItemID":"0000906082902"}]})
Then I should get the following:

|actualprice|
|24000.0|

When I get item by plu using 01 0247 2017-02-28 ({"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2017-02-28T23:37:17","Status":"","EndDateTime":"2017-02-28T23:37:17","Sales": [{"ItemID":"0000906086610"}]})
Then I should get the following:

|actualprice|
|23000.0|


Scenario: Get Item Price (Multiple Sale)
When I get item by plu using 01 0247 2017-02-28 ({"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2017-02-28T23:37:17","Status":"","EndDateTime":"2017-02-28T23:37:17","Sales": [{"ItemID":"0000906082902"}, {"ItemID":"0000906086610"}]})
Then I should get the following:

|actualprice|
|24000.0|
|23000.0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 59 stories (of which 0 pending) containing 303 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.738 sec - in ncr.res.mobilepos.pricing.resource.test.GetItemsPriceTest
Running ncr.res.mobilepos.pricing.resource.test.GetPicklistTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0.001 sec - in ncr.res.mobilepos.pricing.resource.test.GetPicklistTest
Running ncr.res.mobilepos.pricing.resource.test.ItemResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/pricing/resource/test/item_resource_test.scenario

(ncr/res/mobilepos/pricing/resource/test/item_resource_test.scenario)
Scenario: Get Price
Using timeout for story item_resource_test.scenario of 300 secs.
Given entries for items in database
Given I have Item resource
!-- Success getting of item (5000)
When I get item by plu using 000031 8888884456992 0 2017-02-28
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>8888884456992</ItemID><Department>0130</Department><Description><en>sample product 1</en><ja>ÉTÉìÉvÉãêªïi1</ja></Description><RegularSalesUnitPrice>4000.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>4000.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>5</TaxRate><TaxType>1</TaxType><DiscountType>1</DiscountType><SubNum1>1</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><Line>0130</Line><MdType>00</MdType><HostFlag>1</HostFlag><SalesNameSource>2</SalesNameSource><Md02>000</Md02><Md03>035</Md03><Md04>000</Md04><Md05>7200</Md05><Md06>5</Md06><Md07>004099</Md07><Md08>0000000000</Md08><Md09>04208711</Md09><Md10>21111</Md10><Md11>1</Md11><Md12>1</Md12><Md13>0</Md13><Md14>0</Md14><Md15>0</Md15><Md16>2</Md16><MdNameLocal>ÉTÉìÉvÉãêªïi1</MdNameLocal><MdName>sample product 1</MdName><MdKanaName>FIGARO H3 W3</MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1>0</SubCode1><SubCode2>1</SubCode2><SubCode3>01</SubCode3><SubNum2>1</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><SalesPriceFrom>0</SalesPriceFrom><OldPrice>0.0</OldPrice><CostPrice1>5000.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1>0415</Conn1><Conn2>0000</Conn2><PluPrice>4000.0</PluPrice><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><Class>000004</Class><AgeRestrictedFlag>-1</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01>010</Md01><PSType></PSType><OrgSalesPrice1>10000.0</OrgSalesPrice1><BrandSaleName></BrandSaleName><pluSubNum1>1</pluSubNum1></Item></SearchedProduct>
When I get item by plu using 000031 8865545775621 0 2017-02-08
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>8865545775621</ItemID><Department>0143</Department><Description><en>sample product 2</en><ja>ÉTÉìÉvÉãêªïi2</ja></Description><RegularSalesUnitPrice>1000.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>1000.0</ActualSalesUnitPrice><Discountable>true</Discountable><TaxRate>5</TaxRate><TaxType>0</TaxType><DiscountType>0</DiscountType><SubNum1>1</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><Line>0143</Line><MdType>00</MdType><HostFlag>1</HostFlag><SalesNameSource>2</SalesNameSource><Md02>000</Md02><Md03>035</Md03><Md04>000</Md04><Md05>7200</Md05><Md06>5</Md06><Md07>004099</Md07><Md08>0000000000</Md08><Md09>04208711</Md09><Md10>21111</Md10><Md11>1</Md11><Md12>1</Md12><Md13>0</Md13><Md14>0</Md14><Md15>0</Md15><Md16>2</Md16><MdNameLocal>ÉTÉìÉvÉãêªïi2</MdNameLocal><MdName>sample product 2</MdName><MdKanaName>FIGARO H3 W3</MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1>0</SubCode1><SubCode2>1</SubCode2><SubCode3>01</SubCode3><SubNum2>1</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><SalesPriceFrom>0</SalesPriceFrom><OldPrice>0.0</OldPrice><CostPrice1>5000.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1>0415</Conn1><Conn2>0000</Conn2><PluPrice>1000.0</PluPrice><MdVender>NULL</MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><Class>000001</Class><AgeRestrictedFlag>-1</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01>010</Md01><PSType></PSType><OrgSalesPrice1>10000.0</OrgSalesPrice1><BrandSaleName></BrandSaleName><pluSubNum1>1</pluSubNum1></Item></SearchedProduct>
!-- Get Item by PLU code from enterprise store key "0" of unknown storeid
When I get item by plu using 000032 0000000000001 0 2017-02-28
Then I should have item with promo values null, 0, 0, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>0000000000001</ItemID><Department>0130</Department><Description><en>general product 1</en><ja>àÍî ìIÇ»êªïiÇÃ1</ja></Description><RegularSalesUnitPrice>4000.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>4000.0</ActualSalesUnitPrice><Discountable>true</Discountable><TaxRate>5</TaxRate><TaxType>0</TaxType><DiscountType>0</DiscountType><SubNum1>1</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><Line>0130</Line><MdType>00</MdType><HostFlag>1</HostFlag><SalesNameSource>2</SalesNameSource><Md02>000</Md02><Md03>035</Md03><Md04>000</Md04><Md05>7200</Md05><Md06>5</Md06><Md07>004099</Md07><Md08>0000000000</Md08><Md09>04208711</Md09><Md10>21111</Md10><Md11>1</Md11><Md12>1</Md12><Md13>0</Md13><Md14>0</Md14><Md15>0</Md15><Md16>2</Md16><MdNameLocal>àÍî ìIÇ»êªïiÇÃ1</MdNameLocal><MdName>general product 1</MdName><MdKanaName>FIGARO H3 W3</MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1>0</SubCode1><SubCode2>1</SubCode2><SubCode3>01</SubCode3><SubNum2>1</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><SalesPriceFrom>0</SalesPriceFrom><OldPrice>0.0</OldPrice><CostPrice1>5000.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1>0415</Conn1><Conn2>0000</Conn2><PluPrice>4000.0</PluPrice><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><Class>000004</Class><AgeRestrictedFlag>-1</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01>010</Md01><PSType></PSType><OrgSalesPrice1>10000.0</OrgSalesPrice1><BrandSaleName></BrandSaleName><pluSubNum1>1</pluSubNum1></Item></SearchedProduct>
!-- Get non-existing item, Device not found, Pricing is normal
When I get item by plu using 000033 8888884456992 0001 2017-02-28
Then I should get resultcode 801
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>8888884456992</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>
!-- Get existing item, Device not found, Pricing is normal
When I get item by plu using 000033 0000000000001 0 2017-02-28
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>0000000000001</ItemID><Department>0130</Department><Description><en>general product 1</en><ja>àÍî ìIÇ»êªïiÇÃ1</ja></Description><RegularSalesUnitPrice>4000.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>4000.0</ActualSalesUnitPrice><Discountable>true</Discountable><TaxRate>5</TaxRate><TaxType>0</TaxType><DiscountType>0</DiscountType><SubNum1>1</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><Line>0130</Line><MdType>00</MdType><HostFlag>1</HostFlag><SalesNameSource>2</SalesNameSource><Md02>000</Md02><Md03>035</Md03><Md04>000</Md04><Md05>7200</Md05><Md06>5</Md06><Md07>004099</Md07><Md08>0000000000</Md08><Md09>04208711</Md09><Md10>21111</Md10><Md11>1</Md11><Md12>1</Md12><Md13>0</Md13><Md14>0</Md14><Md15>0</Md15><Md16>2</Md16><MdNameLocal>àÍî ìIÇ»êªïiÇÃ1</MdNameLocal><MdName>general product 1</MdName><MdKanaName>FIGARO H3 W3</MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1>0</SubCode1><SubCode2>1</SubCode2><SubCode3>01</SubCode3><SubNum2>1</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><SalesPriceFrom>0</SalesPriceFrom><OldPrice>0.0</OldPrice><CostPrice1>5000.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1>0415</Conn1><Conn2>0000</Conn2><PluPrice>4000.0</PluPrice><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><Class>000004</Class><AgeRestrictedFlag>-1</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01>010</Md01><PSType></PSType><OrgSalesPrice1>10000.0</OrgSalesPrice1><BrandSaleName></BrandSaleName><pluSubNum1>1</pluSubNum1></Item></SearchedProduct>
!-- Get existing item, Device is set as enterprise pricing(storeid=0), Pricing is normal
When I get item by plu using 0 0000000000001 0 2017-02-28
Then I should have item with promo values null, 0, 0, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>0000000000001</ItemID><Department>0130</Department><Description><en>general product 1</en><ja>àÍî ìIÇ»êªïiÇÃ1</ja></Description><RegularSalesUnitPrice>4000.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>4000.0</ActualSalesUnitPrice><Discountable>true</Discountable><TaxRate>5</TaxRate><TaxType>0</TaxType><DiscountType>0</DiscountType><SubNum1>1</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><Line>0130</Line><MdType>00</MdType><HostFlag>1</HostFlag><SalesNameSource>2</SalesNameSource><Md02>000</Md02><Md03>035</Md03><Md04>000</Md04><Md05>7200</Md05><Md06>5</Md06><Md07>004099</Md07><Md08>0000000000</Md08><Md09>04208711</Md09><Md10>21111</Md10><Md11>1</Md11><Md12>1</Md12><Md13>0</Md13><Md14>0</Md14><Md15>0</Md15><Md16>2</Md16><MdNameLocal>àÍî ìIÇ»êªïiÇÃ1</MdNameLocal><MdName>general product 1</MdName><MdKanaName>FIGARO H3 W3</MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1>0</SubCode1><SubCode2>1</SubCode2><SubCode3>01</SubCode3><SubNum2>1</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><SalesPriceFrom>0</SalesPriceFrom><OldPrice>0.0</OldPrice><CostPrice1>5000.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1>0415</Conn1><Conn2>0000</Conn2><PluPrice>4000.0</PluPrice><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><Class>000004</Class><AgeRestrictedFlag>-1</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01>010</Md01><PSType></PSType><OrgSalesPrice1>10000.0</OrgSalesPrice1><BrandSaleName></BrandSaleName><pluSubNum1>1</pluSubNum1></Item></SearchedProduct>

Scenario: Item Query (Not Normal Pricing)
Given entries for prm_system_config_with_tax_rate_round_up_not_normal_pricing in database
Given I have Item resource
Given entries for items in database
Given entries for departments in database
!-- Get an item, Device is not set to normal pricing, Get plucode only
When I get item by plu using 000031 8888884456992 0002 2017-02-28
Then I should have item with promo values null, null, null, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>0</NCRWSSResultCode><Item><ItemID>8888884456992</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>

Scenario: Get Item By Plu (If No Item's Description, Use Item's DPT Description) [RES-2996]
Given entries for prm_system_config_with_tax_rate_round_up_normal_pricing in database
Given I have Item resource
Given entries for items in database
Given entries for departments in database
!-- (If Item's Dpt Name Found, Use it as Item's Description)
When I get item by plu using 000032 0000000000003 0001 2017-02-28
Then I should have item with promo values null, null, null, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>0000000000003</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>
!-- (If Item's Dpt Not Found, Return an Empty String)
When I get item by plu using 000032 0000000000004 0001 2017-02-28
Then I should have item with promo values null, null, null, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>0000000000004</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>
!-- (If Item's Dpt is Null, Return an Empty String)
When I get item by plu using 000032 0000000000005 0001 2017-02-28
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>0000000000005</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>
!-- (If Item's Dpt is Empty, Return an Empty String)
When I get item by plu using 000032 0000000000006 0001 2017-02-28
Then I should have item with promo values null, null, null, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>0000000000006</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>
!-- (If Item's Description is Found, Use it as Item's Description)
When I get item by plu using 000032 0000000000007 0001 2017-02-28
Then I should have item with promo values null, null, null, 0, 0
Then I should have a xml for item:
<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SearchedProduct><NCRWSSExtendedResultCode>0</NCRWSSExtendedResultCode><NCRWSSResultCode>801</NCRWSSResultCode><Item><ItemID>0000000000007</ItemID><RegularSalesUnitPrice>0.0</RegularSalesUnitPrice><Discount>0.0</Discount><DiscountFlag>-1</DiscountFlag><DiscountAmount>0.0</DiscountAmount><ActualSalesUnitPrice>0.0</ActualSalesUnitPrice><Discountable>false</Discountable><TaxRate>0</TaxRate><SubNum1>0</SubNum1><NonSales>0</NonSales><SubInt10>0</SubInt10><MdType></MdType><HostFlag>0</HostFlag><Md02></Md02><Md03></Md03><Md04></Md04><Md05></Md05><Md06></Md06><Md07></Md07><Md08></Md08><Md09></Md09><Md10></Md10><Md11></Md11><Md12></Md12><Md13></Md13><Md14></Md14><Md15></Md15><Md16></Md16><MdNameLocal></MdNameLocal><MdName></MdName><MdKanaName></MdKanaName><SalesPrice2>0.0</SalesPrice2><PaymentType>0</PaymentType><SubCode1></SubCode1><SubCode2></SubCode2><SubCode3></SubCode3><SubNum2>0</SubNum2><DiacountRate>0.0</DiacountRate><DiscountAmt>0</DiscountAmt><ReplaceSupportDiscountAmt>0</ReplaceSupportDiscountAmt><DiscountClass>0</DiscountClass><UnitPrice>0.0</UnitPrice><IssueCount>0</IssueCount><TargetPrice>0.0</TargetPrice><TargetCount>0</TargetCount><OldPrice>0.0</OldPrice><CostPrice1>0.0</CostPrice1><MakerPrice>0.0</MakerPrice><Conn1></Conn1><Conn2></Conn2><PluPrice>0.0</PluPrice><MdVender></MdVender><RuleQuantity1>0</RuleQuantity1><RuleQuantity2>0</RuleQuantity2><RuleQuantity3>0</RuleQuantity3><ConditionPrice1>0.0</ConditionPrice1><ConditionPrice2>0.0</ConditionPrice2><ConditionPrice3>0.0</ConditionPrice3><AveragePrice1>0.0</AveragePrice1><AveragePrice2>0.0</AveragePrice2><AveragePrice3>0.0</AveragePrice3><AgeRestrictedFlag>0</AgeRestrictedFlag><EventId></EventId><EventName></EventName><eventSalesPrice>0.0</eventSalesPrice><EmpPrice1>0.0</EmpPrice1><Md01></Md01><PSType></PSType><OrgSalesPrice1>0.0</OrgSalesPrice1><pluSubNum1></pluSubNum1><lineInfoSubNum1></lineInfoSubNum1><dptSubNum5></dptSubNum5><classInfoSubNum1></classInfoSubNum1></Item></SearchedProduct>



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 60 stories (of which 0 pending) containing 306 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.73 sec - in ncr.res.mobilepos.pricing.resource.test.ItemResourceTest
Running ncr.res.mobilepos.promotion.discount.test.ItemEntryAutoDiscountTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/discount/test/item_entry_auto_discount_test.scenario

(ncr/res/mobilepos/promotion/discount/test/item_entry_auto_discount_test.scenario)
Scenario: Test Item Entry with Automatic Discount with Tax Rate.
When the Web API Starts Up with test/ncr/res/mobilepos/promotion/discount/test/prm_system_config_12taxrate_roundup.xml System Configuration
Using timeout for story item_entry_auto_discount_test.scenario of 300 secs.
Given a Promotion Service
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/data_items.xml

Scenario: Item Entry with No begin Transaction
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {"ItemEntryID":"00001","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 1102

Scenario: Item Entry with no retail store id
When a Item Entry at promotion with parameters RetailStoreID {} WorkStationId 1111 SequenceNo 1 TransactionJson {"ItemEntryID":"00001","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154

Scenario: Item Entry with no workstation id
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId {} SequenceNo 1 TransactionJson {"ItemEntryID":"00001","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154

Scenario: Item Entry with no sequence number
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo {} TransactionJson {"ItemEntryID":"00001","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154

Scenario: Item Entry with no transaction
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154

Scenario: Item Entry with Invalid Transaction 1
When a Begin Transaction at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson asdas CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154

Scenario: Item Entry with Invalid Transaction 2
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with No begin Transaction (other device)
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1112 SequenceNo 1 TransactionJson {"ItemEntryID":"00001","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 1102

Scenario: Item Entry Empty ItemEntryId
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {"Sale":{"ItemEntryID":"","ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry No ItemEntryId
When a Item Entry at promotion with parameters RetailStoreID 0031 WorkStationId 1111 SequenceNo 1 TransactionJson {"Sale":{"ItemID":"5957669206754","ItemIDType":"EAN-13","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}
!-- ITEM ENTRIES WITH DISCOUNT AMOUNT

Scenario: Item Entry with Auto Discount amount
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"5957669206754","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|5957669206754|EAN-13|1|0397||ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|7398.0|1|30.0|0|7398.0|7398.0|


Scenario: Item Entry with Auto Discount amount (multiple quantity)
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"5957669206754","ItemIDType":"EAN13","Department":"","Quantity":3}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|5957669206754|EAN-13|3|0397||ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|7398.0|1|30.0|0|7398.0|22194.0|


Scenario: Item Entry with auto discount amount (single quantity, but not discountable)
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"6765545775555","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|6765545775555|EAN-13|1|0397|iRobot|ÉAÉCÉçÉ{ÉbÉg|54000.0|0|0.0|500|54000.0|54000.0|


Scenario: Item Entry with auto discount amount (multiple quantity, but not discountable)
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"6765545775555","ItemIDType":"EAN13","Department":"","Quantity":2}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|6765545775555|EAN-13|2|0397|iRobot|ÉAÉCÉçÉ{ÉbÉg|54000.0|0|0.0|500|54000.0|108000.0|

!-- ITEM ENTRIES WITH AUTO DISCOUNT RATE

Scenario: Item Entry with Auto Discount Rate
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"7957669622196","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|7957669622196|EAN-13|1|0397||ÇlÇiÇqÇnÇxÇ`Çk ÇaÇjÇSÇUÇT|120000.0|1|30.0|0|120000.0|120000.0|


Scenario: Item Entry with Auto Discount Rate (multiple quantity)
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"7957669622196","ItemIDType":"EAN13","Department":"","Quantity":2}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|7957669622196|EAN-13|2|0397||ÇlÇiÇqÇnÇxÇ`Çk ÇaÇjÇSÇUÇT|120000.0|1|30.0|0|120000.0|240000.0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 61 stories (of which 0 pending) containing 323 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.98 sec - in ncr.res.mobilepos.promotion.discount.test.ItemEntryAutoDiscountTest
Running ncr.res.mobilepos.promotion.discount.test.ItemEntryAutoDiscountWithPriceOverrideTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/discount/test/item_entry_auto_discount_with_price_override_test.scenario

(ncr/res/mobilepos/promotion/discount/test/item_entry_auto_discount_with_price_override_test.scenario)
Scenario: Test Item Entry with Automatic Discount with Price Override.
When the Web API Starts Up with test/ncr/res/mobilepos/promotion/discount/test/prm_system_config_12taxrate_roundup.xml System Configuration
Using timeout for story item_entry_auto_discount_with_price_override_test.scenario of 300 secs.
Given a Promotion Service
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/data_items.xml
!-- ITEM ENTRIES WITH DISCOUNT AMOUNT (WITH 12% TAX RATE)

Scenario: Item Entry Of Price Overridden Auto Discount Amt (7398.0 to 5000.0)
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"5957669206754","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":5000}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|5957669206754|EAN-13|1|0397||ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|7398.0|1|30.0|0|7398.0|7398.0|


Scenario: Item Entry Of Price Overridden Auto Discount Amt (StoreId and TerminalId in 6 Digits)
When a Begin Transaction at promotion with parameters RetailStoreID 123456 WorkStationId 123456 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"5957669206754","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":5000}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then Sale data should be :

|ItemEntryID|ItemID|ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|DiscountType|DiacountRate|DiscountAmt|ActualSalesUnitPrice|ExtendedAmount|
|1|5957669206754|EAN-13|1|0397||ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|7398.0|1|30.0|0|7398.0|7398.0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 62 stories (of which 0 pending) containing 326 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.05 sec - in ncr.res.mobilepos.promotion.discount.test.ItemEntryAutoDiscountWithPriceOverrideTest
Running ncr.res.mobilepos.promotion.discount.test.ItemEntryVarietiesTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/discount/test/item_entry_varieties_test.scenario

(ncr/res/mobilepos/promotion/discount/test/item_entry_varieties_test.scenario)
Scenario: Test Item Entry with Item Varieties.
When the Web API Starts Up with test/ncr/res/mobilepos/promotion/discount/test/prm_system_config_unreachable_enterprise.xml System Configuration
Using timeout for story item_entry_varieties_test.scenario of 300 secs.
Given a Promotion Service
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/data_items.xml
When a Begin Transaction at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"} CompanyId 01

Scenario: ItemCode.xml file does not exist.
Given ItemCode.xml file does not exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0259852147999 4054965205478","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 133
Then the Extended Result Code is 133
!-- ITEM ENTRIES WITH FOREIGNJANBOOK

Scenario: Item Entry with ForeignJanBook(itemName from MST_PLU_NAME, taxType and price from MST_PLU)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0259852147360 4458963205478","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇfÇqÇeÉoÉXÉPÉbÉgÉ{Å[ÉãÉIÉìÉäÅ[|0|5200.0|5200.0|ÇfÇqÇeÉoÉXÉPÉbÉgÉ{Å[ÉãÉIÉìÉäÅ[|123456789|21111|


Scenario: Item Entry with ForeignJanBook(itemName and price from MST_PLU, taxType from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0259852147999 4054965205478","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇlÉeÉjÉXÉpÉìÉc|0|2800.0|2800.0|ÇlÉeÉjÉXÉpÉìÉc|123456789|21111|


Scenario: Item Entry with ForeignJanBook(price from MST_PLU, taxType and itemName from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0250052147546 9458967208498","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|0|10000.0|10000.0|ÇkÉoÉâÉEÉbÉh|123456789|21111|


Scenario: Item Entry with ForeignJanBook(Not exist in MST_PLU)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0251092187546 1984963205000","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: Item Entry with ForeignJanBook(DptCode not exist)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0258881237777 1902013205020","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180
!-- ITEM ENTRIES WITH BOOKCENTER

Scenario: Item Entry with BOOKCENTER(itemName from MST_PLU_NAME, taxType and price from MST_PLU)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0201234567890","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇrÇkÇhÇoÇoÇdÇqÅ@ÇbÇgÇtÇjÇjÇ`Çb|1|880.0|880.0|ÇrÇkÇhÇoÇoÇdÇqÅ@ÇbÇgÇtÇjÇjÇ`Çb|123456789|21111|


Scenario: Item Entry with BOOKCENTER(itemName and price from MST_PLU, taxType from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0278154696210","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇcÇ`ÇvÇmÅ@ÇoÇ`ÇsÇqÇnÇkÅ@ÇrÇkÇh|0|9999.0|9999.0|ÇcÇ`ÇvÇmÅ@ÇoÇ`ÇsÇqÇnÇkÅ@ÇrÇkÇh|123456789|21111|


Scenario: Item Entry with BOOKCENTER(price from MST_PLU, taxType and itemName from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0219234980254","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|0|456.0|456.0|ÇkÉoÉâÉEÉbÉh|123456789|21111|


Scenario: Item Entry with BOOKCENTER(Not exist in MST_PLU, to error status)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","OperatorType":2,"Sale":{"ItemEntryID":1,"ItemID":"0281014565478","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: Item Entry with BOOKCENTER(DptCode not exist)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0200014587412","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180
!-- ITEM ENTRIES WITH JANSALES

Scenario: Item Entry with JANSALES(itemName from MST_PLU_NAME, taxType and price from MST_PLU)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"151693852476","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇVÇsÇSÇOÇfÅ@ÇgÇ`ÇqÇqÇhÇdÇqÅ@ÇP|2|2180.0|2180.0|ÇVÇsÇSÇOÇfÅ@ÇgÇ`ÇqÇqÇhÇdÇqÅ@ÇP|123456789|21111|


Scenario: Item Entry with JANSALES(itemName and price from MST_PLU, taxType from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"66012580","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇaÇnÇgÇnÅ@ÇrÇmÇdÇ`ÇjÅ@ÇkÇdÇ`Çs|0|11350.0|11350.0|ÇaÇnÇgÇnÅ@ÇrÇmÇdÇ`ÇjÅ@ÇkÇdÇ`Çs|123456789|21111|


Scenario: Item Entry with JANSALES(price from MST_PLU, taxType and itemName from MST_DPTINFO)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9908817563241","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|0|6360.0|6360.0|ÇkÉoÉâÉEÉbÉh|123456789|21111|


Scenario: Item Entry with JANSALES(price = 0)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9908817563242","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: Item Entry with JANSALES(Not exist in MST_PLU, to error status)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","OperatorType":1,"Sale":{"ItemEntryID":1,"ItemID":"18134556","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: Item Entry with JANSALES(DptCode not exist)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"2601811","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180
!-- ITEM ENTRIES WITH JANBOOK

Scenario: The two section id four below
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784123456789 0026","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|0|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0026|21111|


Scenario: The two section id four below and item is null
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784923456789 0026","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 2
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|ÉeÉXÉgÅ[è§ïiñºëO|0|9784923456789|0397|0|0|1|8|0|0|0.0|0.0|0026|0.0|null|21111|


Scenario: The two section id four below(Department number is empty)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784923456789 0038","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: Department number is empty String(janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784987654322 1910039567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 801
Then the Result Code is 801

Scenario: No corresponding department number(janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784987654321 1910039567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: Plu no corresponding commodity taxType = 1(janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784987654321 1910029567890","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|MJROYAL BK465|MJROYAL BK465|1|9784987654321|1234|0|0|1|8|0|0|59545.0|59545.0|0029|59545.0|null|21111|


Scenario: Plu no corresponding commodity(janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784987654321 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|0|9784987654321|0397|0|0|1|8|0|0|55135.0|55135.0|0026|55135.0|null|21111|


Scenario: Item Entry Of get itemInfo Plu_Name in MdName is empty(janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784123456789 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|0|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Commodity price is 0 and Plu_Name in MdName is not empty (janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784123456780 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|55135.0|55135.0|0|MJROYAL BK465|MJROYAL BK465|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Plu in MdNameLocal is empty and Plu_Name in MdName is empty (janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784123456781 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|0|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Plu in TaxType is empty (janBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9784123456700 1910036567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|5|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0036|21111|

!-- ITEM ENTRIES WITH FOREIGNBOOK

Scenario: No corresponding department number(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783987654321 1910038567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: Plu no corresponding commodity(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783987654321 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|MJROYAL BK465|MJROYAL BK465|5|9783987654321|0166|0|0|1|8|0|0|56789.0|56789.0|0026|56789.0|null|21111|


Scenario: Department number is empty String(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783987654322 1910039567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 801
Then the Result Code is 801

Scenario: No corresponding department number and Transformation code id 0000(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783987654321 1910000567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: No corresponding department number and Transformation code id 0403(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783987654321 1910403567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: Item Entry Of get itemInfo Plu_Name in MdName is empty(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783123456789 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|0|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Commodity price is 0 and Plu_Name in MdName is not empty (foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783123456780 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|56789.0|56789.0|0|MJROYAL BK465|MJROYAL BK465|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Plu in MdNameLocal is empty and Plu_Name in MdName is empty (foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783123456781 1910026567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|0|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|123456789|0026|21111|


Scenario: Item Entry Of get itemInfo Plu in TaxType is empty (foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9783123456700 1910036567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|5|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0036|21111|


Scenario: Item Entry Of get itemInfo Plu in TaxType is empty ItemId top three 979(foreignBook)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"9793123456700 1910036567890","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|CategoryCode|dptSubCode1|
|10000.0|10000.0|5|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|0036|21111|

!-- ITEM ENTRIES WITH JANMAGAZINE

Scenario: No corresponding department number(janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491233636112345678","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: Department number is empty String(janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636012345876","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 801
Then the Result Code is 801

Scenario: Item Entry Of get itemInfo Plu_Name in MdName is empty(janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636011145678","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|MagazineCode|dptSubCode1|
|10000.0|10000.0|0|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|49122|21111|


Scenario: Item Entry Of get itemInfo Commodity price is 0 and Plu_Name in MdName is not empty (janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636022245679","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|MagazineCode|dptSubCode1|
|5679.0|5679.0|0|MJROYAL BK465|MJROYAL BK465|123456789|49122|21111|


Scenario: Item Entry Of get itemInfo Plu in MdNameLocal is empty and Plu_Name in MdName is empty (janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636033345689","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|MagazineCode|dptSubCode1|
|10000.0|10000.0|0|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|123456789|49122|21111|


Scenario: Item Entry Of get itemInfo Plu in TaxType is empty (janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636044445600","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then result should be : 

|RegularSalesPrice|ActualSalesPrice|TaxType|MdNameLocal|description|PublishingCode|MagazineCode|dptSubCode1|
|10000.0|10000.0|5|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|ÇeÇhÇfÇ`ÇqÇn ÇgÇR ÇvÇR|123456789|49122|21111|


Scenario: Plu no corresponding commodity(janMagazine)
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"491223636212345678","ItemIDType":"EAN13","Department":"","Quantity":1,"ActualSalesUnitPrice":0}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|0|4912236362123|0397|0|0|1|8|0|0|5678.0|5678.0|null|5678.0|49122|21111|

!-- Test Item Entry with FOREIGNMAGAZINE.

Scenario: get the new itemId with CDCalculation
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234560161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then getSaleItemId should be : 0401234560161
Then the Result Code is 0
Then the Extended Result Code is 0

Scenario: can't get the new itemId from PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0402234560161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180

Scenario: The Dpt is empty when we can find the info in PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234610161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: get name from MST_PLU_NAME
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234560161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÉeÉXÉgÅ[äy

Scenario: get name from MST_PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234570161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : oldbookTestlocal1

Scenario: get name from MST_DPTINFO
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234580161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÇkÉoÉâÉEÉbÉh

Scenario: can't get name from everywhere
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234590161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : null

Scenario: the salesPrice1 in PLU is 0
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234600161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the RegularSalesPrice should be : 160.0
Then the ActualSalesPrice should be : 160.0

Scenario: get item message from MST_DPT
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234567891","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|MJROYAL BK465|MJROYAL BK465|5|0401234567891|0161|0|0|1|8|0|0|7890.0|7890.0|null|7890.0|null|21111|


Scenario: Item Entry with normal code
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"0401234560161","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|CategoryCode|dptSubCode1|
|ÉeÉXÉgÅ[äy|0|8888.0|8888.0|ÉeÉXÉgÅ[äy|123456789|0026|21111|

!-- Test Item Entry with FOREIGNBOOKOLD.

Scenario: get the new itemId with CDCalculation
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then getSaleItemId should be : 9783012345673
Then the Result Code is 0
Then the Extended Result Code is 0

Scenario: can't get the new itemId from PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30223456780027","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180

Scenario: The Dpt is empty when we can find the info in PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30323456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: get the codeTemp when cCode is 0000
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30999999990000","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: get the codeTemp when cCode is 040*
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30999999990400","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Extended Result Code is 180
Then the Result Code is 180

Scenario: get the codeTemp when cCode anything except 040*
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30999999990416","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|MJROYAL BK465|MJROYAL BK465|5|9783099999998|0166|0|0|1|8|0|0|0.0|0.0|0416|0.0|null|21111|


Scenario: get name from MST_PLU_NAME
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÉeÉXÉgÅ[äy

Scenario: get name from MST_PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123456880026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : oldbookTestlocal1

Scenario: get name from MST_DPTINFO
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123456980026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÇkÉoÉâÉEÉbÉh

Scenario: can't get name from everywhere
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123457080026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : null

Scenario: Item Entry with normal code
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"30123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|CategoryCode|dptSubCode1|
|ÉeÉXÉgÅ[äy|0|8888.0|8888.0|ÉeÉXÉgÅ[äy|123456789|0026|21111|

!-- Test Item Entry with JANBOOKOLD.

Scenario: get the new itemId with CDCalculation
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then getSaleItemId should be : 9784012345670
Then the Result Code is 0
Then the Extended Result Code is 0

Scenario: can't get the new itemId from PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40223456780028","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 180
Then the Extended Result Code is 180

Scenario: The Dpt is empty when we can find the info in PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 02 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 801
Then the Extended Result Code is 801

Scenario: get the codeTemp from CCODEINFO
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40223456780027","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 02 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then dptResult should be :

|DptName|MdNameLocal|TaxType|ItemId|Dpt|Md11|Md12|Md13|TaxRate|NonSales|DiscountType|RegularSalesPrice|ActualSalesPrice|CategoryCode|LabelPrice|MagazineCode|dptSubCode1|
|ÇkÉoÉâÉEÉbÉh|ÇkÉoÉâÉEÉbÉh|0|9784022345677|3970|0|0|1|8|0|0|0.0|0.0|0027|0.0|null|21111|


Scenario: get name from MST_PLU_NAME
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÉeÉXÉgÅ[äy

Scenario: get name from MST_PLU
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456880026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : oldbookTestlocal1

Scenario: get name from MST_DPTINFO
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456980026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÇkÉoÉâÉEÉbÉh

Scenario: can't get name from everywhere
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123457080026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : null

Scenario: Item Entry with normal code
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456780026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then result should be :

|MdNameLocal|TaxType|RegularSalesPrice|ActualSalesPrice|description|PublishingCode|CategoryCode|dptSubCode1|
|ÉeÉXÉgÅ[äy|0|8888.0|8888.0|ÉeÉXÉgÅ[äy|123456789|0026|21111|


Scenario: Get DptName from MST_DPTINFO when MdName is null
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456980026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the Mdname should be : Çk Balloughwood

Scenario: Get DptNameLocal from MST_DPTINFO when MdNameLocal is null
Given ItemCode.xml file exist
When a Item Entry at promotion with parameters RetailStoreID 0247 WorkStationId 0004 SequenceNo 0101 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"40123456980026","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 1 Businessdate 2016-08-16
Then the Result Code is 0
Then the Extended Result Code is 0
Then the MdNameLocal should be : ÇkÉoÉâÉEÉbÉh



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 63 stories (of which 0 pending) containing 404 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 39.055 sec - in ncr.res.mobilepos.promotion.discount.test.ItemEntryVarietiesTest
Running ncr.res.mobilepos.promotion.discount.test.ItemEntryWithDoubleJanSalesTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/discount/test/item_entry_with_double_jan_sales_test.scenario

(ncr/res/mobilepos/promotion/discount/test/item_entry_with_double_jan_sales_test.scenario)
Scenario: Test Item Entry with Double Jan Sales.
When the Web API Starts Up with test/ncr/res/mobilepos/promotion/discount/test/prm_system_config_unreachable_enterprise.xml System Configuration
Using timeout for story item_entry_with_double_jan_sales_test.scenario of 300 secs.
Given a Promotion Service
When a Begin Transaction at promotion with parameters RetailStoreID 0001 WorkStationId 0001 SequenceNo 0001 TransactionJson {"TransactionMode":"0","OperatorID":"9011011","BeginDateTime":"2016-12-02T04:19:14.0Z"}} CompanyId 01

Scenario: Test Item Entry with Double Jan Sales Normal
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/mst_plu_pluname_sizepatterinfo_classinfo.xml
When a Item Entry at promotion with parameters RetailStoreID 0001 WorkStationId 0001 SequenceNo 0001 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"3078154696210 60000013","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 0 Businessdate 2017-11-11
Then Sale data with double jean sales should be :
|ItemBrandName|ItemSizeCode|SizePatternId|PointAddFlag|PointUseFlag|TaxExemptFlag|DiscountType|DiscountTypeSource|
|01|XXS|A|1|1|1|1|1|


Scenario: Test Item Entry with Double Jan Sales Error
When a Item Entry at promotion with parameters RetailStoreID 0001 WorkStationId 0001 SequenceNo 0001 TransactionJson {"EntryFlag":"false","Sale":{"ItemEntryID":1,"ItemID":"3078154696211 60001111","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 0 Businessdate 2017-11-11
Then the Result Code is 157

Scenario: Test Item Entry with Double Jan Sales Normal No Exist Size Pattern Info
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/no_exist_mst_plu_pluname_sizepatterinfo_classinfo.xml
When a Item Entry at promotion with parameters RetailStoreID 0001 WorkStationId 0001 SequenceNo 0001 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"3078154696210 60000013","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 0 Businessdate 2017-11-11
Then Sale data with double jean sales should be :
|ItemBrandName|ItemSizeCode|SizePatternId|PointAddFlag|PointUseFlag|TaxExemptFlag|DiscountType|DiscountTypeSource|
|01|null|null|1|1|1|1|1|


Scenario: Test DiscountType Item Entry with Double Jan Sales Normal
Given a loaded dataset test/ncr/res/mobilepos/promotion/discount/test/mst_plu_pluname_sizepatterinfo_classinfo_discounttype.xml
When a Item Entry at promotion with parameters RetailStoreID 0001 WorkStationId 0001 SequenceNo 0001 TransactionJson {"EntryFlag":"true","Sale":{"ItemEntryID":1,"ItemID":"3078154696210 60000013","ItemIDType":"EAN13","Department":"","Quantity":1}} CompanyId 01 PriceCheck 0 Businessdate 2017-11-11
Then Sale data with double jean sales should be :
|ItemBrandName|ItemSizeCode|SizePatternId|PointAddFlag|PointUseFlag|TaxExemptFlag|DiscountType|DiscountTypeSource|
|01|XXS|A|1|1|1|2|2|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 64 stories (of which 0 pending) containing 409 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.382 sec - in ncr.res.mobilepos.promotion.discount.test.ItemEntryWithDoubleJanSalesTest
Running ncr.res.mobilepos.promotion.promotionmsginfo.test.PromotionMsgListTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/promotionmsginfo/test/promotion_msg_list_test.scenario

(ncr/res/mobilepos/promotion/promotionmsginfo/test/promotion_msg_list_test.scenario)
Scenario: test PromotionMsgInfo
Using timeout for story promotion_msg_list_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/promotion/promotionmsginfo/test/data_promotionMsg.xml
Given I have PromotionMsg Resource companyid 01 storeid 0247

Scenario: check retailStoreId or workStationId or sequenceNumber or transaction or companyId or businessDate isNullOrEmpty.
When check the list with companyId  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":1000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":2,"Amount":1200,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 154

Scenario: the transaction is wrong.
When check the list with companyId 01 retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Item":[{"itemcode":"111111111111","Qty":1,"Amount":1000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":2,"Amount":1200,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 151

Scenario: promotionMsgInfoList.size() < 1.
Given I have PromotionMsg Resource companyid 03 storeid 0001
When check the list with companyId 03 retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":1000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":2,"Amount":1200,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 0

Scenario: the PromotionType is 1 and Price > MinimumPrice.
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":1000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":2,"Amount":1200,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|XXXXX|


Scenario: the one item hits one promotion message
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":1000,"Dpt":"3333","MdName":"XXXXX"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|XXXXX|


Scenario: the one item hits two promotion message
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":3000,"Dpt":"3333","MdName":"XXXXX"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|XXXXX|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|XXXXX|


Scenario: the two item hits same promotion message
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":3000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":1,"Amount":3000,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|XXXXX|
|222222222222|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|YYYYY|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|XXXXX|


Scenario: same item exists another records hits only one time
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":3000,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":1,"Amount":3000,"Dpt":"3333","MdName":"YYYYY"},{"itemcode":"111111111111","Qty":2,"Amount":6000,"Dpt":"3333","MdName":"XXXXX"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|XXXXX|
|222222222222|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|YYYYY|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|XXXXX|


Scenario: all items amount < minimumprice
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":999,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":1,"Amount":2999,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 0

Scenario: the two items amount >= minimumprice
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"111111111111","Qty":1,"Amount":999,"Dpt":"3333","MdName":"XXXXX"},{"itemcode":"222222222222","Qty":1,"Amount":2001,"Dpt":"3333","MdName":"YYYYY"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|222222222222|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|YYYYY|
|111111111111|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|XXXXX|


Scenario: hits the itemcode by wild card
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"333339999999","Qty":1,"Amount":1000,"Dpt":"0003","MdName":"xxxxx"},{"itemcode":"333330000000","Qty":1,"Amount":1000,"Dpt":"0002","MdName":"yyyyy"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|333339999999|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|xxxxx|
|333330000000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|yyyyy|


Scenario: hits the itemcode by dpt
Given I have PromotionMsg Resource companyid 01 storeid 0247
When check the list with companyId 01  retailstoreid 0247 workstationid 1 sequencenumber 123 businessDate 2017-06-01 transaction {"Items":[{"itemcode":"333339999999","Qty":1,"Amount":1000,"Dpt":"0003","MdName":"xxxxx"},{"itemcode":"333330000000","Qty":1,"Amount":1000,"Dpt":"0001","MdName":"yyyyy"}]}
Then the Result Code is 0
Then I should get the PromotionMsgInfoList : 

|itemCode|MessageBody|MdName|
|333339999999|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|xxxxx|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 65 stories (of which 0 pending) containing 422 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.501 sec - in ncr.res.mobilepos.promotion.promotionmsginfo.test.PromotionMsgListTest
Running ncr.res.mobilepos.promotion.promotionmsginfo.test.PromotionMsgTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/promotionmsginfo/test/promotion_msg_test.scenario

(ncr/res/mobilepos/promotion/promotionmsginfo/test/promotion_msg_test.scenario)
Scenario: test PromotionMsgInfo.
Using timeout for story promotion_msg_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/promotion/promotionmsginfo/test/data_promotionMsg.xml

Scenario: COMPANYID exist but STOREID not exist.
When the tomcat startUp with companyId 01 and storeId null
Then the Result Code is 2

Scenario: STOREID exist but COMPANYID not exist.
When the tomcat startUp with companyId null and storeId 0001
Then the Result Code is 2

Scenario: Business date is not set.
When the tomcat startUp with companyId 02 and storeId 0002
Then the Result Code is 2

Scenario: can't find rigth info because deleteFlag is 1.
When the tomcat startUp with companyId 03 and storeId 0001
Then the Result Code is 0
Then the emptyResult is []

Scenario: get the right info.
When the tomcat startUp with companyId 01 and storeId 0247
Then the Result Code is 0
Then I should get the PromotionMsgInfo :

|RecordId|Subject|MinimunPrice|MessageBody|MdInternal|
|1|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇP|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇP|111111111111|
|4|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇS|3000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|111111111111|
|4|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇS|3000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇS|222222222222|
|8|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇW|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇW|111111111111|
|9|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇX|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇX|111111111111|
|10|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇPÇO|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|111111111111|
|10|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇPÇO|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|222222222222|
|10|É^ÉCÉgÉãÅ@ÇOÇPÅ|ÇPÇO|1000|ÉÅÉbÉZÅ[ÉWÅ@ÇOÇPÅ|ÇPÇO|33333*|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 66 stories (of which 0 pending) containing 428 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.484 sec - in ncr.res.mobilepos.promotion.promotionmsginfo.test.PromotionMsgTest
Running ncr.res.mobilepos.promotion.qrcodeinfo.test.QrCodeListTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/qrcodeinfo/test/qr_code_list_test.scenario

(ncr/res/mobilepos/promotion/qrcodeinfo/test/qr_code_list_test.scenario)
Scenario: test QrCodeInfo when the maxPrintNum = 7.
Using timeout for story qr_code_list_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/promotion/qrcodeinfo/test/data_qrCode.xml

Scenario: check retailStoreId or workStationId or sequenceNumber or transaction or companyId or businessDate isNullOrEmpty.
When check the list with companyId  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"xxxxxxxxxx","rank":"xxxxxxxx","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 154

Scenario: the transaction is wrong.
When check the list with companyId 0001 retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"id":"xxxxxxxxxx","rank":"xxxxxxxx","SexType":1,"birthMonth":"01"}
Then the Result Code is 151

Scenario: qrCodeInfoListTemp.size() < 1.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"xxxxxxxxxx","rank":"xxxxxxxx","SexType":1,"birthMonth":"01"},"Items":[{},{},{}]}
Then the Result Code is 133

Scenario: the PromotionType is 1 and Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 1 and Price > MinimumPrice Customer is null.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0012|ëSìX112type1|100.0|ëSìX112type1|0|1|1|1112|1|


Scenario: the PromotionType is 2 item.getDpt != qrCodeInfo.getDpt.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 2 item.getDpt == qrCodeInfo.getDpt, qrCodeInfo.MemberTargetType = 1, item.Customer.id != memberId.MemberId.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111111","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 2 item.getDpt == qrCodeInfo.getDpt, qrCodeInfo.MemberTargetType = 1, item.Customer.id == memberId.MemberId, have same PromotionId and CompanyId but PromotionDetailNo is different.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"395","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|3|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|1|


Scenario: the PromotionType is 2 item.getDpt == qrCodeInfo.getDpt and Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|1|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|1|


Scenario: the PromotionType is 2 item.getDpt == qrCodeInfo.getDpt,the right Dpt have 2,sumqt = 3, Price > MinimumPrice, outputType = 2.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"394","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|3|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|3|


Scenario: the PromotionType is 2 item.getDpt == qrCodeInfo.getDpt,the right Dpt have 3,sumqt = 5, Price > MinimumPrice, outputType = 2.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"394","Line":"0404","Class":"0221","ConnCode":"xxxx","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"394","Line":"0102","Class":"0503","ConnCode":"xxxx","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|5|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|1|


Scenario: the PromotionType is 3 item.getDpt != qrCodeInfo.getDpt.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":3,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0311","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 3 item.getDpt == qrCodeInfo.getDpt the right Dpt have 2,right connCode have 3,sumqt = 2, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":1,"Amount":840,"Dpt":"394","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|2|
|0006|ëSìX16type3|100.0|ëSìX16type3|0|1|1|1016|1|
|0008|ëSìX18type3|100.0|ëSìX18type3|0|1|2|1018|2|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|1|


Scenario: the PromotionType is 3 item.getDpt == qrCodeInfo.getDpt the right Dpt have 2,right connCode have 3,sumqt = 7, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":3,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"394","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":2,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|5|
|0006|ëSìX16type3|100.0|ëSìX16type3|0|1|1|1016|1|


Scenario: the PromotionType is 3 item.getDpt == qrCodeInfo.getDpt the right Dpt have 2,right connCode have 3,sumqt = 4, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"394","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|3|
|0006|ëSìX16type3|100.0|ëSìX16type3|0|1|1|1016|1|
|0008|ëSìX18type3|100.0|ëSìX18type3|0|1|2|1018|2|


Scenario: the PromotionType is 4 item.getDpt != qrCodeInfo.getDpt
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 4 item.getDpt == qrCodeInfo.getDpt, itemListIn.getBrandId != qrCodeInfo.getBrandId
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"0001","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"0001","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 4 item.getDpt == qrCodeInfo.getDpt, have 1 right brandId but outputTargetValue = null, outputType = 3, sumqt = 0, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|1|


Scenario: the PromotionType is 4 item.getDpt == qrCodeInfo.getDpt, have 1 right brandId and outputTargetValue is not empty, outputType = 3, sumqt = priceSum / outputTargetValue, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"394","Line":"0002","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0002|ëSìX12type2|100.0|ëSìX12type2|0|1|2|1012|1|
|0011|ëSìX111type2|100.0|ëSìX111type2|0|1|2|1111|1|


Scenario: the PromotionType is 5, itemListIn.getLine() == null, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":1,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|


Scenario: the PromotionType is 5, itemListIn.getLine() == qrCodeInfo.getLine() and have 1 right line, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001002384", "Qty":2,"Amount":1000,"Dpt":"0011","Line":"0005","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920041002384", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0010","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4923304402621", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0011","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0005|ëSìX15type5|100.0|ëSìX15type5|0|1|2|1015|2|


Scenario: the PromotionType is 6, have 1 matched qrCodeSku, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001001230", "Qty":6,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920001001231", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4920001001232", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0007|ëSìX17type6|100.0|ëSìX17type6|0|1|2|1017|6|


Scenario: the PromotionType is 6, qrCodeSku contain *, sumquty = 9, Price > MinimumPrice.
When check the list with companyId 01  retailstoreid 0001 workstationid 1 sequencenumber 123 businessDate 20150102 transaction {"CustomerClass":{"SexType": 1},"Customer":{"id":"11111111111110","rank":"1","SexType":1,"birthMonth":"01"},"Items":[{"itemcode":"4920001009991", "Qty":6,"Amount":1000,"Dpt":"0011","Line":"0002","Class":"0003","ConnCode":"null","BrandId":"00001"},{"itemcode":"4920001009992", "Qty":2,"Amount":840,"Dpt":"0411","Line":"0404","Class":"0221","ConnCode":"null","BrandId":"xxxxx"},{"itemcode":"4920001009993", "Qty":1,"Amount":400,"Dpt":"0041","Line":"0102","Class":"0503","ConnCode":"null","BrandId":"xxxxx"}]}
Then the Result Code is 0
Then I should get the QrCodeInfoList : 

|PromotionId|PromotionName|MinimumPrice|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|TargetValue|Quantity|
|0001|ëSìX11type1|100.0|ëSìX11type1|0|1|1|1011|1|
|0010|ëSìX110type6|100.0|ëSìX110type6|0|1|2|1110|6|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 67 stories (of which 0 pending) containing 452 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.003 sec - in ncr.res.mobilepos.promotion.qrcodeinfo.test.QrCodeListTest
Running ncr.res.mobilepos.promotion.qrcodeinfo.test.QrCodeTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/promotion/qrcodeinfo/test/qr_code_test.scenario

(ncr/res/mobilepos/promotion/qrcodeinfo/test/qr_code_test.scenario)
Scenario: test QrCodeInfo.
Using timeout for story qr_code_test.scenario of 300 secs.
Given a loaded dataset test/ncr/res/mobilepos/promotion/qrcodeinfo/test/data_qrCode.xml

Scenario: COMPANYID exist but STOREID not exist.
When the tomcat startUp with companyId 01 and storeId null
Then the Result Code is 2

Scenario: STOREID exist but COMPANYID not exist.
When the tomcat startUp with companyId null and storeId 0001
Then the Result Code is 2

Scenario: Business date is not set.
When the tomcat startUp with companyId 02 and storeId 0002
Then the Result Code is 2

Scenario: can't find rigth info because deleteFlag is 1.
When the tomcat startUp with companyId 03 and storeId 0003
Then the Result Code is 0
Then the emptyResult is null

Scenario: get the right info.
When the tomcat startUp with companyId 01 and storeId 0001
Then the Result Code is 0
Then I should get the QrCodeInfo :

|PromotionId|MinimumPrice|OutputTargetValue|BMPFileName|BMPFileFlag|BMPFileCount|OutputType|DisplayOrder|PromotionType|Dpt|Line|Class|Sku|ConnCode|BrandId|MemberRank|MemberTargetType|SexType|BirthMonth|
|0001|100.0|1011|ëSìX11type1|0|1|1|1|1|394|0001|39401|04627787|null|null|1|0|1|01|
|0002|100.0|1012|ëSìX12type2|0|1|2|1|2|394|0002|39401|04627788|null|null|1|0|1|01|
|0002|100.0|1012|ëSìX12type2|0|1|2|1|2|395|0002|39401|04627788|null|null|1|0|1|01|
|0004|100.0|1014|ëSìX14type4|0|1|3|1|4|394|0004|39401|04627787|null|00001|1|0|1|01|
|0005|100.0|1015|ëSìX15type5|0|1|2|1|5|394|0005|39401|04627787|null|null|1|0|1|01|
|0006|100.0|1016|ëSìX16type3|0|1|1|1|3|394|0006|39401|04627787|0001|null|1|0|1|01|
|0007|100.0|1017|ëSìX17type6|0|1|2|1|6|394|0007|39401|4920001001230|null|null|1|0|1|01|
|0008|100.0|1018|ëSìX18type3|0|1|2|1|3|394|0008|39401|04627787|0001|null|1|0|1|01|
|0009|100.0|1019|ëSìX19type4|0|1|3|1|4|394|0009|39401|04627787|null|00001|1|0|1|01|
|0010|100.0|1110|ëSìX110type6|0|1|2|1|6|394|0010|39401|492000100999*|null|null|1|0|1|01|
|0011|100.0|1111|ëSìX111type2|0|1|2|1|2|394|0002|39401|04627788|null|null|1|1|1|01|
|0012|100.0|1112|ëSìX112type1|0|1|1|1|1|394|0001|39401|04627787|null|null|null|null|null|null|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 68 stories (of which 0 pending) containing 458 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.699 sec - in ncr.res.mobilepos.promotion.qrcodeinfo.test.QrCodeTest
Running ncr.res.mobilepos.sod.test.StartOfDayTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/sod/test/start_of_day_test.scenario
!-- DEFAULT: MultiSOD is NOT ALLOWED
(ncr/res/mobilepos/sod/test/start_of_day_test.scenario)
Scenario: Start Of Day Has Not Been Started
Given a RESMaster initial data from data_sod.xml
Using timeout for story start_of_day_test.scenario of 300 secs.
Given a RESTransaction initial data from data_journal.xml
Given a companyid 01 storeid 0247 terminalid 0001
Given that multiple SOD is {not allowed}
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|9|0|9011011|


Scenario: Repeat SOD of Same Terminal But Different Operator
Given that multiple SOD is {not allowed}
When operator 9022022 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0

Scenario: Repeat SOD From Different Terminal
Given that multiple SOD is {not allowed}
Given a companyid 01 storeid 0247 terminalid 0002
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 1504

Scenario: Successful SOD
Given that multiple SOD is {not allowed}
Given a companyid 01 storeid 0247 terminalid 0001
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0
!-- Successful SOD
When completed SOD with poslog [
<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>
]
Then it should get journal response 0
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|1|0|9011011|

Then TXL_SALES_JOURNAL should have the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|Status|SendStatus1|SendStatus2|Tx|
|01|0247|0001|945|2016-08-16|0|SOD|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: SOD Already Done, Other Terminal Repeat SOD on Till
Given that multiple SOD is {not allowed}
Given a companyid 01 storeid 0247 terminalid 0002
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 1505
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|1|0|9011011|

Then TXL_SALES_JOURNAL should have the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|Status|SendStatus1|SendStatus2|Tx|
|01|0247|0001|945|2016-08-16|0|SOD|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>|

!-- MultiSOD is ALLOWED

Scenario: Start Of Day Has Not Been Started
Given a RESMaster initial data from data_sod.xml
Given a RESTransaction initial data from data_journal.xml
Given a companyid 01 storeid 0247 terminalid 0001
Given that multiple SOD is allowed
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|9|0|9011011|


Scenario: Repeat SOD of Same Terminal But Different Operator
Given that multiple SOD is allowed
When operator 9022022 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0

Scenario: Repeat SOD From Different Terminal
Given that multiple SOD is allowed
Given a companyid 01 storeid 0247 terminalid 0002
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0

Scenario: Successful SOD
Given that multiple SOD is allowed
Given a companyid 01 storeid 0247 terminalid 0001
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 0
Then it should get cashonhand 0
!-- Successful SOD
When completed SOD with poslog [
<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>
]
Then it should get journal response 0
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|1|0|9011011|

Then TXL_SALES_JOURNAL should have the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|Status|SendStatus1|SendStatus2|Tx|
|01|0247|0001|945|2016-08-16|0|SOD|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>|


Scenario: SOD Already Done, Then Other Terminal Repeat SOD on Till
Given that multiple SOD is not allowed
Given a companyid 01 storeid 0247 terminalid 0002
When operator 9011011 starts SOD at till 02470001
Then it should have an authorized code 1505
Then MST_TILLIDINFO should have the following:

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|0247|02470001|0001|2016-08-16|1|0|9011011|

Then TXL_SALES_JOURNAL should have the following:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|Status|SendStatus1|SendStatus2|Tx|
|01|0247|0001|945|2016-08-16|0|SOD|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction TrainingModeFlag="false"><TransactionType>SOD</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>0945</SequenceNumber><BusinessDayDate>2016-08-16</BusinessDayDate><BeginDateTime>2017-01-17T16:28:32</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-01-17T16:28:32</ReceiptDateTime><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><TillID>02470001</TillID><TenderControlTransaction Version="2.2"><DayPart>SOD</DayPart><Associate><AssociateID>9011011</AssociateID><AssociateName>îƒópîÃîÑàı3</AssociateName><AssociateKanaName></AssociateKanaName></Associate><TillSettle><Tender TenderType="Cash"><Amount>0</Amount><Devices><CashChanger><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity></MonetaryKind></CashChanger><CashDrawer><Amount>0</Amount><MonetaryKind><Kind>10000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>5000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>2000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>1000</Kind><Quantity>0</Quantity></MonetaryKind><MonetaryKind><Kind>500</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>100</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>50</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>10</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>5</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind><MonetaryKind><Kind>1</Kind><Quantity>0</Quantity><Rolls>0</Rolls></MonetaryKind></CashDrawer></Devices></Tender></TillSettle></TenderControlTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 69 stories (of which 0 pending) containing 468 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.923 sec - in ncr.res.mobilepos.sod.test.StartOfDayTest
Running ncr.res.mobilepos.softwareinfo.resource.test.SoftwareInfoTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/softwareinfo/resource/test/software_info_test.scenario

(ncr/res/mobilepos/softwareinfo/resource/test/software_info_test.scenario)
Scenario: MANIFEST.MF does not exist
Given Web API Service SofwareInfo
Given that the MANIFEST.MF file is not available in the META-INF
Using timeout for story software_info_test.scenario of 300 secs.
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has only Implementation-Title
Given Web API Service SofwareInfo
Given the MANIFEST_NO_VERSION.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer2|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has only Implementation-Build
Given Web API Service SofwareInfo
Given the MANIFEST_NO_NAME.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|s23wip|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has no Implementation-Title & Implementation-Build
Given Web API Service SofwareInfo
Given the MANIFEST_NO_VERSION_NAME.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has invalid key Implementation-Build
Given Web API Service SofwareInfo
Given the MANIFEST_INVALID_VERSION.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has invalid key Implementation-Title
Given Web API Service SofwareInfo
Given the MANIFEST_INVALID_NAME.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: MANIFEST.MF has invalid keys Implementation-Title & Implementation-Build
Given Web API Service SofwareInfo
Given the MANIFEST_INVALID_NAME.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer|NA|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|


Scenario: Gets All software Information
Given Web API Service SofwareInfo
Given the MANIFEST_VALID_NAME_VERSION.MF file
When I get all Software Information
Then I should get the following software version:

|software|name|version|
|service|WebStoreServer3|s30wip|
|server|Tomcat|Actual|
|java|J2EE|Actual|
|os|OperatingSystem|Windows 7(amd64)Actual|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 70 stories (of which 0 pending) containing 476 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.042 sec - in ncr.res.mobilepos.softwareinfo.resource.test.SoftwareInfoTest
Running ncr.res.mobilepos.systemsetting.resource.test.SystemSettingResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/systemsetting/resource/test/system_setting_resource_test.scenario

(ncr/res/mobilepos/systemsetting/resource/test/system_setting_resource_test.scenario)
Scenario: Given ipAddress is invalid and failed with UnknownHostException
Using timeout for story system_setting_resource_test.scenario of 300 secs.
Given ipAddress, 1231.456.789.1111 is invalid and cannot be resolved
Given Timeout is defined as 1000 ms
When I make a ping to ipAddress, 1231.456.789.1111
Then Ping failed with RES_ERROR_PING



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 71 stories (of which 0 pending) containing 477 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.14 sec - in ncr.res.mobilepos.systemsetting.resource.test.SystemSettingResourceTest
Running ncr.res.mobilepos.tenderinfo.resource.test.GetTenderInfoResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tenderinfo/resource/test/get_tender_info_resource_test.scenario

(ncr/res/mobilepos/tenderinfo/resource/test/get_tender_info_resource_test.scenario)
Scenario: StoreId (0) only in the applicable tables
DataSet:test/ncr/res/mobilepos/tenderinfo/resource/test/MST_TENDERINFO_Scenario1.xml
Given a table MST_TENDERINFO_Scenario1.xml
Given that tenderinfo service
When I get tenderinfo of CompanyId:01 StoreId:0123 TenderType:1,2,5,6
Then I should get the following json : {"message":"Success","JSONObject":"{\"1\":[{\"companyId\":\"01\",\"storeId\":\"0123\",\"tenderType\":\"1\",\"tenderId\":\"0101\",\"code\":\"0101\",\"label\":{\"ja\":\"è§ïiåîÇP\",\"en\":\"JCB\"},\"stampType\":\"1\",\"pointType\":\"1\",\"changeType\":\"1\",\"unitPrice\":\"0\",\"displayOrder\":\"0\"}]}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: StoreId (XXXX) and StoreId (0)
DataSet:test/ncr/res/mobilepos/tenderinfo/resource/test/MST_TENDERINFO_Scenario2.xml
Using timeout for story get_tender_info_resource_test.scenario of 300 secs.
Given a table MST_TENDERINFO_Scenario2.xml
Given that tenderinfo service
When I get tenderinfo of CompanyId:01 StoreId:0123 TenderType:1,2,5,6
Then I should get the following json : {"message":"Success","JSONObject":"{\"1\":[{\"companyId\":\"01\",\"storeId\":\"0123\",\"tenderType\":\"1\",\"tenderId\":\"0102\",\"code\":\"0102\",\"label\":{\"ja\":\"è§ïiåîÇQ\",\"en\":\"UC\"},\"stampType\":\"1\",\"pointType\":\"1\",\"changeType\":\"1\",\"unitPrice\":\"0\",\"displayOrder\":\"0\"}]}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: StoreId (XXXX) only in the applicable tables
DataSet:test/ncr/res/mobilepos/tenderinfo/resource/test/MST_TENDERINFO_Scenario3.xml
Given a table MST_TENDERINFO_Scenario3.xml
Given that tenderinfo service
When I get tenderinfo of CompanyId:01 StoreId:0123 TenderType:1,2,5,6
Then I should get the following json : {"message":"Success","JSONObject":"{\"1\":[{\"companyId\":\"01\",\"storeId\":\"0123\",\"tenderType\":\"1\",\"tenderId\":\"0103\",\"code\":\"0103\",\"label\":{\"ja\":\"è§ïiåîÇR\",\"en\":\"VISA\"},\"stampType\":\"1\",\"pointType\":\"1\",\"changeType\":\"1\",\"unitPrice\":\"0\",\"displayOrder\":\"0\"}]}","NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: NO actual/specific store id and common store id
DataSet:test/ncr/res/mobilepos/tenderinfo/resource/test/MST_TENDERINFO_Scenario4.xml
Given a table MST_TENDERINFO_Scenario4.xml
Given that tenderinfo service
When I get tenderinfo of CompanyId:01 StoreId:0123 TenderType:1,2,5,6
Then I should get the following json : {"message":"No Rows Available","NCRWSSExtendedResultCode":157,"NCRWSSResultCode":157}

Scenario: Get all tender info
DataSet:test/ncr/res/mobilepos/tenderinfo/resource/test/MST_TENDERINFO_Scenario5.xml
Given a table MST_TENDERINFO_Scenario5.xml
Given that tenderinfo service
When I get all tenderinfo of CompanyId:01 StoreId:0123
Then I should get the following json : {"message":"Success","JSONObject":"{\"8\":[{\"companyId\":\"01\",\"storeId\":\"0123\",\"tenderType\":\"8\",\"tenderId\":\"0020\",\"code\":\"0020\",\"label\":{\"ja\":\"É|ÉCÉìÉg\",\"en\":\"Point\"},\"stampType\":\"2\",\"pointType\":\"1\",\"changeType\":\"1\",\"tenderIdentification\":\"1\",\"unitPrice\":\"0\",\"tranVoid\":\"0\",\"tranReturn\":\"1\",\"tenderVoid\":\"1\",\"displayOrder\":\"0\",\"couponPriceList\":[{\"nameText\":\"ÇpÇtÇnÉJÅ[Éh\",\"unitPrice\":\"1000\"},{\"nameText\":\"ÇpÇtÇnÉJÅ[Éh\",\"unitPrice\":\"2000\"}]}],\"9\":[{\"companyId\":\"01\",\"storeId\":\"0123\",\"tenderType\":\"9\",\"tenderId\":\"0030\",\"code\":\"0030\",\"label\":{\"ja\":\"ÉNÉåÉWÉbÉg\",\"en\":\"INFOX ÉNÉåÉWÉbÉg\"},\"stampType\":\"2\",\"pointType\":\"1\",\"changeType\":\"1\",\"tenderIdentification\":\"1\",\"unitPrice\":\"0\",\"tranVoid\":\"0\",\"tranReturn\":\"1\",\"tenderVoid\":\"1\",\"displayOrder\":\"0\"}]}","NCRWSSExtendedResultCode":0,"NCRWSSResultCode":0}



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 72 stories (of which 0 pending) containing 482 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.01 sec - in ncr.res.mobilepos.tenderinfo.resource.test.GetTenderInfoResourceTest
Running ncr.res.mobilepos.test.TestRunnerScenario
Tests run: 1, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0 sec - in ncr.res.mobilepos.test.TestRunnerScenario
Running ncr.res.mobilepos.tillinfo.resource.test.CreateTillInfoResourceTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0 sec - in ncr.res.mobilepos.tillinfo.resource.test.CreateTillInfoResourceTest
Running ncr.res.mobilepos.tillinfo.resource.test.EODGetExecuteAuthorityTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/e_o_d_get_execute_authority_test.scenario
!-- check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/e_o_d_get_execute_authority_test.scenario)
Scenario: Check required parameters - retailstoreid is null
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Using timeout for story e_o_d_get_execute_authority_test.scenario of 300 secs.
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:null,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - retailstoreid is empty
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:{},
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is null
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:null, terminalid:0001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is empty
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:{}, terminalid:0001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is null
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:null, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is empty
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:{}, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - operatorno is null
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:null, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - operatorno is empty
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:{}, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - processing is null
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:null,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - processing is empty
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:{},
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter
!-- check for valid value of processing parameter

Scenario: Check required parameters - processing is "xxx"
Given a TillInfoResource Resource
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:xxx,
    compulsoryflag:false
Then ResultCode should be 154
!-- 154 = invalid parameter
!-- check if till is existing

Scenario: Till is not existing
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO_EMPTY dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 1500
!-- 1500 = till does not exit
!-- check if till already finished eod

Scenario: Till already finished EOD
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995000, terminalid:5000, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 1509
!-- 1509 = till already finished EOD
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|1|9|9999|
|01|9999|99995002|5002|2014-11-14|1|0|9999|
|01|9999|99995003|5003|2014-11-14|1|0|9999|
|01|9999|99995004|5004|2014-11-13|1|0|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|

!-- compulsory flag test

Scenario: Compulsory flag is false and eodflag = 9
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995001, terminalid:5001, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 0
!-- 1510 = other terminal already in EOD
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|0|9|9999|
|01|9999|99995002|5002|2014-11-14|1|0|9999|
|01|9999|99995003|5003|2014-11-14|1|0|9999|
|01|9999|99995004|5004|2014-11-13|1|0|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|


Scenario: Compulsory flag is true and eodflag = 9
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995001, terminalid:5001, operatorno:9999, processing:EOD,
    compulsoryflag:true
Then ResultCode should be 0
!-- 0 = OK
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|0|9|9999|
|01|9999|99995002|5002|2014-11-14|1|0|9999|
|01|9999|99995003|5003|2014-11-14|1|0|9999|
|01|9999|99995004|5004|2014-11-13|1|0|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|

!-- business date test

Scenario: MST_TILLIDINFO.BusinessDayDate is null
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995002, terminalid:5002, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 0
!-- 1507 = invalid business date
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|1|9|9999|
|01|9999|99995002|5002|2014-11-14|0|9|9999|
|01|9999|99995003|5003|2014-11-14|1|0|9999|
|01|9999|99995004|5004|2014-11-13|1|0|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|


Scenario: MST_BIZDAY.TodayDate not equal to MST_TILLIDINFO.BusinessDayDate
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995004, terminalid:5004, operatorno:9999, processing:EOD,
    compulsoryflag:false
Then ResultCode should be 0
!-- 1507 = invalid business date
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|1|9|9999|
|01|9999|99995002|5002|2014-11-14|1|0|9999|
|01|9999|99995003|5003|2014-11-14|1|0|9999|
|01|9999|99995004|5004|2014-11-14|0|9|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|

!-- success

Scenario: Success scenario
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO dataset
When I perform a getExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995003, terminalid:5003, operatorno:9999, processing:EOD,
    compulsoryflag:true
Then ResultCode should be 0
!-- 0 = OK
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|01|000031|000031|000031|2014-11-14|0|0|2|
|01|9999|99995000|5000|2014-12-01|0|1|9999|
|01|9999|99995001|5001|2014-11-14|1|9|9999|
|01|9999|99995002|5002|2014-11-14|1|0|9999|
|01|9999|99995003|5003|2014-11-14|0|9|9999|
|01|9999|99995004|5004|2014-11-13|1|0|9999|
|01|es185|es134|es134|1989-03-02|9|9|222|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 73 stories (of which 0 pending) containing 500 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.264 sec - in ncr.res.mobilepos.tillinfo.resource.test.EODGetExecuteAuthorityTest
Running ncr.res.mobilepos.tillinfo.resource.test.EODReleaseExecuteAuthorityTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/e_o_d_release_execute_authority_test.scenario
!-- check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/e_o_d_release_execute_authority_test.scenario)
Scenario: Check required parameters - retailstoreid is null
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Using timeout for story e_o_d_release_execute_authority_test.scenario of 300 secs.
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:null,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - retailstoreid is empty
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:{},
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is null
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:null, terminalid:0001, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is empty
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:{}, terminalid:0001, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is null
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:null, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is empty
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:{}, operatorno:9999, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - operatorno is null
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:null, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - operatorno is empty
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:{}, processing:EOD
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - processing is null
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:null
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - processing is empty
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:{}
Then ResultCode should be 154
!-- 154 = invalid parameter
!-- check for valid value of processing parameter

Scenario: Check required parameters - processing is "xxx"
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:xxx
Then ResultCode should be 154
!-- 154 = invalid parameter
!-- check if till is existing

Scenario: Till is not existing
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO_EMPTY dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99990001, terminalid:0001, operatorno:9999, processing:EOD
Then ResultCode should be 1500
!-- 1500 = till does not exit
!-- check if eod is not yet started

Scenario: EOD not yet started
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995000, terminalid:5000, operatorno:9999, processing:EOD
Then ResultCode should be 1512
!-- 1512 = EOD is not yet started
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|9999|99995000|5000|2014-12-01|1|0|9999|
|9999|99995001|5001|2014-12-01|0|1|9999|
|9999|99995002|5002|2014-11-13|1|9|9999|
|9999|99995003|5003|2014-11-13|1|9|9999|
|9999|99995004|5004|2014-11-14|1|9|9999|

!-- check if eod is already finished

Scenario: EOD already finished
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995001, terminalid:5001, operatorno:9999, processing:EOD
Then ResultCode should be 1509
!-- 1509 = EOD already finished
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|9999|99995000|5000|2014-12-01|1|0|9999|
|9999|99995001|5001|2014-12-01|0|1|9999|
|9999|99995002|5002|2014-11-13|1|9|9999|
|9999|99995003|5003|2014-11-13|1|9|9999|
|9999|99995004|5004|2014-11-14|1|9|9999|

!-- business date test

Scenario: MST_TILLIDINFO.BusinessDayDate is null
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995002, terminalid:5002, operatorno:9999, processing:EOD
Then ResultCode should be 0
!-- 1507 = invalid business date
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|9999|99995000|5000|2014-12-01|1|0|9999|
|9999|99995001|5001|2014-12-01|0|1|9999|
|9999|99995002|5002|2014-11-13|1|0|9999|
|9999|99995003|5003|2014-11-13|1|9|9999|
|9999|99995004|5004|2014-11-14|1|9|9999|


Scenario: MST_BIZDAY.TodayDate not equal to MST_TILLIDINFO.BusinessDayDate
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995003, terminalid:5003, operatorno:9999, processing:EOD
Then ResultCode should be 0
!-- 1507 = invalid business date
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|9999|99995000|5000|2014-12-01|1|0|9999|
|9999|99995001|5001|2014-12-01|0|1|9999|
|9999|99995002|5002|2014-11-13|1|9|9999|
|9999|99995003|5003|2014-11-13|1|0|9999|
|9999|99995004|5004|2014-11-14|1|9|9999|

!-- success

Scenario: Success scenario
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_BIZDAY_2014-11-14 dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
When I perform a releaseExecuteAuthotity request with companyid:01 retailstoreid:9999,
    tillid:99995004, terminalid:5004, operatorno:9999, processing:EOD
Then ResultCode should be 0
!-- 0 = OK
Then RESMaster MST_TILLIDINFO should have the following row(s): 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|UpdOpeCode|
|9999|99995000|5000|2014-12-01|1|0|9999|
|9999|99995001|5001|2014-12-01|0|1|9999|
|9999|99995002|5002|2014-11-13|1|9|9999|
|9999|99995003|5003|2014-11-13|1|9|9999|
|9999|99995004|5004|2014-11-14|1|0|9999|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 74 stories (of which 0 pending) containing 517 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.763 sec - in ncr.res.mobilepos.tillinfo.resource.test.EODReleaseExecuteAuthorityTest
Running ncr.res.mobilepos.tillinfo.resource.test.GetActivatedTillTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/get_activated_till_test.scenario
!-- Check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/get_activated_till_test.scenario)
Scenario: Check required parameters - companyId is ""
Given a TillInfoResource Resource
When I get activated tills with companyId:empty storeId:9999 businessDate:2017-01-01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - storeId is null
Given a TillInfoResource Resource
When I get activated tills with companyId:01 storeId:null businessDate:2017-01-01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - businessDate is ""
Given a TillInfoResource Resource
When I get activated tills with companyId:01 storeId:9999 businessDate:empty trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG
!-- Check businessDate format

Scenario: Check required parameters - businessDate is not yyyy-MM-dd
Given a TillInfoResource Resource
When I get activated tills with companyId:01 storeId:9999 businessDate:2017/01/01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - trainingFlag is null
Using timeout for story get_activated_till_test.scenario of 300 secs.
Given a TillInfoResource Resource
When I get activated tills with companyId:01 storeId:9999 businessDate:2017-01-01 trainingFlag:null
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG
!-- Success

Scenario: Success
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given a MST_DEVICEINFO2 dataset
Given resTransaction table dataset
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995001|POS1|5001|2014-11-14|1|9|1|
|01|9999|99995002|POS2|5002|2014-11-14|1|0|0|
|01|9999|99995003|POS3|5003|2014-11-14|1|0|0|


Scenario: Different business day.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-12-01 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995000|POS0|5000|2014-12-01|0|1|1|


Scenario: Different training flag.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-13 trainingFlag:1
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995004|POS4 Training|5004|2014-11-13|1|0|0|


Scenario: Ignore deleted tills.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_DELETED dataset
Given resTransaction table dataset
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995001|POS1|5001|2014-11-14|1|9|1|


Scenario: Different store.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get activated tills with companyId:01 storeId:000031 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|000031|000031||000031|2014-11-14|0|0|0|


Scenario: Different company.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get activated tills with companyId:02 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|


Scenario: Get till even it did EOD.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_EOD dataset
Given resTransaction table dataset
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-12-01 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995000|POS0|5000|2014-12-01|1|0|0|
|01|9999|99995001|POS1|5001|2014-12-01|0|1|1|


Scenario: Get till against broken db connection, DaoException
Given a TillInfoResource Resource
When database has trouble
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_DB and ExtendedResultCode:RES_ERROR_DB

Scenario: NullPointerException (RuntimeException)
Given a TillInfoResource Resource
When runtime exception is thrown
When I get activated tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_GENERAL and ExtendedResultCode:RES_ERROR_GENERAL



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 75 stories (of which 0 pending) containing 531 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.571 sec - in ncr.res.mobilepos.tillinfo.resource.test.GetActivatedTillTest
Running ncr.res.mobilepos.tillinfo.resource.test.GetExecuteAuthoritySODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/get_execute_authority_s_o_d_test.scenario

(ncr/res/mobilepos/tillinfo/resource/test/get_execute_authority_s_o_d_test.scenario)
Scenario: Test RES_OK response from getExecuteAuthority for SOD where SOD is all upper-case (SOD)
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Using timeout for story get_execute_authority_s_o_d_test.scenario of 300 secs.
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000032|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_OK response from getExecuteAuthority for SOD where SOD is all lower-case (sod)
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000033|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000033|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_OK response from getExecuteAuthority for SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_OK response, a same terminal perform getExecuteAuthority twice in a business day
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1111|2222|SOD|false|

Then the result should be OK

Scenario: Test RES_TILL_SOD_PROCESSING response, other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1112|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Test RES_TILL_SOD_FINISHED response, other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Test RES_TILL_INVALID_SOD_FLAG_VAL response, incorrect sod flag value has been set in the db
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG

Scenario: Test NG response from getExecuteAuthority for SOD where MST_BIZDAY is empty
Given an empty MST_BIZDAY
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|2222|SOD|false|

Then the result should be RES_ERROR_NO_BIZDATE

Scenario: Test NG response from getExecuteAuthority for SOD where MST_TILLIDINFO is empty
Given an empty MST_TILLIDINFO
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Test NG response from getExecuteAuthority for SOD where storeId and tillId does not exist
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000001|000002|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Test NG response from getExecuteAuthority for SOD where storeId does not exist
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000001|000032|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Test NG response from getExecuteAuthority for SOD where tillId does not exist
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000002|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Test NG response from getExecuteAuthority for SOD where storeId is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|null|000032|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from getExecuteAuthority for SOD where storeId is empty
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
||000032|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from getExecuteAuthority for SOD where tillId is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|null|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from getExecuteAuthority for SOD where tillId is empty
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031||1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER
!-- Test scenarios for Multi-SOD (multisod = true)

Scenario: Test OK response from getExecuteAuthority for Multi-SOD, request SOD where Till is already processing SOD (sodFlag = 9)
When I request to allow multi-sod
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1111|2222|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000032|1111|9|till.getexecuteauthority|2222|

Then the result should be OK

Scenario: Test OK response from getExecuteAuthority for Multi-SOD, request SOD where Till's SOD is already done (sodFlag = 1)
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000034|1111|2222|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000034|1111|9|till.getexecuteauthority|2222|

Then the result should be OK

Scenario: Test OK response from getExecuteAuthority for Multi-SOD, request SOD where Till's SOD haven't performed yet (sodFlag = 0)
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000033|1111|2222|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000033|1111|9|till.getexecuteauthority|2222|

Then the result should be OK

Scenario: Test OK response from getExecuteAuthority for Multi-SOD 
		  where MST_BIZDAY.TodayDate = MST_TILLIDINFO.BusinessDayDate.
Given a MST_BIZDAY.TodayDate equal to MST_TILLIDINFO.BusinessDayDate
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|2222|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|2222|

Then the result should be OK

Scenario: Test OK response from getExecuteAuthority for Multi-SOD 
		  where MST_BIZDAY.TodayDate < MST_TILLIDINFO.BusinessDayDate
Given a MST_BIZDAY.TodayDate less than MST_TILLIDINFO.BusinessDayDate
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|2222|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|2222|

Then the result should be OK

Scenario: Test RES_OK response from getExecuteAuthority for Multi-SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 76 stories (of which 0 pending) containing 553 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.353 sec - in ncr.res.mobilepos.tillinfo.resource.test.GetExecuteAuthoritySODTest
Running ncr.res.mobilepos.tillinfo.resource.test.GetTillListTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/get_till_list_test.scenario
!-- check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/get_till_list_test.scenario)
Scenario: Check required parameters - storeId is null
Given a TillInfoResource Resource
When I get list of tills with retailstoreid:null
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - retailstoreid is empty
Given a TillInfoResource Resource
When I get list of tills with retailstoreid:{}
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Success (Empty Table)
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_EMPTY dataset
When I get list of tills with retailstoreid:9999
Then ResultCode should be 157
!-- 157 = database data was not found
Using timeout for story get_till_list_test.scenario of 300 secs.
Then MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|DeleteFlag|


Scenario: Success (Deleted Tills)
Given a MST_TILLIDINFO_DELETED dataset
Then MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|DeleteFlag|
|01|9999|99995000|5000|2014-12-01|0|1|1|
|01|9999|99995001|5001|2014-11-14|1|9|0|

When I get list of tills with retailstoreid:9999
Then ResultCode should be 0
Then I should get the following tills: 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|9999|99995001|5001|2014-11-14|1|9|


Scenario: Success (Active Tills)
Given a MST_TILLIDINFO dataset
Then MST_TILLIDINFO should have the following row(s): 

|CompanyId|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|DeleteFlag|
|01|000031|000031|000031|2014-11-14|0|0|0|
|01|9999|99995000|5000|2014-12-01|0|1|0|
|01|9999|99995001|5001|2014-11-14|1|9|0|
|01|9999|99995002|5002|2014-11-14|1|0|0|
|01|9999|99995003|5003|2014-11-14|1|0|0|
|01|9999|99995004|5004|2014-11-13|1|0|0|
|01|es185|es134|es134|1989-03-02|9|9|0|

When I get list of tills with retailstoreid:9999
Then ResultCode should be 0
Then I should get the following tills: 

|StoreId|TillId|TerminalId|BusinessDayDate|SodFlag|EodFlag|
|9999|99995000|5000|2014-12-01|0|1|
|9999|99995001|5001|2014-11-14|1|9|
|9999|99995002|5002|2014-11-14|1|0|
|9999|99995003|5003|2014-11-14|1|0|
|9999|99995004|5004|2014-11-13|1|0|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 77 stories (of which 0 pending) containing 558 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.071 sec - in ncr.res.mobilepos.tillinfo.resource.test.GetTillListTest
Running ncr.res.mobilepos.tillinfo.resource.test.GetUnclosedTillTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/get_unclosed_till_test.scenario
!-- Check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/get_unclosed_till_test.scenario)
Scenario: Check required parameters - companyId is ""
Given a TillInfoResource Resource
When I get unclosed tills with companyId:empty storeId:9999 businessDate:2017-01-01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - storeId is null
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:null businessDate:2017-01-01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - businessDate is ""
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:9999 businessDate:empty trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG
!-- Check businessDate format

Scenario: Check required parameters - businessDate is not yyyy-MM-dd
Given a TillInfoResource Resource
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2017/01/01 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG

Scenario: Check required parameters - trainingFlag is null
Using timeout for story get_unclosed_till_test.scenario of 300 secs.
Given a TillInfoResource Resource
When I get activated tills with companyId:01 storeId:9999 businessDate:2017-01-01 trainingFlag:null
Then the result should be ResultCode:RES_ERROR_INVALIDPARAMETER and ExtendedResultCode:RES_ERROR_INVALIDPARAMETER
Then the result message should be RES_INVALIDPARAMETER_MSG
!-- Success

Scenario: Success
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given a MST_DEVICEINFO2 dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995002|POS2|5002|2014-11-14|1|0|0|
|01|9999|99995003|POS3|5003|2014-11-14|1|0|0|


Scenario: Different business day.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-13 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995004|POS4|5004|2014-11-13|1|0|0|


Scenario: Different training flag.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-13 trainingFlag:1
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995004|POS4 Training|5004|2014-11-13|1|0|0|


Scenario: Ignore deleted tills.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_DELETED dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|


Scenario: Different store.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:000031 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|000031|000031||000031|2014-11-14|0|0|0|


Scenario: Different company.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:02 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|


Scenario: Don't get tills which has done EOD.
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a MST_TILLIDINFO_EOD dataset
Given resTransaction table dataset
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-12-01 trainingFlag:0
Then the result should be ResultCode:RES_OK and ExtendedResultCode:RES_OK
Then I should get the following tills:

|CompanyId|StoreId|TillId|DeviceName|TerminalId|BusinessDayDate|SodFlag|EodFlag|EodSummary|
|01|9999|99995000|POS0|5000|2014-12-01|1|0|0|


Scenario: Get till against broken db connection, DaoException
Given a TillInfoResource Resource
When database has trouble
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_DB and ExtendedResultCode:RES_ERROR_DB

Scenario: NullPointerException (RuntimeException)
Given a TillInfoResource Resource
When runtime exception is thrown
When I get unclosed tills with companyId:01 storeId:9999 businessDate:2014-11-14 trainingFlag:0
Then the result should be ResultCode:RES_ERROR_GENERAL and ExtendedResultCode:RES_ERROR_GENERAL



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 78 stories (of which 0 pending) containing 572 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.074 sec - in ncr.res.mobilepos.tillinfo.resource.test.GetUnclosedTillTest
Running ncr.res.mobilepos.tillinfo.resource.test.PerformMultiSODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/perform_multi_s_o_d_test.scenario
!-- Test scenario involvings variations of MultiSOD value in PRM_SYSTEM_CONFIG. Default is false/0.
!-- Start of tests
!-- Test scenarios for single SOD (MultiSOD is 0 false in PRM_SYSTEM_CONFIG)
(ncr/res/mobilepos/tillinfo/resource/test/perform_multi_s_o_d_test.scenario)
Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Using timeout for story perform_multi_s_o_d_test.scenario of 300 secs.
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD is set to false
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000036|1111|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG
!-- Test scenarios for single SOD (MultiSOD does not exist in PRM_SYSTEM_CONFIG)

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD does not exist
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|companyId|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|01|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000036|1111|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG
!-- Test scenarios for single SOD (MultiSOD has empty value in PRM_SYSTEM_CONFIG)

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD is empty
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000036|1111|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG

Scenario: Perform SOD where MST_BIZDAY.TodayDate = MST_TILLIDINFO.BusinessDayDate
Given a MST_BIZDAY.TodayDate equal to MST_TILLIDINFO.BusinessDayDate
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000033|1111|2222|SOD|false|

Then the result should be OK
!-- Test scenarios for single SOD (MultiSOD has value not equal to 1 or 0 in PRM_SYSTEM_CONFIG)

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD is not equal to 1
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000036|1111|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG

Scenario: Perform SOD where MST_BIZDAY.TodayDate = MST_TILLIDINFO.BusinessDayDate
Given a MST_BIZDAY.TodayDate equal to MST_TILLIDINFO.BusinessDayDate
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000033|1111|2222|SOD|false|

Then the result should be OK
!-- Test scenarios for Multi-SOD where MultiSOD is set to 1 (true) in PRM_SYSTEM_CONFIG

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD is set to true
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000036|1111|2222|SOD|false|

Then the result should be OK

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000034|1111|2222|SOD|false|

Then the result should be OK

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000035|1111|2222|SOD|false|

Then the result should be OK

Scenario: Perform SOD where MST_BIZDAY.TodayDate = MST_TILLIDINFO.BusinessDayDate
Given a MST_BIZDAY.TodayDate equal to MST_TILLIDINFO.BusinessDayDate
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000033|1111|2222|SOD|false|

Then the result should be OK

Scenario: Perform SOD where MST_BIZDAY is empty
Given an empty MST_BIZDAY
When I request to perform SOD with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000033|1111|2222|SOD|false|

Then the result should be RES_ERROR_NO_BIZDATE



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 79 stories (of which 0 pending) containing 601 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.399 sec - in ncr.res.mobilepos.tillinfo.resource.test.PerformMultiSODTest
Running ncr.res.mobilepos.tillinfo.resource.test.PerformSingleSODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/perform_single_s_o_d_test.scenario
!-- Test scenarios for single SOD (MultiSOD is 0 false in PRM_SYSTEM_CONFIG)
(ncr/res/mobilepos/tillinfo/resource/test/perform_single_s_o_d_test.scenario)
Scenario: Perform SOD where processingType is "SOD"
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Using timeout for story perform_single_s_o_d_test.scenario of 300 secs.
Given a MST_BIZDAY with data
Given a PRM_SYSTEM_CONFIG data where MultiSOD is set to false
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|SOD|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where processingType is "sod"
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000032|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|false|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000036|1111|2222|SOD|false|

Then the result should be SOD_PROCESSING

Scenario: Perform SOD where other device already performed SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000034|1111|2222|SOD|false|

Then the result should be SOD_FINISHED

Scenario: Perform SOD where till has invalid sod flag value in the db
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000035|1111|2222|SOD|false|

Then the result should be INVALID_SOD_FLAG

Scenario: Perform SOD where MST_BIZDAY is empty
Given an empty MST_BIZDAY
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000033|1111|2222|SOD|false|

Then the result should be RES_ERROR_NO_BIZDATE

Scenario: Perform SOD where MST_TILLIDINFO is empty
Given an empty MST_TILLIDINFO
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000033|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Perform SOD where storeId and tillId do not exist
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000001|000002|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Perform SOD where storeId does not exist
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000001|000033|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Perform SOD where tillId does not exist
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000002|1111|2222|SOD|false|

Then the result should be TILL_NOT_EXIST

Scenario: Perform SOD where storeId is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|null|000033|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Perform SOD where storeId is empty
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
||000033|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Perform SOD where tillId is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|null|1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Perform SOD where tillId is empty
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031||1111|2222|SOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER
!-- Test scenarios involving variations of compulsoryFlag value. Default is false.
!-- Start of tests
!-- Test scenarios for compulsory SOD where compulsoryFlag is true

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|SOD||

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000036|1111|1111|sod|true|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000036|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where SOD for the Till haven't performed yet
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000032|1111|1111|sod|true|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000032|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|true|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK
!-- Test scenarios for compulsory SOD where compulsoryFlag is empty.
!-- The behavior should be the same with compulsoryFlag is false.

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|SOD||

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod||

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000036|1111|2222|SOD||

Then the result should be SOD_PROCESSING
!-- Test scenarios for compulsory SOD where compulsoryFlag is null.
!-- The behavior should be the same with compulsoryFlag is false.

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|SOD|null|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|null|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000036|1111|2222|SOD|null|

Then the result should be SOD_PROCESSING
!-- Test scenarios for compulsory SOD where compulsoryFlag has value other than true or false.
!-- The behavior should be the same with compulsoryFlag is false.

Scenario: Perform SOD normally
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|SOD|compulsoryFlag|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000031|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000039|1111|1111|sod|compulsoryFlag|

Then I should have the following sod till info data:

|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|000031|000039|1111|9|till.getexecuteauthority|1111|

Then the result should be OK

Scenario: Perform SOD where other device is already processing SOD for the given Till
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000036|1111|2222|SOD|compulsoryFlag|

Then the result should be SOD_PROCESSING
!-- Test scenarios involving variation of values for processing type

Scenario: Perform SOD where processingType is null
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|null|false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Perform SOD where processingType is empty
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111||false|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Perform SOD where processingType is not "SOD" or "EOD"
When I request to perform SOD with the following data:

|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|000031|000031|1111|1111|OOD|false|

Then the result should be RES_ERROR_INVALIDPARAMETER



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 80 stories (of which 0 pending) containing 632 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.156 sec - in ncr.res.mobilepos.tillinfo.resource.test.PerformSingleSODTest
Running ncr.res.mobilepos.tillinfo.resource.test.ReleaseExecuteAuthoritySODTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/release_execute_authority_s_o_d_test.scenario

(ncr/res/mobilepos/tillinfo/resource/test/release_execute_authority_s_o_d_test.scenario)
Scenario: Test RES_OK response from releaseExecuteAuthority for SOD where SOD is all upper-case (SOD)
Given I have a Till Info Resource and other resources
Given a MST_TILLIDINFO with data
Using timeout for story release_execute_authority_s_o_d_test.scenario of 300 secs.
Given a MST_BIZDAY with data
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000036|1111|1111|SOD|

Then I should have the following sod till info data:

|companyId|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|01|000031|000036|1111|0|till.releaseexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_OK response from releaseExecuteAuthority for SOD where SOD is all lower-case (sod)
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000037|1111|1111|sod|

Then I should have the following sod till info data:

|companyId|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|01|000031|000037|1111|0|till.releaseexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_OK response from releaseExecuteAuthority for SOD where MST_TILLIDINFO.BusinessDayDate is null
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|compulsoryFlag|
|01|000031|000040|1111|1111|sod|false|

Then I should have the following sod till info data:

|companyId|storeId|tillId|terminalId|sodFlag|updAppId|updOpeCode|
|01|000031|000040|1111|0|till.releaseexecuteauthority|1111|

Then the result should be OK

Scenario: Test RES_TILL_SOD_UNFINISHED response.
		  Operator tries to release/cancel getting execution authority for
		  SOD of a Till which hasn't been processed yet.
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000032|1111|2222|SOD|
|the result should be SOD_UNFINISHED||||||


Scenario: Test RES_TILL_SOD_FINISHED response.
		  Operator tries to release/cancel getting execution authority for
		  SOD of a Till which has already performed SOD.
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000034|1111|2222|SOD|
|the result should be SOD_FINISHED||||||


Scenario: Test RES_TILL_INVALID_SOD_FLAG_VAL response, incorrect sod flag value has been set in the db
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000035|1111|2222|SOD|

Then the result should be INVALID_SOD_FLAG

Scenario: Test NG response from releaseExecuteAuthority for SOD where MST_BIZDAY is empty
Given an empty MST_BIZDAY
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000036|1111|2222|SOD|

Then the result should be RES_ERROR_NO_BIZDATE

Scenario: Test NG response from releaseExecuteAuthority for SOD where MST_TILLIDINFO is empty
Given an empty MST_TILLIDINFO
Given a MST_BIZDAY with data
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000036|1111|2222|SOD|
|the result should be TILL_NOT_EXIST||||||


Scenario: Test NG response from releaseExecuteAuthority for SOD where storeId and tillId does not exist
Given a MST_TILLIDINFO with data
Given a MST_BIZDAY with data
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000001|000002|1111|2222|SOD|
|the result should be TILL_NOT_EXIST||||||


Scenario: Test NG response from releaseExecuteAuthority for SOD where storeId does not exist
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000001|000032|1111|2222|SOD|
|the result should be TILL_NOT_EXIST||||||


Scenario: Test NG response from releaseExecuteAuthority for SOD where tillId does not exist
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|000002|1111|2222|SOD|
|the result should be TILL_NOT_EXIST||||||


Scenario: Test NG response from releaseExecuteAuthority for SOD where storeId is null
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|null|000032|1111|2222|SOD|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from releaseExecuteAuthority for SOD where storeId is empty
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01||000032|1111|2222|SOD|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from releaseExecuteAuthority for SOD where tillId is null
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031|null|1111|2222|SOD|

Then the result should be RES_ERROR_INVALIDPARAMETER

Scenario: Test NG response from releaseExecuteAuthority for SOD where tillId is empty
When I request to release execution authority with the following data:

|companyId|storeId|tillId|terminalId|operatorNo|processingType|
|01|000031||1111|2222|SOD|

Then the result should be RES_ERROR_INVALIDPARAMETER



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 81 stories (of which 0 pending) containing 647 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.184 sec - in ncr.res.mobilepos.tillinfo.resource.test.ReleaseExecuteAuthoritySODTest
Running ncr.res.mobilepos.tillinfo.resource.test.SearchLogonUsersTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/search_logon_users_test.scenario
!-- check required parameters
(ncr/res/mobilepos/tillinfo/resource/test/search_logon_users_test.scenario)
Scenario: Check required parameters - retailstoreid is null
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:null,
    tillid:99990001, terminalid:0001
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - retailstoreid is empty
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:{}, 
    tillid:99990001, terminalid:0001
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is null
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:9999,
    tillid:null, terminalid:0001
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - tillid is empty
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:9999,
    tillid:{}, terminalid:0001
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is null
Using timeout for story search_logon_users_test.scenario of 300 secs.
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:9999,
    tillid:99990001, terminalid:null
Then ResultCode should be 154
!-- 154 = invalid parameter

Scenario: Check required parameters - terminalid is empty
Given a TillInfoResource Resource
When I perform a search request with retailstoreid:9999,
    tillid:99990001, terminalid:{}
Then ResultCode should be 154
!-- 154 = invalid parameter
!-- check if till is existing

Scenario: Till is not existing
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_TILLIDINFO_EMPTY dataset
When I perform a search request with retailstoreid:9999,
    tillid:99990001, terminalid:0001
Then ResultCode should be 1500
!-- 1500 = till does not exit
!-- search logon users

Scenario: 2 users with same till still logged on
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_DEVICEINFO dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
Given a RESTransaction DBInitiator
Given a RESTransaction TXU_POS_CTRL_scenario1 dataset
Then RESMaster MST_DEVICEINFO should have the following row(s): 

|StoreId|TerminalId|TillId|
|9999|5000|99995000|
|9999|5001|99995001|
|9999|5002|99995000|
|9999|5003|99995001|
|9999|5004|99995000|

Then RESTransaction TXU_POS_CTRL should have the following row(s): 

|StoreId|TerminalNo|OpeCode|
|9999|5000|7000|
|9999|5001|7001|
|9999|5002|7002|
|9999|5003|7003|
|9999|5004|7004|

When I perform a search request with retailstoreid:9999,
    tillid:99995000, terminalid:5000
Then ResultCode should be 1513
!-- 1513 = other users still logged on

Scenario: 1 user with same till still logged on
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_DEVICEINFO dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
Given a RESTransaction DBInitiator
Given a RESTransaction TXU_POS_CTRL_scenario2 dataset
Then RESMaster MST_DEVICEINFO should have the following row(s): 

|StoreId|TerminalId|TillId|
|9999|5000|99995000|
|9999|5001|99995001|
|9999|5002|99995000|
|9999|5003|99995001|
|9999|5004|99995000|

Then RESTransaction TXU_POS_CTRL should have the following row(s): 

|StoreId|TerminalNo|OpeCode|
|9999|5000|7000|
|9999|5001|7001|
|9999|5002|null|
|9999|5003|7003|
|9999|5004|7004|

When I perform a search request with retailstoreid:9999,
    tillid:99995000, terminalid:5000
Then ResultCode should be 1513
!-- 1513 = other users still logged on

Scenario: no users with same till still logged on (opecode=null)
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_DEVICEINFO dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
Given a RESTransaction DBInitiator
Given a RESTransaction TXU_POS_CTRL_scenario3 dataset
Then RESMaster MST_DEVICEINFO should have the following row(s): 

|StoreId|TerminalId|TillId|
|9999|5000|99995000|
|9999|5001|99995001|
|9999|5002|99995000|
|9999|5003|99995001|
|9999|5004|99995000|

Then RESTransaction TXU_POS_CTRL should have the following row(s): 

|StoreId|TerminalNo|OpeCode|
|9999|5000|7000|
|9999|5001|7001|
|9999|5002|null|
|9999|5003|7003|
|9999|5004|null|

When I perform a search request with retailstoreid:9999,
    tillid:99995000, terminalid:5000
Then ResultCode should be 0
!-- 0 = ok

Scenario: no users with same till still logged on (opecode='')
Given a TillInfoResource Resource
Given a RESMaster DBInitiator
Given a RESMaster MST_DEVICEINFO dataset
Given a RESMaster MST_TILLIDINFO_EOD dataset
Given a RESTransaction DBInitiator
Given a RESTransaction TXU_POS_CTRL_scenario4 dataset
Then RESMaster MST_DEVICEINFO should have the following row(s): 

|StoreId|TerminalId|TillId|
|9999|5000|99995000|
|9999|5001|99995001|
|9999|5002|99995000|
|9999|5003|99995001|
|9999|5004|99995000|

Then RESTransaction TXU_POS_CTRL should have the following row(s): 

|StoreId|TerminalNo|OpeCode|
|9999|5000|7000|
|9999|5001|7001|
|9999|5002||
|9999|5003|7003|
|9999|5004||

When I perform a search request with retailstoreid:9999,
    tillid:99995000, terminalid:5000
Then ResultCode should be 0
!-- 0 = ok



(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 82 stories (of which 0 pending) containing 658 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.174 sec - in ncr.res.mobilepos.tillinfo.resource.test.SearchLogonUsersTest
Running ncr.res.mobilepos.tillinfo.resource.test.ViewTillInfoResourceTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/tillinfo/resource/test/view_till_info_resource_test.scenario

(ncr/res/mobilepos/tillinfo/resource/test/view_till_info_resource_test.scenario)
Scenario: View detail of an existing till
DataSet:test/ncr/res/mobilepos/tillinfo/resource/test/MST_TILLIDINFO.xml
Given a TillResource
When I view till detail of storeid: es185 and tillid:	es134
Then I should get resultcode equal to 0
Then I should get till details: 

|storeid|tillid|businessdaydate|sodflag|eodflag|
|es185|es134|1989-03-02|9|9|


Scenario: View detail of non-existing till
DataSet:test/ncr/res/mobilepos/tillinfo/resource/test/MST_TILLIDINFO.xml
Using timeout for story view_till_info_resource_test.scenario of 300 secs.
Given a TillResource
When I view till detail of storeid: 10000 and tillid: es134
Then I should get resultcode equal to 1500
Then I should get till details:

|storeid|tillid|businessdaydate|sodflag|eodflag|
|10000|es134|null|null|null|


Scenario: View detail with null parameters
DataSet:test/ncr/res/mobilepos/tillinfo/resource/test/MST_TILLIDINFO.xml
Given a TillResource
When I view till detail of storeid: null and tillid:	null
Then I should get resultcode equal to 1500
Then I should get till details: 

|storeid|tillid|businessdaydate|sodflag|eodflag|
|null|null|null|null|null|


Scenario: View detail with empty parameters
DataSet:test/ncr/res/mobilepos/tillinfo/resource/test/MST_TILLIDINFO.xml
Given a TillResource
When I view till detail of storeid: {} and tillid:	{}
Then I should get resultcode equal to 1500
Then I should get till details: 

|storeid|tillid|businessdaydate|sodflag|eodflag|
|||null|null|null|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 83 stories (of which 0 pending) containing 662 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.184 sec - in ncr.res.mobilepos.tillinfo.resource.test.ViewTillInfoResourceTest
Running ncr.res.mobilepos.userloginlogout.test.UserLoginTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/userloginlogout/test/user_login_test.scenario

(ncr/res/mobilepos/userloginlogout/test/user_login_test.scenario)
Scenario: SignOn Success [Before SOD]
Given an initial data from data_users.xml
Given a companyid 01 storeid 0247 terminalid 0001
When I login with operator 9011011 passcode 9011011 demo false
Using timeout for story user_login_test.scenario of 300 secs.
Then I should get the following operator details:

|ncrwssresultcode|operatorname|operatorkananame|operatortype|isTransactions|isReports|isSettings|isMerchandise|isAdministration|isDrawer|
|0|îƒópîÃîÑàı3| ›÷≥ › ﬁ≤≤›3|1|false|false|false|false|false|false|

Then I should get the following operator security status:

|ncrwssresultcode|securitylevel|isSecLevel1|isSecLevel2|isSecLevel3|isSecLevel4|isSecLevel5|isSecLevel6|isSecLevel7|isSecLevel8|isSecLevel9|isSecLevel10|isSecLevel11|isSecLevel12|isSecLevel13|isSecLevel14|isSecLevel15|
|0|1|true|true|true|true|true|true|true|false|false|false|false|false|false|false|false|

Then I should get the following till details:

|ncrwssresultcode|businessdaydate|sodflag|eodflag|
|0|2016-07-28|0|1|


Scenario: SignOn Success [After SOD]
Given that SOD has started data_start_sod.xml
Given a companyid 01 storeid 0247 terminalid 0001
When I login with operator 9011011 passcode 9011011 demo false
Then I should get the following operator details:

|ncrwssresultcode|operatorname|operatorkananame|operatortype|isTransactions|isReports|isSettings|isMerchandise|isAdministration|isDrawer|
|0|îƒópîÃîÑàı3| ›÷≥ › ﬁ≤≤›3|1|false|false|false|false|false|false|

Then I should get the following operator security status:

|ncrwssresultcode|securitylevel|isSecLevel1|isSecLevel2|isSecLevel3|isSecLevel4|isSecLevel5|isSecLevel6|isSecLevel7|isSecLevel8|isSecLevel9|isSecLevel10|isSecLevel11|isSecLevel12|isSecLevel13|isSecLevel14|isSecLevel15|
|0|1|true|true|true|true|true|true|true|false|false|false|false|false|false|false|false|

Then I should get the following till details:

|ncrwssresultcode|businessdaydate|sodflag|eodflag|
|0|2016-07-28|1|0|


Scenario: SignOn Failed [Wrong Password]
Given a companyid 01 storeid 0247 terminalid 0001
When I login with operator 9011011 passcode 1 demo false
Then I should get the following operator details:

|ncrwssresultcode|
|306|


Scenario: SignOn Failed [User Not Found]
Given a companyid 01 storeid 0247 terminalid 0001
When I login with operator 1 passcode 9011011 demo false
Then I should get the following operator details:

|ncrwssresultcode|
|305|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 84 stories (of which 0 pending) containing 666 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.022 sec - in ncr.res.mobilepos.userloginlogout.test.UserLoginTest
Running ncr.res.mobilepos.userloginlogout.test.UserLogoutTest
Processing system properties {}
Using controls EmbedderControls[batch=false,skip=false,generateViewAfterStories=true,ignoreFailureInStories=false,ignoreFailureInView=false,verboseFailures=false,verboseFiltering=false,storyTimeouts=300,threads=1,failOnStoryTimeout=false]

(BeforeStories)

Running story ncr/res/mobilepos/userloginlogout/test/user_logout_test.scenario

(ncr/res/mobilepos/userloginlogout/test/user_logout_test.scenario)
Scenario: Manual sign-out from the side panel
Using timeout for story user_logout_test.scenario of 300 secs.
Given that user is existing and signon
Given that no transactions
When credential signoff with operatorid:9011011
Then it should get NCRWSSResultCode:0
Then MST_USER_CREDENTIALS should have the following:

|TerminalId|
|null|

When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1643</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-06T14:10:23</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-06T14:10:23</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1643|2016-08-09|0|SignOff|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>SignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1643</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-06T14:10:23</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-06T14:10:23</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><OperatorSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></OperatorSignOff></ControlTransaction></Transaction></POSLog>|


Scenario: At home screen while cart is not empty - left the application on idle to test auto-sign-out
Given that user is existing and signon
Given that no transactions
When credential signoff with operatorid:9011011
Then it should get NCRWSSResultCode:0
Then MST_USER_CREDENTIALS should have the following:

|TerminalId|
|null|

When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1673</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-11T16:58:07</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-11T16:58:07</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><AutoSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></AutoSignOff></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1673|2016-08-09|0|AutoSignOff|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1673</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-11T16:58:07</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-11T16:58:07</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><AutoSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></AutoSignOff></ControlTransaction></Transaction></POSLog>|


Scenario: At sales screen left the application on idle to test auto-sign-out
Given that user is existing and signon
Given that no transactions
When credential signoff with operatorid:9011011
Then it should get NCRWSSResultCode:0
Then MST_USER_CREDENTIALS should have the following:

|TerminalId|
|null|

When saving poslogxml:<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1674</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-11T16:58:07</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-11T16:58:07</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><AutoSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></AutoSignOff></ControlTransaction></Transaction></POSLog>, trainingmode:0
Then it should get NCRWSSResultCode:0
Then TXL_SALES_JOURNAL table should have:

|CompanyId|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|TrainingFlag|TxType|ServerId|Status|SendStatus1|SendStatus2|EjStatus|Tx|
|01|0247|0001|1674|2016-08-09|0|AutoSignOff|A010|0|0|0|0|<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><TransactionType>AutoSignOff</TransactionType><OrganizationHierarchy Level="äîéÆâÔé–" ID="01" /><RetailStoreID>0247</RetailStoreID><WorkstationID TerminalType="1">0001</WorkstationID><SequenceNumber>1674</SequenceNumber><BusinessDayDate>2016-08-09</BusinessDayDate><BeginDateTime>2017-04-11T16:58:07</BeginDateTime><OperatorID OperatorName="îƒópîÃîÑàı3" OperatorNameKana=" ›÷≥ › ﬁ≤≤›3">9011011</OperatorID><ReceiptDateTime>2017-04-11T16:58:07</ReceiptDateTime><TillID>02470001</TillID><BusinessUnit Name="äùèÍí¨ìX" VoucherName="äùèÍí¨ìX"><Telephone><FullTelephoneNumber>000-1111-2222</FullTelephoneNumber><VoucherTelephoneNumber>000-1111-2222</VoucherTelephoneNumber></Telephone><Address>ìåãûìsíÜâõãÊêVêÏ 0-0-0</Address></BusinessUnit><ControlTransaction Version="2.2"><AutoSignOff Accountability="Operator"><SoftwareVersion>{&quot;Container&quot;:&quot;5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36&quot;,&quot;RESTabletUI&quot;:&quot;3.2.0.13.&quot;,&quot;RESUiConfig&quot;:&quot;3.2.0.13.&quot;,&quot;RESTransaction&quot;:&quot;3.2.0.7-SNAPSHOT(2016/10/12)&quot;}</SoftwareVersion></AutoSignOff></ControlTransaction></Transaction></POSLog>|




(AfterStories)

Generating reports view to 'D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\jbehave' using formats '[stats, console, txt, html, xml]' and view properties '{navigator=ftl/jbehave-navigator.ftl, views=ftl/jbehave-views.ftl, reports=ftl/jbehave-reports.ftl, nonDecorated=ftl/jbehave-report-non-decorated.ftl, decorated=ftl/jbehave-report-decorated.ftl, maps=ftl/jbehave-maps.ftl}'
Reports view generated with 85 stories (of which 0 pending) containing 669 scenarios (of which 0 pending)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.691 sec - in ncr.res.mobilepos.userloginlogout.test.UserLogoutTest

Results :

Tests run: 134, Failures: 0, Errors: 0, Skipped: 3

[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.9:restore-instrumented-classes (default-restore-instrumented-classes) @ temp ---
[INFO] Skipping JaCoCo execution because property jacoco.skip is set.
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.9:report (default-report) @ temp ---
[INFO] Skipping JaCoCo execution because property jacoco.skip is set.
[INFO] 
[INFO] --- maven-war-plugin:2.3:war (default-war) @ temp ---
[INFO] Packaging webapp
[INFO] Assembling webapp [temp] in [D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\temp]
[INFO] Processing war project
[INFO] Copying webapp webResources [D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\WebContent] to [D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\temp]
[INFO] Webapp assembled in [634 msecs]
[INFO] Building war: D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\temp.war
[INFO] 
[INFO] --- swagger-maven-plugin:2.3.3:generate (default) @ temp ---
[INFO] Detect Resource:ncr.res.mobilepos.queuesignature.resource.QueueSignatureResource
[INFO] Detect Resource:ncr.res.mobilepos.promotion.resource.PromotionResource
[INFO] Detect Resource:ncr.res.mobilepos.searchapi.resource.SearchApiResource
[INFO] Detect Resource:ncr.res.mobilepos.authentication.resource.AuthenticationResource
[INFO] Detect Resource:ncr.res.mobilepos.forwarditemlist.resource.ForwardItemListResource
[INFO] Detect Resource:ncr.res.mobilepos.discountplaninfo.resource.PromotionInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.pricing.resource.ItemResource
[INFO] Detect Resource:ncr.res.mobilepos.devicelog.resource.DeviceLogResource
[INFO] Detect Resource:ncr.res.mobilepos.credential.resource.CredentialResource
[INFO] Detect Resource:ncr.res.mobilepos.test.resource.TestResource
[INFO] Detect Resource:ncr.res.mobilepos.creditcard.resource.CreditCardResource
[INFO] Detect Resource:ncr.res.mobilepos.authentication.resource.CorpStoreResource
[INFO] Detect Resource:ncr.res.mobilepos.console.resource.JavaScriptConsoleResource
[INFO] Detect Resource:ncr.res.mobilepos.initialization.resource.InitializationStatusResource
[INFO] Detect Resource:ncr.res.mobilepos.promotion.resource.EnterpriseDepartmentResource
[INFO] Detect Resource:ncr.res.mobilepos.tenderinfo.resource.TenderInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.nationalityinfo.resource.NationalityInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.tillinfo.resource.TillInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.poslogstatus.resource.PoslogStatusResource
[INFO] Detect Resource:ncr.res.mobilepos.report.resource.ReportResource
[INFO] Detect Resource:ncr.res.mobilepos.authentication.resource.AdminResource
[INFO] Detect Resource:ncr.res.mobilepos.department.resource.DepartmentResource
[INFO] Detect Resource:ncr.res.mobilepos.cashAbstract.resource.CashAbstractResource
[INFO] Detect Resource:ncr.res.mobilepos.mastermaintenance.resource.MasterMaintenanceResource
[INFO] Detect Resource:ncr.res.mobilepos.settlement.resource.SettlementResource
[INFO] Detect Resource:ncr.res.mobilepos.buyadditionalinfo.resource.BuyadditionalInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.futurePay.resource.FuturePayResource
[INFO] Detect Resource:ncr.res.mobilepos.promotion.resource.RemoteItemResource
[INFO] Detect Resource:ncr.res.mobilepos.customerSearch.resource.CustomerSearchResource
[INFO] Detect Resource:ncr.res.mobilepos.customerclass.resource.CustomerClassInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.uiconfig.resource.UiConfigResource
[INFO] Detect Resource:ncr.res.mobilepos.giftcard.resource.ToppanGiftcardResource
[INFO] Detect Resource:ncr.res.mobilepos.customeraccount.resource.CustomerAccountResource
[INFO] Detect Resource:ncr.res.mobilepos.store.resource.StoreResource
[INFO] Detect Resource:ncr.res.mobilepos.uiconfig.resource.UiConfigMaintenanceResource
[INFO] Detect Resource:ncr.res.mobilepos.deviceinfo.resource.DeviceInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.queuebuster.resource.QueueBusterResource
[INFO] Detect Resource:ncr.res.mobilepos.systemsetting.resource.SystemSettingResource
[INFO] Detect Resource:ncr.res.mobilepos.barcode.resource.BarCodeResource
[INFO] Detect Resource:ncr.res.mobilepos.posmailinfo.resource.POSMailInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.taxrate.resource.TaxRateResource
[INFO] Detect Resource:ncr.res.mobilepos.journalization.resource.JournalizationResource
[INFO] Detect Resource:ncr.res.mobilepos.appserver.resource.AppServerResource
[INFO] Detect Resource:ncr.res.mobilepos.discountplaninfo.resource.DiscountPlanInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.pointserver.resource.BoInterface
[INFO] Detect Resource:ncr.res.mobilepos.systemconfiguration.resource.SystemConfigurationResource
[INFO] Detect Resource:ncr.res.mobilepos.cashaccount.resource.CashAccountResource
[INFO] Detect Resource:ncr.res.mobilepos.webserviceif.resource.WebServiceIfResource
[INFO] Detect Resource:ncr.res.mobilepos.cardinfo.resource.CardInfoResource
[INFO] Detect Resource:ncr.res.mobilepos.discountplaninfo.resource.PremiumFlagResource
[INFO] Detect Resource:ncr.res.mobilepos.employee.resource.EmployeeResource
[INFO] Detect Resource:ncr.res.mobilepos.authentication.resource.RegistrationResource
[INFO] Detect Resource:ncr.res.mobilepos.point.resource.PointResource
[INFO] Detect Resource:ncr.res.mobilepos.eventlog.resource.EventLogResource
[INFO] Detect Resource:ncr.res.mobilepos.offlinecredit.resource.OfflineCreditResource
[INFO] Detect Resource:ncr.res.mobilepos.softwareinfo.resource.SoftwareInfo
[INFO] Writing doc to D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target/api_document.html...
[INFO] Done!
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\service.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\QueueSignature.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\promotion.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\SearchApi.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\authentication.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\ItemForward.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\discountplaninfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\pricing.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\devicelog.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\credential.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\Test.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\creditcard.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\registration\corpstore.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\console.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\initialization.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\enterprisedpt.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\tenderinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\nationalityinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\till.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\poslogstatus.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\report.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\admin.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\departmentinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\cashAbstract.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\mastermaintenance.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\Settlement.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\buyadditionalinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\futurePay.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\remoteitem.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\customerSearch.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\customerclass.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\uiconfig.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\giftcard.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\customeraccount.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\storeinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\uiconfigMaintenance.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\deviceinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\QueueSuspend.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\SystemSettings.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\barcode.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\posmailinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\TaxRate.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\transaction.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\servertable.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\discountplan.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\POINTAPI.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\SystemConfiguration.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\cashaccount.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\WebServiceIf.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\cardinfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\premiumInfo.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\employee.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\registration.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\point.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\eventlog.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\offlinecredit.json
[INFO] Creating file D:\Eclipse_Kinokuniya_WorkSpace_New\RESTransactionService_trunk\target\swagger-ui_data\softwareinfo.json
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 03:21 min
[INFO] Finished at: 2018-10-30T15:48:51+08:00
[INFO] Final Memory: 49M/655M
[INFO] ------------------------------------------------------------------------
