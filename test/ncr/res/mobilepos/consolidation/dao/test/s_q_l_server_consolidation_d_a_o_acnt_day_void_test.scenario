Scenario: Setup Consolidation
Given an instance of SQLServerConsolidationDAO
Then its Database Manager must have been settled

Scenario: TXU_TOTAL_ACNTDAY consolidate voided tx
Given a sample {TXL_POSLOG_AcntDay_Void} poslog xml entry in database 
When I select a non-consolidated transaction information
!-- Consolidate txid=0102
When I consolidate top {1} items
!-- TXU_TOTAL_ACNTDAY Results tx=11
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voider transaction same parameters
When I consolidate top {1} items
!-- TXU_TOTAL_ACNTDAY Results txid=12
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different timezone
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=13 to 14
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different operator
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=15 to 16
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different terminalid
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=17 to 18
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-06		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|7999		|2012-05-06		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different terminalid/operator/multiple items
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=18 to 19
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-06		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|7999		|2012-05-06		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|8887		|2012-05-08		|6				|0181	|0181	|000001	|111			|20				|0				|8800			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|8888		|2012-05-08		|6				|0181	|0181	|000001	|222			|-20			|0				|-8800			|0				|0				|0				|20			|0			|8800			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different terminalid/operator/multiple items/with item discount
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=18 to 19
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-06		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|7999		|2012-05-06		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|8887		|2012-05-08		|6				|0181	|0181	|000001	|111			|20				|0				|8800			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|8888		|2012-05-08		|6				|0181	|0181	|000001	|222			|-20			|0				|-8800			|0				|0				|0				|20			|0			|8800			|0			|0			|0			|
|000000000000	|000031		|8889		|2012-05-09		|6				|0181	|0181	|000001	|111			|40				|0				|15840			|0				|0				|0				|0			|0			|0				|40			|0			|1760		|
|000000000000	|000031		|9001		|2012-05-09		|6				|0181	|0181	|000001	|222			|-40			|0				|-15840			|0				|0				|0				|40			|0			|15840			|-40		|0			|-1760		|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different summarydateid
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=18 to 19
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-06		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|7999		|2012-05-06		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|8887		|2012-05-08		|6				|0181	|0181	|000001	|111			|20				|0				|8800			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|8888		|2012-05-08		|6				|0181	|0181	|000001	|222			|-20			|0				|-8800			|0				|0				|0				|20			|0			|8800			|0			|0			|0			|
|000000000000	|000031		|8889		|2012-05-09		|6				|0181	|0181	|000001	|111			|40				|0				|15840			|0				|0				|0				|0			|0			|0				|40			|0			|1760		|
|000000000000	|000031		|9001		|2012-05-09		|6				|0181	|0181	|000001	|222			|-40			|0				|-15840			|0				|0				|0				|40			|0			|15840			|-40		|0			|-1760		|
|000000000000	|000031		|9002		|2012-05-11		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|9002		|2012-05-12		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|

!-- TXU_TOTAL_ACNTDAY consolidate voided and voider tx different summarydateid/ duplicated txid, different summarydateid
When I consolidate top {2} items
!-- TXU_TOTAL_ACNTDAY Results txid=18 to 19
Then I should get the following TXU_TOTAL_ACNTDAY results: 
|corpid			|storeid	|terminalid	|summarydateid	|timezonecode	|dpt	|line	|class	|Operatorcode	|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt|VoidCostAmt|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|6785		|2012-05-03		|11				|0181	|0181	|000001	|111			|0				|0				|0				|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|10				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-04		|16				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-05		|11				|0181	|0181	|000001	|222			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|6785		|2012-05-06		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|7999		|2012-05-06		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|8887		|2012-05-08		|6				|0181	|0181	|000001	|111			|20				|0				|8800			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|8888		|2012-05-08		|6				|0181	|0181	|000001	|222			|-20			|0				|-8800			|0				|0				|0				|20			|0			|8800			|0			|0			|0			|
|000000000000	|000031		|8889		|2012-05-09		|6				|0181	|0181	|000001	|111			|40				|0				|15840			|0				|0				|0				|0			|0			|0				|40			|0			|1760		|
|000000000000	|000031		|9001		|2012-05-09		|6				|0181	|0181	|000001	|222			|-40			|0				|-15840			|0				|0				|0				|40			|0			|15840			|-40		|0			|-1760		|
|000000000000	|000031		|9002		|2012-05-11		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|9002		|2012-05-12		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|
|000000000000	|000031		|9002		|2012-05-13		|11				|0181	|0181	|000001	|111			|1				|0				|440			|0				|0				|0				|0			|0			|0				|0			|0			|0			|
|000000000000	|000031		|9002		|2012-05-14		|11				|0181	|0181	|000001	|111			|-1				|0				|-440			|0				|0				|0				|1			|0			|440			|0			|0			|0			|


