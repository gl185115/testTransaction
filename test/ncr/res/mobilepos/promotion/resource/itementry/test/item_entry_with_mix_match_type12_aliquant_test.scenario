Scenario: Test Item Entry with MixMatch Type 11 Aliquant
When the Web API Starts Up
Given a Promotion Service
Given a loaded dataset {items_for_aliquant_mixmatch.xml}
Given a loaded dataset {mixmatch_aliquant_promotions.xml}

Scenario: Item Entry (1 Step Unifromity Successful) 
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"1200000000002","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |1200000000002|EAN-13    |1       |0143      |Item A       |çÄñ⁄A         |1980.0               |0.0     |0.0           |1980.0              |1980.0        |True        |0                |0         |
Then there should be no promotion data.

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"1200000000003","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |1200000000003|EAN-13    |1       |0143      |Item AA      |çÄñ⁄AA        |1350.0               |0.0     |0.0           |1350.0              |1350.0        |True        |1                |1         |
Then there should be no promotion data.

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00003      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |1062|
|2       |1201          |1201         |2StepUniByAmount MM      |00001      |1051|
|3       |1201          |1201         |2StepUniByAmount MM      |00002      |717|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00003","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":1062,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":1051,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":717,"Quantity":1}],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be no revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00004      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |1029|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |1029|
|3       |1201          |1201         |2StepUniByAmount MM      |00001      |1019|
|4       |1201          |1201         |2StepUniByAmount MM      |00002      |696|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00004","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":1029,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":1029,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":1019,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":696,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00005","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00005      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |1011|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |1011|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |1011|
|4       |1201          |1201         |2StepUniByAmount MM      |00001      |1001|
|5       |1201          |1201         |2StepUniByAmount MM      |00002      |682|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00005","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":1011,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":1011,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":1011,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":1001,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":682,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00006","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00006      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |999|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |999|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |999|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |999|
|5       |1201          |1201         |2StepUniByAmount MM      |00001      |989|
|6       |1201          |1201         |2StepUniByAmount MM      |00002      |675|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00006","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":999,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":999,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":999,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":999,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":989,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":675,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

Scenario: Item Entry (2 Step Unifromity Successful) 
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00007","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00007      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |451|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |451|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |451|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |451|
|5       |1201          |1201         |2StepUniByAmount MM      |00007      |451|
|6       |1201          |1201         |2StepUniByAmount MM      |00001      |446|
|7       |1201          |1201         |2StepUniByAmount MM      |00002      |304|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00007","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":451,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":451,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":451,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":451,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00007","UnitDiscountAmt":451,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":446,"Quantity":1},{"RewardID":7,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":304,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00008","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00008      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |448|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |448|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |448|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |448|
|5       |1201          |1201         |2StepUniByAmount MM      |00007      |448|
|6       |1201          |1201         |2StepUniByAmount MM      |00008      |448|
|7       |1201          |1201         |2StepUniByAmount MM      |00001      |444|
|8       |1201          |1201         |2StepUniByAmount MM      |00002      |302|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00008","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":448,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":448,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":448,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":448,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00007","UnitDiscountAmt":448,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00008","UnitDiscountAmt":448,"Quantity":1},{"RewardID":7,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":444,"Quantity":1},{"RewardID":8,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":302,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00009","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":5}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00009      |1200000000004|EAN-13    |5       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |10000.0       |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |441|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |441|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |441|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |441|
|5       |1201          |1201         |2StepUniByAmount MM      |00007      |441|
|6       |1201          |1201         |2StepUniByAmount MM      |00008      |441|
|7       |1201          |1201         |2StepUniByAmount MM      |00009      |2205|
|8       |1201          |1201         |2StepUniByAmount MM      |00001      |436|
|9       |1201          |1201         |2StepUniByAmount MM      |00002      |292|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00009","ItemIDType":"EAN-13","Quantity":5,"ExtendedAmount":10000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":441,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":441,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":441,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":441,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00007","UnitDiscountAmt":441,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00008","UnitDiscountAmt":441,"Quantity":1},{"RewardID":7,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00009","UnitDiscountAmt":2205,"Quantity":5},{"RewardID":8,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":436,"Quantity":1},{"RewardID":9,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":292,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00010","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00010      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |440|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |440|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |440|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |440|
|5       |1201          |1201         |2StepUniByAmount MM      |00007      |440|
|6       |1201          |1201         |2StepUniByAmount MM      |00008      |440|
|7       |1201          |1201         |2StepUniByAmount MM      |00009      |2200|
|8       |1201          |1201         |2StepUniByAmount MM      |00010      |440|
|9       |1201          |1201         |2StepUniByAmount MM      |00001      |435|
|10      |1201          |1201         |2StepUniByAmount MM      |00002      |295|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00010","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":440,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":440,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":440,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":440,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00007","UnitDiscountAmt":440,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00008","UnitDiscountAmt":440,"Quantity":1},{"RewardID":7,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00009","UnitDiscountAmt":2200,"Quantity":5},{"RewardID":8,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00010","UnitDiscountAmt":440,"Quantity":1},{"RewardID":9,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":435,"Quantity":1},{"RewardID":10,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":295,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00011","ItemID":"1200000000004","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN|DescriptionJP|RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00011      |1200000000004|EAN-13    |1       |0143      |Item G       |çÄñ⁄G         |2000.0               |0.0     |0.0           |2000.0              |2000.0        |True        |0                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |1201          |1201         |2StepUniByAmount MM      |00003      |439|
|2       |1201          |1201         |2StepUniByAmount MM      |00004      |439|
|3       |1201          |1201         |2StepUniByAmount MM      |00005      |439|
|4       |1201          |1201         |2StepUniByAmount MM      |00006      |439|
|5       |1201          |1201         |2StepUniByAmount MM      |00007      |439|
|6       |1201          |1201         |2StepUniByAmount MM      |00008      |439|
|7       |1201          |1201         |2StepUniByAmount MM      |00009      |2195|
|8       |1201          |1201         |2StepUniByAmount MM      |00010      |439|
|9       |1201          |1201         |2StepUniByAmount MM      |00011      |439|
|10      |1201          |1201         |2StepUniByAmount MM      |00001      |435|
|11      |1201          |1201         |2StepUniByAmount MM      |00002      |297|
Then the JSON should have the following format :
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"1200000000004","Department":"0143","Description":{"en":"Item G","jp":"çÄñ⁄G"},"RegularSalesUnitPrice":2000.0,"Discount":0.0,"DiscountFlag":0,"DiscountAmount":0.0,"ActualSalesUnitPrice":2000.0,"Discountable":true,"TaxRate":0,"TaxType":0,"DiscountType":0,"NonSales":0,"SubInt10":0,"Line":"0143","Class":"000001","AgeRestrictedFlag":0,"EmpPrice1":2000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00011","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":2000.0,"InputType":0},"EntryFlag":0},"Promotion":{"Discount":[{"RewardID":1,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00003","UnitDiscountAmt":439,"Quantity":1},{"RewardID":2,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00004","UnitDiscountAmt":439,"Quantity":1},{"RewardID":3,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00005","UnitDiscountAmt":439,"Quantity":1},{"RewardID":4,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00006","UnitDiscountAmt":439,"Quantity":1},{"RewardID":5,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00007","UnitDiscountAmt":439,"Quantity":1},{"RewardID":6,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00008","UnitDiscountAmt":439,"Quantity":1},{"RewardID":7,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00009","UnitDiscountAmt":2195,"Quantity":5},{"RewardID":8,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00010","UnitDiscountAmt":439,"Quantity":1},{"RewardID":9,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00011","UnitDiscountAmt":439,"Quantity":1},{"RewardID":10,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00001","UnitDiscountAmt":435,"Quantity":1},{"RewardID":11,"EarnedRewardID":"1201","PromotionCode":"1201","DiscountDescription":"2StepUniByAmount MM","ItemEntryID":"00002","UnitDiscountAmt":297,"Quantity":1}],"Revoke":{"EarnedRewardID":"1201"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}
Then there should be revoke