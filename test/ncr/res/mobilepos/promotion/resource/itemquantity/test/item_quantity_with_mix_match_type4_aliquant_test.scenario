Scenario: Test Item Entry with MixMatch Type 4 Aliquant Case
When the Web API Starts Up
Given a Promotion Service
Given a loaded dataset {items_for_aliquant_mixmatch.xml}
Given a loaded dataset {mixmatch_aliquant_promotions.xml}

!-- MMQ1 = 2;   MMP1 = 525
!-- MMQ2 = 6;   MMP2 = 1600
Scenario: Test Mix Match Aliquant for Second Step Uniformity (1st step MixMatch Occurence)
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"4444444444442","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|Description       |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|
|00001      |4444444444442|EAN-13    |1       |0143      |aliquant product 2|546.0                |0%      |0.0           |546.0               |546.0         |True|

When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"4444444444441","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|Description       |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|
|00002      |4444444444441|EAN-13    |1       |0143      |aliquant product 1|300.0                |0%      |0.0           |300.0               |300.0         |True|
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |4014          |4014         |Mix Match Aliquant Type 4|00001      |207|
|2       |4014          |4014         |Mix Match Aliquant Type 4|00002      |114|

Scenario: Update Item (1stitem: 1 and 2ndItem: 12)
When I request to update Item Quantity at promotion with parameters RetailStoreID{0031} WorkStationID{1111} SequenceNo{1} and TransactionJson{{"EntryFlag": 2,"Sale":{"ItemEntryID":"00002","Quantity":"11"}}}
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription      |ItemEntryID|UnitDiscountAmount|
|1       |4014          |4014         |Mix Match Aliquant Type 4|00001      |89|
|2       |4014          |4014         |Mix Match Aliquant Type 4|00002      |590|