Scenario: Test Item Entry without Promotion Data.
When the Web API Starts Up
Given a Promotion Service
Given a loaded dataset {items_nodiscount.xml}

Scenario: Item Entry with No begin Transaction
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}
Then the Result Code is 1102

Scenario: Item Entry with no retail store id
When a Item Entry at promotion with parameters RetailStoreID{} WorkStationId{1111} SequenceNo{1} TransactionJson{{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}
Then the Result Code is 154

Scenario: Item Entry with no workstation id
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{} SequenceNo{1} TransactionJson{{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}
Then the Result Code is 154

Scenario: Item Entry with no sequence number
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{} TransactionJson{{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}
Then the Result Code is 154

Scenario: Item Entry with no transaction
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{}
Then the Result Code is 154

Scenario: Item Entry with Invalid Transaction 1
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{asdas}
Then the Result Code is 154

Scenario: Item Entry with Invalid Transaction 2
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with No begin Transaction (other device)
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1112} SequenceNo{1} TransactionJson{{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}
Then the Result Code is 1102

Scenario: Item Entry with Item Not Found
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 801
Then the JSON should have the following format : 
{"NCRWSSResultCode":801,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry Empty ItemId
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 801
Then the JSON should have the following format : 
{"NCRWSSResultCode":801,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry Empty ItemEntryId
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"","ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry No ItemEntryId
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemID":"4900000000153","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry no ItemId
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 801
Then the JSON should have the following format : 
{"NCRWSSResultCode":801,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Found but no quantity
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13"}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Found but 0 quantity
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":0}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Found but invalid quantity 1
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":-1}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Found but invalid quantity 2
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":asdasd}}}
Then the Result Code is 154
Then the JSON should have the following format : 
{"NCRWSSResultCode":154,"NCRWSSExtendedResultCode":154}

Scenario: Item Entry with Item Found
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then the JSON should have the following format : 
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"8888884456992","Department":"0130","Description":{"en":"sample product 1","jp":"サンプル製品1"},"RegularSalesUnitPrice":4000.0,"Discount":0.0,"DiscountFlag":-1,"DiscountAmount":0.0,"ActualSalesUnitPrice":4000.0,"Discountable":false,"TaxRate":0,"TaxType":1,"DiscountType":1,"NonSales":1,"SubInt10":0,"Line":"0130","Class":"000004","AgeRestrictedFlag":0,"CouponFlag":"1","EmpPrice1":4000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00001","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":4000.0,"InputType":0},"EntryFlag":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Entry Id already existing
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 93
Then the JSON should have the following format : 
{"NCRWSSResultCode":93,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Item Entry Id different
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then the JSON should have the following format : 
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"8888884456992","Department":"0130","Description":{"en":"sample product 1","jp":"サンプル製品1"},"RegularSalesUnitPrice":4000.0,"Discount":0.0,"DiscountFlag":-1,"DiscountAmount":0.0,"ActualSalesUnitPrice":4000.0,"Discountable":false,"TaxRate":0,"TaxType":1,"DiscountType":1,"NonSales":1,"SubInt10":0,"Line":"0130","Class":"000004","AgeRestrictedFlag":0,"CouponFlag":"1","EmpPrice1":4000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00002","ItemIDType":"EAN-13","Quantity":1,"ExtendedAmount":4000.0,"InputType":0},"EntryFlag":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry for item with multiple quantity  
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":10}}}
Then the Result Code is 0
Then the JSON should have the following format : 
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"8888884456992","Department":"0130","Description":{"en":"sample product 1","jp":"サンプル製品1"},"RegularSalesUnitPrice":4000.0,"Discount":0.0,"DiscountFlag":-1,"DiscountAmount":0.0,"ActualSalesUnitPrice":4000.0,"Discountable":false,"TaxRate":0,"TaxType":1,"DiscountType":1,"NonSales":1,"SubInt10":0,"Line":"0130","Class":"000004","AgeRestrictedFlag":0,"CouponFlag":"1","EmpPrice1":4000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00003","ItemIDType":"EAN-13","Quantity":10,"ExtendedAmount":40000.0,"InputType":0},"EntryFlag":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with transaction already ended
When I end the transaction at promotion with retailstoreid{0031} workstationid{1111} sequencenumber{1} and transactionJson{{"Status":"1","EndDateTime":"2012-12-20T09:30:47.00"}}
Then the Result Code is 0
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":10}}}
Then the Result Code is 1102

Scenario: Item Entry for item with multiple quantity
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}  
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":10}}}
Then the Result Code is 0
Then the JSON should have the following format : 
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"8888884456992","Department":"0130","Description":{"en":"sample product 1","jp":"サンプル製品1"},"RegularSalesUnitPrice":4000.0,"Discount":0.0,"DiscountFlag":-1,"DiscountAmount":0.0,"ActualSalesUnitPrice":4000.0,"Discountable":false,"TaxRate":0,"TaxType":1,"DiscountType":1,"NonSales":1,"SubInt10":0,"Line":"0130","Class":"000004","AgeRestrictedFlag":0,"CouponFlag":"1","EmpPrice1":4000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00003","ItemIDType":"EAN-13","Quantity":10,"ExtendedAmount":40000.0,"InputType":0},"EntryFlag":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry for item with multiple quantity
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":10}}}
Then the Result Code is 0
Then the JSON should have the following format : 
{"Transaction":{"TransactionMode":0,"Sale":{"ItemID":"8888884456992","Department":"0130","Description":{"en":"sample product 1","jp":"サンプル製品1"},"RegularSalesUnitPrice":4000.0,"Discount":0.0,"DiscountFlag":-1,"DiscountAmount":0.0,"ActualSalesUnitPrice":4000.0,"Discountable":false,"TaxRate":0,"TaxType":1,"DiscountType":1,"NonSales":1,"SubInt10":0,"Line":"0130","Class":"000004","AgeRestrictedFlag":0,"CouponFlag":"1","EmpPrice1":4000.0,"PSType":"","OrgSalesPrice1":0.0,"ItemEntryID":"00004","ItemIDType":"EAN-13","Quantity":10,"ExtendedAmount":40000.0,"InputType":0},"EntryFlag":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Remove an item (EntryID:00003, qty: 0) but was no Mix Match triggered
When I request to update Item Quantity at promotion with parameters RetailStoreID{0031} WorkStationID{1111} SequenceNo{1} and TransactionJson{{"EntryFlag": 2,"Sale":{"ItemEntryID":"00003","Quantity":"10"}}}
Then the JSON should have the following format :
{"Promotion":{"Discount":[],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Remove an item (EntryID:00003, qty: 0) but was no Mix Match triggered
When I request to update Item Quantity at promotion with parameters RetailStoreID{0031} WorkStationID{1111} SequenceNo{1} and TransactionJson{{"EntryFlag": 2,"Sale":{"ItemEntryID":"00004","Quantity":"10"}}}
Then the JSON should have the following format :
{"Promotion":{"Discount":[],"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Item Entry with Less than 4 digit workstation id
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{11} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{11} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"8888884456992","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0