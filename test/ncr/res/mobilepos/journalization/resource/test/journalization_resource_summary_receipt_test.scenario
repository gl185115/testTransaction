Scenario: Empty Database Save Summary Receipt
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
Given TXL_SUMMARYRECEIPT_HISTORY is empty
Given a Journalization Resource
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {OK}
Then txid should be 1000
Then status should be {OK}
Then table {TXL_SALES_JOURNAL} will have {1} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {1} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |		

!-- Saves Different Journal Transaction But Same Original/Issued Transaction
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {OK}
Then txid should be 1001
Then status should be {OK}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |		

!-- Re-Save Previous Transaction (Duplicate Journal Transaction)
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {OK}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |

!-- Null Original StoreId
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1002</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {DATABASE_ERROR}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |

!-- Null Original WorkstationId
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1002</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {DATABASE_ERROR}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |

!-- Null Original SequenceNumber
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1002</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {DATABASE_ERROR}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |

!-- Null Original BusinessDayDate
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1002</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>} 
	and operatorno{111}
Then result should be {DATABASE_ERROR}
Then table {TXL_SALES_JOURNAL} will have {2} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType        |ServerId|Tx
|0031         |1111         |1000          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1000</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
|0031         |1111         |1001          |2014-04-07     |2014-04-07 13:05:42.0|SummaryReceipt|A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>1001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>111</OperatorID><ControlTransaction Version="2.2"><SummaryReceipt><TransactionLink><RetailStoreID>0031</RetailStoreID><WorkstationID>1111</WorkstationID><SequenceNumber>0001</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate></TransactionLink></SummaryReceipt></ControlTransaction></Transaction></POSLog>
Then table {TXL_SUMMARYRECEIPT_HISTORY} will have {2} row(s)
Then the TXL_SUMMARYRECEIPT_HISTORY database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|IssuedRetailStoreId|IssuedWorkstationId|IssuedSequenceNumber|IssuedBusinessDayDate|
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1000                |2014-04-07           |
|0031         |1111         |1             |2014-04-07     |0031               |1111               |1001                |2014-04-07           |
