Scenario: Setup Consolidation
Given an instance of SQLServerConsolidationDAO
Then its Database Manager must have been settled

Scenario: TXU_TOTAL_ITEMDAY cash tender,without discount,single line item,single item
Given a sample {TXL_POSLOG_ItemDay_Credit} poslog xml entry in database 
When I select a non-consolidated transaction information
!-- Consolidate
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY duplication cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|2				|0				|880			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY duplication cash tender,without discount,single line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|52				|0				|22880			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY duplication cash tender,without discount,multiple line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|53				|0				|23320			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY duplication cash tender,without discount,multiple line item,multiple item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new class cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new line cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new dpt cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|440.0		|0111	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new salesprice cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-07		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0111	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new summarydateid cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000031		|2012-02-06		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0111	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|

!-- TXU_TOTAL_ITEMDAY new storeid cash tender,without discount,single line item,single item
When I consolidate top {1} items
!-- TXU_TOTAL_ITEMDAY Results
Then I should get the following TXU_TOTAL_ITEMDAY results: 
|corpid			|storeid	|summarydateid	|salesprice	|dpt	|line	|class	|plu			|SalesItemCnt	|SalesCostAmt	|SalesSalesAmt	|ReturnItemCnt	|ReturnCostAmt	|ReturnSalesAmt	|VoidItemCnt	|VoidCostAmt	|VoidSalesAmt	|DcItemCnt	|DcCostAmt	|DcSalesAmt	|
|000000000000	|000030		|2012-02-06		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-06		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|220.0		|0111	|1191	|111111	|0000000123973	|2				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0111	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|0000000123973	|73				|0				|32120			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|000001	|4900000000160	|41				|0				|18040			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1181	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|
|000000000000	|000031		|2012-02-07		|440.0		|0181	|1191	|111111	|0000000123973	|1				|0				|440			|0				|0				|0				|0				|0				|0				|0			|0			|0			|