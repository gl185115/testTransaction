Scenario: Testing for PastelPortAdmin
Given a PastelPortAdmin
Then I should have a PastelPortAdmin

When I have a msgJson {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0001","paymentseq":"00001","guid":"0123456789","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120408000233","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} and there is not have any recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should be inserted and the resp is null

When I have a msgJson {{"corpid":"999999999999","storeid":"666666","terminalid":"4444","txid":"0001","paymentseq":"55555","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} and there is have a recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should not be inserted and the resp is not null

When I have a msgJson {{"corpid":"999999999999","storeid":"666666","terminalid":"4444","txid":"0001","paymentseq":"55555","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} and there is a same key recode in table TXU_NPS_PastelPortLog
Then The recode shoud be updated successful

When I have a msgJson {{"corpid":"999999999999","storeid":"666666","terminalid":"4444","txid":"0001","paymentseq":"55555","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} and there is a same key recode in table TXU_NPS_PastelPortLog but resp.Cancelnoticeflag = 1
Then The recode shoud be updated successful and VoidPaymentseq must updated

When I have a msgJson {{"corpid":"000000000002","storeid":"0002","terminalid":"0123","txid":"0001","paymentseq":"00001","guid":"0123456789","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120408000233","rwkind":"MSR","amount":"000099999","txtype":"16","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} but txtype = 16 and there is not have any recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should be inserted (txtype = 16)

When I have a msgJson {{"corpid":"000000000003","storeid":"0003","terminalid":"0123","txid":"0001","paymentseq":"00001","guid":"0123456789","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120408000233","rwkind":"MSR","amount":"000099999","txtype":"98","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} but txtype = 98 and there is not have any recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should be inserted (txtype = 98)

When I have a msgJson {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0001","paymentseq":"00001","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120408000233","rwkind":"MSR","amount":"000099999","txtype":"16","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} but txtype = 16 and there is a same key recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should be updated (txtype = 16)

When I have a msgJson {{"corpid":"999999999999","storeid":"666666","terminalid":"4444","txid":"0001","paymentseq":"55555","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"98","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} but txtype = 98 and there is a same key recode in table TXU_NPS_PastelPortLog
Then The data of CommonTx should be updated (txtype = 98)

When I have a msgJson {{"corpid":"999999999999","storeid":"666666","terminalid":"4444","txid":"0001","paymentseq":"55555","guid":"0123456790","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"98","voidtxid":"001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} but txtype = 98 and there is a same key recode in table TXU_NPS_PastelPortLog (recvdc)
Then The data of CommonTx should be updated (txtype = 98 recvdc)

When I have a msgJson {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0010","paymentseq":"00010","guid":"0123456791","brand":"MSCREDIT","service":"VOID","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"0001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"000000000001","voidstoreid":"000001","voidterminalid":"0123","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} sendca_void
Then Record_sendcavoid is

When I have a msgJson {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0010","paymentseq":"00010","guid":"0123456791","brand":"MSCREDIT","service":"VOID","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"0001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"000000000001","voidstoreid":"000001","voidterminalid":"0123","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} recveca_voidCaProc
Then {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0001","paymentseq":"00001","guid":"0123456789","brand":"MSCREDIT","service":"SUBTRACT","txdatetime":"20120408000233","rwkind":"MSR","amount":"000099999","txtype":"02","voidtxid":"0001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"123654","voidstoreid":"654","voidterminalid":"6549","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} is void in originalRecord_recveca_voidCaProc


When I have a msgJson {{"corpid":"000000000001","storeid":"000001","terminalid":"0123","txid":"0010","paymentseq":"00010","guid":"0123456792","brand":"MSCREDIT","service":"VOID","txdatetime":"20120425","rwkind":"MSR","amount":"000099999","txtype":"16","voidtxid":"0001","carddata":"Al_ZIJpcBaf1eLucqI-DKqTZU8MH3e_IN6zgUxPx6yPmzvPLJ4hhBdVpf28mNvPG_hvWD7CPALqx7wopcggdphOSxAbUD4yWeCAdwvcB24Jn5P6Bx4kOX12P-NU-rdMdL8HVI6Y_WU4Tf0yHzCcS1zaQQ8QJBkwSEmB4e_W4mIDUCYj5foKOQEdgm9RcR6pn","paymentmethod":"10","paymentinfo":"","taxothers":"0000000","voidcorpid":"000000000001","voidstoreid":"000001","voidterminalid":"0123","voidtxdatetime":"20120408000233","crcompanycode":"02","pan4":"1234567890123456","expirationdate":"200804","settlementnum":"012345","recvcompanycode":"0123456","jis2data":"11123456","creditcompanyname":"IsTestCompany","Jis1CardData":"1234567890123456789012345678901234567","Jis2CardData":"123456789012345678901234567890123456789012345678901234567890123456789","accountno":"0123456789","goodsCode":"0000000"}} senddcrecvdc_void_abortDcProc
Then The data should be updated senddcrecvdc_void_abortDcProc