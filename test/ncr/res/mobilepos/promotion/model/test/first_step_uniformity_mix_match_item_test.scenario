
Scenario: Test FirstStepUniformityMixMatchItem
Given a MixMatchData of the following:
|MMCode|MMQ|MMP|MMDescription|
|0002  |3  |120|Discount100x3|

!-- SINGLE ENTRIES (One Item_Entry)
!-- 1ST Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |1  |0001       |
When I compute discount of 1stStepUniformity
Then I should get {0} discounts

!-- 2ND Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemB |50   |1  |0002       |
When I compute discount of 1stStepUniformity
Then I should get {0} discounts

!-- 3RD Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemB |50   |1  |0003       |
When I compute discount of 1stStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0001       |10             |
|2       |0002          |0002         |Discount100x3  |0002       |10             |
|3       |0002          |0002         |Discount100x3  |0003       |10             |

!-- 4TH Entry [Add Entry with 1 Qty]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemC |60   |1  |0004       |
When I compute discount of 1stStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0004       |14             |
|2       |0002          |0002         |Discount100x3  |0001       |12             |
|3       |0002          |0002         |Discount100x3  |0002       |12             |
|4       |0002          |0002         |Discount100x3  |0003       |12             |

!-- 5TH Entry [Add Entry with 2 Qty]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemD |70   |2  |0005       |
When I compute discount of 1stStepUniformity
Then I should get {6} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0005       |22             |
|1       |0002          |0002         |Discount100x3  |0005       |22             |
|2       |0002          |0002         |Discount100x3  |0004       |19             |
|3       |0002          |0002         |Discount100x3  |0001       |16             |
|4       |0002          |0002         |Discount100x3  |0002       |16             |
|5       |0002          |0002         |Discount100x3  |0003       |15             |

!-- BUNDLE ITEMS
!-- 6TH Entry [Add Entry with 2 Qty]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemC |60   |1  |0006       |
|ItemD |70   |1  |0007       |
When I compute discount of 1stStepUniformity
Then I should get {8} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0005       |23             |
|1       |0002          |0002         |Discount100x3  |0005       |23             |
|2       |0002          |0002         |Discount100x3  |0007       |23             |
|3       |0002          |0002         |Discount100x3  |0004       |20             |
|4       |0002          |0002         |Discount100x3  |0006       |20             |
|5       |0002          |0002         |Discount100x3  |0001       |17             |
|6       |0002          |0002         |Discount100x3  |0002       |17             |
|7       |0002          |0002         |Discount100x3  |0003       |17             |

!-- 7TH Entry [Add Entry with 2 Qty]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemB |50   |2  |0008       |
|ItemC |60   |2  |0009       |
When I compute discount of 1stStepUniformity
Then I should get {12} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0005       |22             |
|1       |0002          |0002         |Discount100x3  |0005       |22             |
|2       |0002          |0002         |Discount100x3  |0007       |22             |
|3       |0002          |0002         |Discount100x3  |0004       |19             |
|4       |0002          |0002         |Discount100x3  |0006       |19             |
|5       |0002          |0002         |Discount100x3  |0009       |19             |
|5       |0002          |0002         |Discount100x3  |0009       |19             |
|6       |0002          |0002         |Discount100x3  |0001       |16             |
|7       |0002          |0002         |Discount100x3  |0002       |16             |
|8       |0002          |0002         |Discount100x3  |0003       |16             |
|9       |0002          |0002         |Discount100x3  |0008       |16             |
|9       |0002          |0002         |Discount100x3  |0008       |14             |


Scenario: Test FirstStepUniformityMixMatchItem (1st Entry is Bundle)
Given a MixMatchData of the following:
|MMCode|MMQ|MMP|MMDescription|
|0002  |3  |120|Discount100x3|

!-- 1ST Entry [Add entry of different items]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |1  |0001       |
|ItemB |60   |3  |0002       |
When I compute discount of 1stStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0002       |18             |
|1       |0002          |0002         |Discount100x3  |0002       |18             |
|1       |0002          |0002         |Discount100x3  |0002       |18             |
|2       |0002          |0002         |Discount100x3  |0001       |16             |

!-- 2ND Entry [Add entry of single item with 4 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |4  |0003       |
When I compute discount of 1stStepUniformity
Then I should get {8} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|2       |0002          |0002         |Discount100x3  |0001       |13             |
|3       |0002          |0002         |Discount100x3  |0003       |13             |
|3       |0002          |0002         |Discount100x3  |0003       |13             |
|3       |0002          |0002         |Discount100x3  |0003       |13             |
|3       |0002          |0002         |Discount100x3  |0003       |13             |

!-- 3RD Entry [Add entry of different items]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |3  |0004       |
|ItemB |60   |1  |0005       |
When I compute discount of 1stStepUniformity
Then I should get {12} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|1       |0002          |0002         |Discount100x3  |0002       |15             |
|2       |0002          |0002         |Discount100x3  |0005       |15             |
|3       |0002          |0002         |Discount100x3  |0001       |13             |
|4       |0002          |0002         |Discount100x3  |0003       |13             |
|4       |0002          |0002         |Discount100x3  |0003       |13             |
|4       |0002          |0002         |Discount100x3  |0003       |13             |
|4       |0002          |0002         |Discount100x3  |0003       |13             |
|5       |0002          |0002         |Discount100x3  |0004       |13             |
|5       |0002          |0002         |Discount100x3  |0004       |13             |
|5       |0002          |0002         |Discount100x3  |0004       |9              |


Scenario: Test FirstStepUniformityMixMatchItem - considering less values
Given a MixMatchData of the following:
|MMCode|MMQ|MMP|MMDescription|
|0002  |3  |120|Discount100x3|

!-- BUNDLE ENTRIES (One Item_Entry)
!-- 1ST Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |1  |0001       |
|ItemB |30   |1  |0002       |
|ItemC |80   |1  |0003       |
When I compute discount of 1stStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0003       |20             |
|2       |0002          |0002         |Discount100x3  |0001       |13             |
|3       |0002          |0002         |Discount100x3  |0002       |7              |


Scenario: Test FirstStepUniformityMixMatchItem - considering less values
Given a MixMatchData of the following:
|MMCode|MMQ|MMP|MMDescription|
|0002  |3  |120|Discount100x3|

!-- BUNDLE ENTRIES (One Item_Entry)
!-- 1ST Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |90   |1  |0001       |
|ItemB |60   |1  |0002       |
|ItemC |10   |1  |0003       |
When I compute discount of 1stStepUniformity
Then I should get {3} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0001       |23             |
|2       |0002          |0002         |Discount100x3  |0002       |15             |
|3       |0002          |0002         |Discount100x3  |0003       |2              |

When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |30   |1  |0004       |
When I compute discount of 1stStepUniformity
Then I should get {4} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0001       |28             |
|2       |0002          |0002         |Discount100x3  |0002       |19             |
|3       |0002          |0002         |Discount100x3  |0004       |9              |
|4       |0002          |0002         |Discount100x3  |0003       |4              |

When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |40   |1  |0005       |
When I compute discount of 1stStepUniformity
Then I should get {5} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0001       |27             |
|2       |0002          |0002         |Discount100x3  |0002       |18             |
|3       |0002          |0002         |Discount100x3  |0005       |12             |
|4       |0002          |0002         |Discount100x3  |0004       |9              |
|5       |0002          |0002         |Discount100x3  |0003       |4              |


When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |50   |1  |0006       |
When I compute discount of 1stStepUniformity
Then I should get {6} discounts
Then I should get list of discounts of the following:
|rewardid|earnedrewardid|promotioncode|discdescription|itementryid|unitdiscountamt|
|1       |0002          |0002         |Discount100x3  |0001       |26             |
|2       |0002          |0002         |Discount100x3  |0002       |17             |
|3       |0002          |0002         |Discount100x3  |0006       |14             |
|4       |0002          |0002         |Discount100x3  |0005       |11             |
|5       |0002          |0002         |Discount100x3  |0004       |9              |
|6       |0002          |0002         |Discount100x3  |0003       |3              |

Scenario: Test FirstStepUniformityMixMatchItem - considering less values
Given a MixMatchData of the following:
|MMCode|MMQ|MMP|MMDescription|
|0002  |3  |120|Discount100x3|

!-- BUNDLE ENTRIES (One Item_Entry)
!-- 1ST Entry [Add entry with 1 quantity]
When I add item to sale:
|name  |price|qty|itementryid|
|ItemA |10   |1  |0001       |
|ItemB |10   |1  |0002       |
|ItemC |10   |1  |0003       |
When I compute discount of 1stStepUniformity
Then I should get {0} discounts
