Scenario: Test Item Entry with 2nd Step Uniformity Mix Match Item by Discount Rate  
When the Web API Starts Up
Given a Promotion Service
Given a loaded dataset {items_for_mixmatch.xml}
Given a loaded dataset {mixmatch_promotions.xml}

!-- MMCode  MMQ     MMDiscountRate      MMDescription        MMQ2    MMDiscountRate2
!-- 1211     2          10%          Mix Match 1211 Type 8    5           15%

!-- [ONE ITEM ENTRY] Test to trigger First Step Uniformity Mix Match Item by Discount Rate

!-- 1ST ENTRY
When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"5505545775611","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |5505545775611|EAN-13    |1       |0143      |Item_8 sample product|項目8サンプル製品                  |100.0                |0.0     |0.0           |100.0               |100.0         |True        |0                |0         |
Then there should be no promotion data.

!-- 2ND ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"5505545775611","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |5505545775611|EAN-13    |1       |0143      |Item_8 sample product|項目8サンプル製品                  |100.0                |0.0     |0.0           |100.0               |100.0         |True        |0                |0         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |10                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |10                |
Then there should be no revoke

Scenario: [ONE ITEM ENTRY] Test to add items after 1st Step Uniformity Mix Match Item by Discount Rate was triggered

When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}

!-- 1ST ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"5505545775613","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |5505545775613|EAN-13    |1       |0143      |Item_8 sample product_2|項目8サンプル製品2         |50.0                 |0.0     |0.0           |50.0                |50.0          |True        |1                |0         |
Then there should be no promotion data.

!-- 2ND ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"5505545775613","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |5505545775613|EAN-13    |1       |0143      |Item_8 sample product_2|項目8サンプル製品2         |50.0                 |0.0     |0.0           |50.0                |50.0          |True        |1                |0         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |5                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |5                |
Then there should be no revoke

!-- 3RD ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"5505545775613","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00003      |5505545775613|EAN-13    |1       |0143      |Item_8 sample product_2|項目8サンプル製品2         |50.0                 |0.0     |0.0           |50.0                |50.0          |True        |1                |0         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |5                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |5                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |5                |
Then there should be revoke

!-- 4TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"5505545775612","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00004      |5505545775612|EAN-13    |1       |0143      |Sample product_1     |サンプル製品1           |60.0                 |0.0     |0.0           |60.0                |60.0          |True        |0                |0         |

Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00004      |6                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00001      |5                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00002      |5                |
|4       |1211          |1211         |Mix Match 1211 Type 8|00003      |5                |
Then there should be revoke

Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to trigger 1st Step
!-- MMCode  MMQ     MMDiscountRate      MMDescription        MMQ2    MMDiscountRate2
!-- 1212     2          10%       Mix Match 1212 Type 8.1    5           15%

When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}

!-- 1ST ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"5505545775614","ItemIDType":"EAN-13","Quantity":3}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |5505545775614|EAN-13    |3       |0143      |Item_8 sample product_3|項目8サンプル製品3         |100.0                |0.0     |0.0           |100.0               |300.0         |True        |1                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1212          |1212         |Mix Match 1212 Type 8.1|00001      |30                |
Then there should be no revoke
!-- Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 1st Step was triggered

!-- 2ND ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"5505545775614","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |5505545775614|EAN-13    |1       |0143      |Item_8 sample product_3|項目8サンプル製品3         |100.0                |0.0     |0.0           |100.0               |100.0         |True        |1                |null      |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1212          |1212         |Mix Match 1212 Type 8.1|00001      |30                |
|2       |1212          |1212         |Mix Match 1212 Type 8.1|00002      |10                |
Then there should be revoke

Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to trigger 2nd Step
!-- MMCode  MMQ     MMDiscountRate      MMDescription        MMQ2    MMDiscountRate2
!-- 1211     2          10%          Mix Match 1211 Type 8    5           15%

When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}

!-- 1ST ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"5505545775611","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |5505545775611|EAN-13    |1       |0143      |Item_8 sample product|項目8サンプル製品                  |100.0                |0.0     |0.0           |100.0               |100.0         |True        |0                |0         |

!-- 2ND ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"5505545775611","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |5505545775611|EAN-13    |1       |0143      |Item_8 sample product|項目8サンプル製品                  |100.0                |0.0     |0.0           |100.0               |100.0         |True        |0                |0         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |10                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |10                |
Then there should be no revoke

!-- 3RD ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"5505545775611","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00003      |5505545775611|EAN-13    |1       |0143      |Item_8 sample product|項目8サンプル製品                  |100.0                |0.0     |0.0           |100.0               |100.0         |True        |0                |0         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |10                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |10                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |10                |
Then there should be revoke

!-- 4TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"5505545775610","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00004      |5505545775610|EAN-13    |1       |0143      |Item_8 sample product_1|項目8サンプル製品1         |90.0                 |0.0     |0.0           |90.0                |90.0          |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |10                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |10                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |10                |
|4       |1211          |1211         |Mix Match 1211 Type 8|00004      |9                |
Then there should be revoke

!-- 5TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00005","ItemID":"5505545775610","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00005      |5505545775610|EAN-13    |1       |0143      |Item_8 sample product_1|項目8サンプル製品1         |90.0                 |0.0     |0.0           |90.0                |90.0          |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |15                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |15                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |15                |
|4       |1211          |1211         |Mix Match 1211 Type 8|00004      |14                |
|5       |1211          |1211         |Mix Match 1211 Type 8|00005      |13                |
Then there should be revoke

Scenario: [ONE ITEM ENTRY] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 2nd Step was triggered

!-- 6TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00006","ItemID":"5505545775610","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00006      |5505545775610|EAN-13    |1       |0143      |Item_8 sample product_1|項目8サンプル製品1         |90.0                 |0.0     |0.0           |90.0                |90.0          |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |15                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |15                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |15                |
|4       |1211          |1211         |Mix Match 1211 Type 8|00004      |13                |
|5       |1211          |1211         |Mix Match 1211 Type 8|00005      |13                |
|6       |1211          |1211         |Mix Match 1211 Type 8|00006      |14                |
Then there should be revoke

!-- 7TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00007","ItemID":"5505545775619","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN        |DescriptionJP        |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00007      |5505545775619|EAN-13    |1       |0143      |Sample product_1     |サンプル製品1           |80.0                 |0.0     |0.0           |80.0                |80.0          |True        |0                |1         |

Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1211          |1211         |Mix Match 1211 Type 8|00001      |15                |
|2       |1211          |1211         |Mix Match 1211 Type 8|00002      |15                |
|3       |1211          |1211         |Mix Match 1211 Type 8|00003      |15                |
|4       |1211          |1211         |Mix Match 1211 Type 8|00004      |13                |
|5       |1211          |1211         |Mix Match 1211 Type 8|00005      |13                |
|6       |1211          |1211         |Mix Match 1211 Type 8|00006      |13                |
|7       |1211          |1211         |Mix Match 1211 Type 8|00007      |13                |
Then there should be revoke

Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items to trigger 2nd Step
!-- MMCode  MMQ     MMDiscountRate      MMDescription        MMQ2    MMDiscountRate2
!-- 1213     3          10%          Mix Match 1213 Type 8.2    5           15%

When a Begin Transaction at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"TransactionMode":"0","OperatorID": "0003","BeginDateTime":"2012-12-20T09:30:47.00"}}

!-- 1ST ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00001","ItemID":"5505545775617","ItemIDType":"EAN-13","Quantity":5}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00001      |5505545775617|EAN-13    |5       |0143      |Item_8 sample product_6|項目8サンプル製品6         |50.0                 |0.0     |0.0           |50.0                |250.0         |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |37                |
Then there should be no revoke

Scenario: [BUNDLE ITEMS] Test 2ndStepUniformityMixMatchItemDiscountRate to add items after 2nd Step was triggered

!-- 2ND ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00002","ItemID":"5505545775618","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00002      |5505545775618|EAN-13    |1       |0143      |Item_8 sample product_7|項目8サンプル製品7         |60.0                 |0.0     |0.0           |60.0                |60.0          |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00002      |9               |
|2       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |37              |
Then there should be revoke

!-- 3RD ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00003","ItemID":"5505545775629","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00003      |5505545775629|EAN-13    |1       |0143      |Item_8 sample product_8|項目8サンプル製品8         |70.0                 |0.0     |0.0           |70.0                |70.0          |True        |1                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00003      |11              |
|2       |1213          |1213         |Mix Match 1213 Type 8.2|00002      |9               |
|3       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |37              |
Then there should be revoke

!-- 4TH ENTRY
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00004","ItemID":"5505545775621","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00004      |5505545775621|EAN-13    |1       |0143      |Item_8 sample product_9|項目8サンプル製品9         |95.0                 |0.0     |0.0           |95.0                |95.0          |True        |0                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription    |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00004      |14              |
|2       |1213          |1213         |Mix Match 1213 Type 8.2|00003      |10              |
|3       |1213          |1213         |Mix Match 1213 Type 8.2|00002      |9               |
|4       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |38              |
Then there should be revoke

!-- 5TH ENTRY [quantity=2]
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00005","ItemID":"5505545775621","ItemIDType":"EAN-13","Quantity":2}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00005      |5505545775621|EAN-13    |2       |0143      |Item_8 sample product_9|項目8サンプル製品9         |95.0                 |0.0     |0.0           |95.0                |190.0         |True        |0                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00004      |14              |
|2       |1213          |1213         |Mix Match 1213 Type 8.2|00005      |28              |
|3       |1213          |1213         |Mix Match 1213 Type 8.2|00003      |10              |
|4       |1213          |1213         |Mix Match 1213 Type 8.2|00002      |9               |
|5       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |38              |
Then there should be revoke

!-- 6TH ENTRY [quantity=1]
When a Item Entry at promotion with parameters RetailStoreID{0031} WorkStationId{1111} SequenceNo{1} TransactionJson{{"Sale":{"ItemEntryID":"00006","ItemID":"5505545775621","ItemIDType":"EAN-13","Quantity":1}}}
Then the Result Code is 0
Then Sale data should be :
|ItemEntryID|ItemID       |ItemIDType|Quantity|Department|DescriptionEN          |DescriptionJP          |RegularSalesUnitPrice|Discount|DiscountAmount|ActualSalesUnitPrice|ExtendedAmount|Discountable|AgeRestrictedFlag|CouponFlag|
|00006      |5505545775621|EAN-13    |1       |0143      |Item_8 sample product_9|項目8サンプル製品9         |95.0                 |0.0     |0.0           |95.0                |95.0          |True        |0                |1         |
Then promotion should have the following data :
|RewardID|EarnedRewardID|PromotionCode|DiscountDescription  |ItemEntryID|UnitDiscountAmount|
|1       |1213          |1213         |Mix Match 1213 Type 8.2|00004      |14              |
|2       |1213          |1213         |Mix Match 1213 Type 8.2|00005      |28              |
|3       |1213          |1213         |Mix Match 1213 Type 8.2|00006      |14              |
|4       |1213          |1213         |Mix Match 1213 Type 8.2|00003      |11              |
|5       |1213          |1213         |Mix Match 1213 Type 8.2|00002      |9               |
|6       |1213          |1213         |Mix Match 1213 Type 8.2|00001      |38              |
Then there should be revoke