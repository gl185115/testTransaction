Scenario: Journalization of an unknown transaction (donation with wrong account number)
Given a Journalization Resource
Given a RESMaster DBInitiator
Given MST_DEVICEINFO table
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>8521</SequenceNumber><BusinessDayDate>2014-03-28</BusinessDayDate><BeginDateTime>2014-03-28T17:44:20</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-03-28T17:44:20</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><PaymentOnAccount AccountCode="Unspecified"><AccountNumber>2</AccountNumber><Amount>500</Amount></PaymentOnAccount></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash"><Amount>1000</Amount><TenderChange><Amount>500</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">500</Total><Total TotalType="TransactionGrandAmount">500</Total></RetailTransaction></Transaction></POSLog>}
	and operatorno{001}
Then result should be {OK}
Then table {TXL_SALES_JOURNAL} will have {1} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType|ServerId|Tx
|0031         |4567         |8521          |2014-03-28     |2014-03-28 17:44:20.0|Other |A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>8521</SequenceNumber><BusinessDayDate>2014-03-28</BusinessDayDate><BeginDateTime>2014-03-28T17:44:20</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-03-28T17:44:20</ReceiptDateTime><TillID>0</TillID><RetailTransaction><Customer><CustomerDemographic>02</CustomerDemographic></Customer><ItemCount>3</ItemCount><LineItem><SequenceNumber>1</SequenceNumber><PaymentOnAccount AccountCode="Unspecified"><AccountNumber>2</AccountNumber><Amount>500</Amount></PaymentOnAccount></LineItem><LineItem><SequenceNumber>2</SequenceNumber><Tender TenderType="Cash"><Amount>1000</Amount><TenderChange><Amount>500</Amount></TenderChange></Tender></LineItem><LineItem><SequenceNumber>3</SequenceNumber><Tax TaxType="Sales"><Amount>0</Amount><Percent>0</Percent><TaxableAmount TaxIncludedInTaxableAmountFlag="false">0</TaxableAmount></Tax></LineItem><Total TotalType="TransactionSubtotal">500</Total><Total TotalType="TransactionGrandAmount">500</Total></RetailTransaction></Transaction></POSLog>

Scenario: Journalization of an unknown transaction (unknown changefund daytime transaction)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderUnknown TenderType="Cash"><Amount>35000</Amount></TenderUnknown></TenderControlTransaction></Transaction></POSLog>}
	and operatorno{111}
Then result should be {OK}
Then txid should be 4209
Then status should be {OK}
Then table {TXL_SALES_JOURNAL} will have {1} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType|ServerId|Tx
|0031         |4567         |4209          |2014-04-07     |2014-04-07 13:05:42.0|Other |A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T13:05:42</BeginDateTime><OperatorID>001</OperatorID><ReceiptDateTime>2014-04-07T13:05:42</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TenderUnknown TenderType="Cash"><Amount>35000</Amount></TenderUnknown></TenderControlTransaction></Transaction></POSLog>

Scenario: Journalization of an unknown transaction (unknown changefund transaction)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Unknown TenderType="Cash"><Amount>200000</Amount></Unknown></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>}
	and operatorno{111}
Then result should be {OK}
Then txid should be 4209
Then status should be {OK}
Then table {TXL_SALES_JOURNAL} will have {1} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType|ServerId|Tx
|0031         |4567         |4209          |2014-04-07     |2014-04-07 09:00:42.0|Other |A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Unknown TenderType="Cash"><Amount>200000</Amount></Unknown></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>

Scenario: Journalization of an invalid POSLog (xml format error)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction/><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>}
	and operatorno{111}
Then result should be {JAXB_ERROR}

Scenario: Journalization of an invalid POSLog (some required elements missing - BeginDateTime element)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>4209</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Beginning TenderType="Cash"><Amount>200000</Amount></Beginning></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>}
	and operatorno{111}
Then result should be {GENERAL_ERROR}

Scenario: Journalization of an unknown transaction (5-digit Transaction Number)
Given a Journalization Resource
Given a RESTransaction DBInitiator
Given TXL_SALES_JOURNAL is empty
When executing journal log with xml{<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Unknown TenderType="Cash"><Amount>200000</Amount></Unknown></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>}
	and operatorno{111}
Then result should be {OK}
Then txid should be 12345
Then status should be {OK}
Then table {TXL_SALES_JOURNAL} will have {1} row(s)
Then the TXL_SALES_JOURNAL database table should have the following row(s):
|RetailStoreId|WorkstationId|SequenceNumber|BusinessDayDate|SystemDateTime       |TxType|ServerId|Tx
|0031         |4567         |12345         |2014-04-07     |2014-04-07 09:00:42.0|Other |A010    |<?xml version="1.0" encoding="UTF-8" ?><POSLog><Transaction><RetailStoreID>0031</RetailStoreID><WorkstationID>4567</WorkstationID><SequenceNumber>12345</SequenceNumber><BusinessDayDate>2014-04-07</BusinessDayDate><BeginDateTime>2014-04-07T09:00:42</BeginDateTime><OperatorID>111</OperatorID><ReceiptDateTime>2014-04-07T09:00:44</ReceiptDateTime><TillID>0</TillID><TenderControlTransaction Version="2.2"><TillSettle><TenderSummary><Unknown TenderType="Cash"><Amount>200000</Amount></Unknown></TenderSummary></TillSettle></TenderControlTransaction></Transaction></POSLog>
