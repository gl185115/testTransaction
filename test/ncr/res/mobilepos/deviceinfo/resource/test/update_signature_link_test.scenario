Story: Update Signature Link

Scenario: Null/Empty Parameters (FAIL)
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|

!-- Should not update if STOREID is NULL/EMPTY
Given a Device Information Web Service
When I update signature link data of retailstoreid:null, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"POS Terminal Signed220"}
Then I should get error code {224}
When I update signature link data of retailstoreid:, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"POS Terminal Signed220"}
Then I should get error code {224}

!-- Should not update if POSLINKID is NULL/EMPTY
Given a Device Information Web Service
When I update signature link data of retailstoreid:000031, poslinkid:null, poslinkinfo:{"LinkName":"POS Terminal Signed220"}
Then I should get error code {224}
When I update signature link data of retailstoreid:000031, poslinkid:, poslinkinfo:{"LinkName":"POS Terminal Signed220"}
Then I should get error code {224}

!-- Should not update if POSLINKINFO is NULL/EMPTY
Given a Device Information Web Service
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:null
Then I should get error code {224}
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:
Then I should get error code {224}



Scenario: New RetailStoreID Not Existing (FAIL)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|

Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |



!-- Should not update if NEW RETAILSTOREID is NOT EXISTING in the MST_STOREINFO
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"RetailStoreID":"10001"}
Then I should get error code {710}

!-- Should not update if new RETAILSTOREID is EMPTY
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"RetailStoreID":""}
Then I should get error code {228}


Scenario: LinkType is Invalid (FAIL)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |

!-- Should not update if LINKTYPE('sign') is INVALID
When I update sign link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"POS Terminal Signed220"}
Then I should get error code {905}

Scenario: New RetailStoreID, LinkID is EMPTY (FAIL)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|


!-- Should Not Update SignatureLink If NEW LINKID is EMPTY
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkID":""}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid |id          	    |displayname     	   |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get error code {227}

!-- Should Not Update Signature Link If NEW RETAILSTOREID is EMPTY
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"RetailStoreID":""}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get error code {228}

!-- Allow Update Signature Link with EMPTY NEW LINKNAME 
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":""}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220||
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"","RetailStoreID":"000031"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}


Scenario: Json Key-Name is Invalid (FAIL)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|

!-- Fail Update Signature Link If RetailStoreID key name = InvalidRetailStoreID is wrong
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"InvalidRetailStoreID":""}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"NCRWSSResultCode":151,"NCRWSSExtendedResultCode":154}

!-- Fail Update Signature Link If LinkID key name = InvalidLinkID is wrong
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID222, poslinkinfo:{"InvalidLinkID":"1"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"NCRWSSResultCode":151,"NCRWSSExtendedResultCode":154}


!-- Fail Update Signature Link if LINKID is a DUPLICATE
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkID":"posSignedLinkID225"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid |id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"NCRWSSResultCode":901,"NCRWSSExtendedResultCode":136}

!-- Fail Update Signature Link If LinkName key name is wrong
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"InvalidLinkName":"test"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"NCRWSSResultCode":151,"NCRWSSExtendedResultCode":154}

Scenario: PosLinkID is not found (FAIL)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID226, poslinkinfo:{"LinkID":"test"}
Then I should get a response: {"NCRWSSResultCode":907,"NCRWSSExtendedResultCode":0}

Scenario: Optional Parameters (SUCCESS)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |

!-- Should Update To NEW LINKNAME
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"POS Terminal Signed221"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed221|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"POS Terminal Signed221","RetailStoreID":"000031"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}


!-- Should Update To NEW RETAILSTOREID if EXISTING in MST_STOREINFO
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"RetailStoreID":"000032"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000032  |posSignedLinkID220|POS Terminal Signed221|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"POS Terminal Signed221","RetailStoreID":"000032"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

Scenario: Optional Parameters (SUCCESS)
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |

!-- Should Update To NEW LINKNAME
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"POS Terminal Signed221"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed221|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"POS Terminal Signed221","RetailStoreID":"000031"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}


!-- Should Update To NEW RETAILSTOREID if EXISTING in MST_STOREINFO
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"RetailStoreID":"000032"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000032  |posSignedLinkID220|POS Terminal Signed221|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"POS Terminal Signed221","RetailStoreID":"000032"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}


!-- Should Update To NEW LINKID If NOT EXISTING
When I update signature link data of retailstoreid:000032, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkID":"posSignedLinkID221"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000032  |posSignedLinkID221|POS Terminal Signed221|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID221","LinkName":"POS Terminal Signed221","RetailStoreID":"000032"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

!-- Should Update To NEW RETAILSTOREID, LINKID and LINKNAME If NOT EXISTING
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID225, poslinkinfo:{"LinkID":"posSignedLinkID445","LinkName":"POS Terminal Signed445","RetailStoreID":"000032"}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000032  |posSignedLinkID221|POS Terminal Signed221|
|000032  |posSignedLinkID445|POS Terminal Signed445|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID445","LinkName":"POS Terminal Signed445","RetailStoreID":"000032"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}



Scenario: Update With SPACES (SUCCESS)
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |

!-- Should Update To NEW LINKNAME and TRIM Spaces
When I update signature link data of retailstoreid:000031, poslinkid:posSignedLinkID220, poslinkinfo:{"LinkName":"   POS Terminal Signed220   "}
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID220","LinkName":"POS Terminal Signed220","RetailStoreID":"000031"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}


Scenario: Allow update table with Not Existing(DELETED) RetailStoreID  
Given a Device Information Web Service
Given a PRM_SIGNATURE_LINK_Update database table
Then the PRM_SIGNATURE_LINK database table should have the following row(s):
|storeid|id          |displayname     |
|000031  |posSignedLinkID220|POS Terminal Signed220|
|000031  |posSignedLinkID225|POS Terminal Signed225|
|000031  |posSignedLinkID330|POS Terminal Signed330|
|000035  |posSignedLinkID335|POS Terminal Signed335|

Given a MST_STOREINFO database table
Then the MST_STOREINFO database table should have the following row(s):
|storeid|storename   |
|000031 |STORE-000031|
|000032 |STORE-000032|
|000035 |STORE-000035|
|00031  |STORE-00031 |
|00032  |STORE-00032 |
!-- Should allow update if RETAILSTOREID is NOT EXISTING (DELETED) in the MST_STOREINFO
When I update signature link data of retailstoreid:000035, poslinkid:posSignedLinkID335, poslinkinfo:{"LinkName":"POS Terminal 001"}
Then I should get a response: {"POSLinkInfo":{"LinkID":"posSignedLinkID335","LinkName":"POS Terminal 001","RetailStoreID":"000035"},"NCRWSSResultCode":0,"NCRWSSExtendedResultCode":0}

